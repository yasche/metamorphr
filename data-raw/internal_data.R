## code to prepare `test_create_metadata_skeleton` dataset goes here

test_create_metadata_skeleton <- tibble::tribble(
  ~Sample, ~Group, ~Replicate, ~Batch, ~Factor,
  "s1", NA, NA, NA, 1,
  "s2", NA, NA, NA, 1,
  "s3", NA, NA, NA, 1,
)


## code to prepare `test_read_featuretable` dataset goes here

test_read_featuretable <- tibble::tribble(
  ~UID, ~Feature, ~Sample, ~Intensity, ~some_metadata1, ~some_metadata2,
  1, "f1", "s1", 1, "a", "c",
  2, "f2", "s1", 4, "b", "d",
  1, "f1", "s2", 2, "a", "c",
  2, "f2", "s2", 5, "b", "d",
  1, "f1", "s3", 3, "a", "c",
  2, "f2", "s3", 6, "b", "d",
) %>%
  dplyr::mutate(UID = as.integer(UID))


## code to prepare `test_mv_filters` dataset goes here

test_filters <- metamorphr::read_featuretable(
"label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
)

## code to prepare `test_mv_filters_metadata1` dataset goes here
#version 1:
#s1 - s6:   g1
#s7 - s12:  g2
test_filters_metadata1 <- metamorphr::read_featuretable(
"label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
) %>%
  create_metadata_skeleton() %>%
  dplyr::mutate(Group = c(rep("g1", 6), rep("g2", 6), rep("q", 3), "b")) %>%
  dplyr::mutate(Replicate = c(rep(1:6, 2), 1:3, 1L)) %>%
  dplyr::mutate(Batch = 1L)

## code to prepare `test_mv_filters_metadata2` dataset goes here
#version 1:
#s1 - s3:   g1
#s4 - s6:   g2
#s7 - s9:   g3
#s10-s12:   g4
test_filters_metadata2 <- metamorphr::read_featuretable(
  "label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
) %>%
  metamorphr::create_metadata_skeleton() %>%
  dplyr::mutate(Group = c(rep("g1", 3), rep("g2", 3), rep("g3", 3), rep("g4", 3), rep("q", 3), "b")) %>%
  dplyr::mutate(Replicate = c(rep(1:3, 4), 1:3, 1L)) %>%
  dplyr::mutate(Batch = 1L)

## code to prepare `test_qn_data` dataset goes here
# data is from
# Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.
# A1 - B2 are labeled S1 - S8
test_qn_data <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2,3,6,5,7,5,8,8
B,4,3,5,3,6,7,6,7
C,5,4,3,4,9,4,7,7
D,3,5,4,4,7,8,5,6
E,4,5,5,6,8,7,7,9"
)

## code to prepare `test_qn_metadata` dataset goes here
test_qn_metadata <- test_qn_data %>%
  metamorphr::create_metadata_skeleton() %>%
  dplyr::mutate(Group  = c(rep("A", 4), rep("B", 4)),
                Replicate = c(1:4, 1:4),
                Batch = rep(c(1L, 2L), each = 2, times = 2))

## code to prepare `test_qn_all_results` dataset goes here
test_qn_all_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,4,4.44,7,6.13,5.25,4.88,7,6.13
B,5.88,4.44,5.88,4,4,5.88,4.88,5.25
C,7,5.63,4,5.25,7,4,5.88,5.25
D,4.88,6.56,4.88,5.25,5.25,7,4,4
E,5.88,6.56,5.88,7,6.13,5.88,5.88,7"
)

## code to prepare `test_qn_group_results` dataset goes here
test_qn_group_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2.75,3.13,5.5,4.75,6.63,6.25,8.5,7.5
B,4.5,3.13,4.5,2.75,5.25,7.25,6.25,6.63
C,5.5,4.25,2.75,3.88,8.5,5.25,7.25,6.63
D,3.5,5.13,3.5,3.88,6.63,8.5,5.25,5.25
E,4.5,5.13,4.5,5.5,7.5,7.25,7.25,8.5"
)

## code to prepare `test_qn_group_results` dataset goes here
test_qn_batch_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2.5,2.75,6,5,6.5,6,8.5,7.5
B,4.25,2.75,4.75,3,5,7.25,6.5,6.75
C,5,4,3,4.25,8.5,5,7.25,6.75
D,3,4.75,4,4.25,6.5,8.5,5.5,5.5
E,4.25,4.75,4.75,6,7.5,7.25,7.25,8.5"
)


## code to prepare `test_qn_group_results` dataset goes here
test_qn_smooth_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,3.02,3.4,5.65,4.89,6.46,5.98,8.35,7.36
B,4.6,3.4,4.6,3.02,4.98,7.15,5.98,6.46
C,5.65,4.31,3.02,4.04,8.35,4.98,7.15,6.46
D,3.77,5.27,3.77,4.04,6.46,8.35,4.98,4.98
E,4.6,5.27,4.6,5.65,7.36,7.15,7.15,8.35"
)

## results were externally calculated
test_normalize_ref_uid_2 <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,1.333333333,0.5,0.8,0,4.5,2,0.777777778,3,0.5,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,1,1,1,1,1,1,1,1,1,1,1
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,0.333333333,0.2,2.666666667,3.5,2,0.555555556,2.5,1,0,0
417.23236 Da 60.08 s,1,418.24019,,,1.666666667,1.5,1.4,1,0,2.25,0.666666667,0.5,1.333333333,1.5,0.555555556
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,1.666666667,1,0.8,3,4,1.25,0.555555556,0,0.333333333,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,1.666666667,0,1.2,1.333333333,1.5,2,0.555555556,1,0.166666667,2,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,3,3.5,2.25,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,1,0.666666667,0.4,1.333333333,1.5,0,0.333333333,1.5,0.5,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,1.333333333,0.5,0.8,2.333333333,4,2,0.333333333,1.5,0.666666667,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,0.833333333,0,0,1,0,0,1.5,0,0,0", metadata_cols = 2:5
)


test_normalize_ref_uid_2_mul_mean <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,6.424242424,2.409090909,3.854545455,0,21.68181818,9.636363636,3.747474747,14.45454545,2.409090909,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,1.606060606,0.963636364,12.84848485,16.86363636,9.636363636,2.676767677,12.04545455,4.818181818,0,0
417.23236 Da 60.08 s,1,418.24019,,,8.03030303,7.227272727,6.745454545,4.818181818,0,10.84090909,3.212121212,2.409090909,6.424242424,7.227272727,2.676767677
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,8.03030303,4.818181818,3.854545455,14.45454545,19.27272727,6.022727273,2.676767677,0,1.606060606,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,8.03030303,0,5.781818182,6.424242424,7.227272727,9.636363636,2.676767677,4.818181818,0.803030303,9.636363636,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,14.45454545,16.86363636,10.84090909,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,4.818181818,3.212121212,1.927272727,6.424242424,7.227272727,0,1.606060606,7.227272727,2.409090909,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,6.424242424,2.409090909,3.854545455,11.24242424,19.27272727,9.636363636,1.606060606,7.227272727,3.212121212,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,4.015151515,0,0,4.818181818,0,0,7.227272727,0,0,0",  metadata_cols = 2:5)


test_normalize_ref_uid_2_mul_med <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,5.333333333,2,3.2,0,18,8,3.111111111,12,2,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,4,4,4,4,4,4,4,4,4,4,4
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,1.333333333,0.8,10.66666667,14,8,2.222222222,10,4,0,0
417.23236 Da 60.08 s,1,418.24019,,,6.666666667,6,5.6,4,0,9,2.666666667,2,5.333333333,6,2.222222222
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,6.666666667,4,3.2,12,16,5,2.222222222,0,1.333333333,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,6.666666667,0,4.8,5.333333333,6,8,2.222222222,4,0.666666667,8,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,12,14,9,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,4,2.666666667,1.6,5.333333333,6,0,1.333333333,6,2,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,5.333333333,2,3.2,9.333333333,16,8,1.333333333,6,2.666666667,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,3.333333333,0,0,4,0,0,6,0,0,0",  metadata_cols = 2:5
)

test_normalize_ref_name_adp <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,1,1,1,0,1.125,1,2.333333333,2,0.75
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,0.75,2,1.25,0.428571429,0.25,0.5,3,0.666666667,1.5
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,0.666666667,0.25,1.142857143,0.875,1,1.666666667,1.666666667,1.5
417.23236 Da 60.08 s,1,418.24019,,,1.25,3,1.75,0.428571429,0,1.125,2,0.333333333,2
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,1.25,2,1,1.285714286,1,0.625,1.666666667,0,0.5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,1.25,0,1.5,0.571428571,0.375,1,1.666666667,0.666666667,0.25
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,1.285714286,0.875,1.125,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,0.75,1.333333333,0.5,0.571428571,0.375,0,1,1,0.75
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,1,1,1,1,1,1,1,1,1
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,1.666666667,0,0,0.25,0,0,1,0",  metadata_cols = 2:5
)

test_impute_mean <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,5.5,9,8,7,6,3,5.5,5.5
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,5.25,2,1,8,7,8,5,5,6,5.25,5.25
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,5.9,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,5.5,2,5.5,5.5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,4.666666667,6,4,3,8,5,2,1,8,4.666666667
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,8.333333333,8.333333333,8.333333333,9,7,9,8.333333333,8.333333333,8.333333333,8.333333333,8.333333333
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,3.125,3,3,3,3.125,3.125
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,4.888888889,4.888888889
1284.34904 Da 498.94 s,8.32,1285.35687,,,3.333333333,5,3.333333333,3.333333333,2,3.333333333,3.333333333,3,3.333333333,3.333333333,3.333333333",  metadata_cols = 2:5
)

test_impute_min <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,3,9,8,7,6,3,3,3
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,1,2,1,8,7,8,5,5,6,1,1
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,1,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,2,2,2,2
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,1,6,4,3,8,5,2,1,8,1
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,7,7,7,9,7,9,7,7,7,7,7
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,2,3,3,3,2,2
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,3,3
1284.34904 Da 498.94 s,8.32,1285.35687,,,2,5,2,2,2,2,2,3,2,2,2",  metadata_cols = 2:5
)


test_impute_median <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,5,9,8,7,6,3,5,5
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,5.5,2,1,8,7,8,5,5,6,5.5,5.5
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,6,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,5,2,5,5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,5,6,4,3,8,5,2,1,8,5
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,9,9,9,9,7,9,9,9,9,9,9
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,3,3,3,3,3,3
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,4,4
1284.34904 Da 498.94 s,8.32,1285.35687,,,3,5,3,3,2,3,3,3,3,3,3",  metadata_cols = 2:5
)

usethis::use_data(test_read_featuretable,
                  test_create_metadata_skeleton,
                  test_filters,
                  test_filters_metadata1,
                  test_filters_metadata2,
                  test_qn_data,
                  test_qn_metadata,
                  test_qn_all_results,
                  test_qn_group_results,
                  test_qn_batch_results,
                  test_qn_smooth_results,
                  test_normalize_ref_uid_2,
                  test_normalize_ref_uid_2_mul_mean,
                  test_normalize_ref_uid_2_mul_med,
                  test_normalize_ref_name_adp,
                  test_impute_mean,
                  test_impute_min,
                  test_impute_median,
                  overwrite = TRUE, internal = TRUE)
