## code to prepare `test_create_metadata_skeleton` dataset goes here

test_create_metadata_skeleton <- tibble::tribble(
  ~Sample, ~Group, ~Replicate, ~Batch, ~Factor,
  "s1", NA, NA, NA, 1,
  "s2", NA, NA, NA, 1,
  "s3", NA, NA, NA, 1,
)


## code to prepare `test_read_featuretable` dataset goes here

test_read_featuretable <- tibble::tribble(
  ~UID, ~Feature, ~Sample, ~Intensity, ~some_metadata1, ~some_metadata2,
  1, "f1", "s1", 1, "a", "c",
  2, "f2", "s1", 4, "b", "d",
  1, "f1", "s2", 2, "a", "c",
  2, "f2", "s2", 5, "b", "d",
  1, "f1", "s3", 3, "a", "c",
  2, "f2", "s3", 6, "b", "d",
) %>%
  dplyr::mutate(UID = as.integer(UID))


## code to prepare `test_mv_filters` dataset goes here

test_filters <- metamorphr::read_featuretable(
  "label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
)

## code to prepare `test_mv_filters_metadata1` dataset goes here
# version 1:
# s1 - s6:   g1
# s7 - s12:  g2
test_filters_metadata1 <- metamorphr::read_featuretable(
  "label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
) %>%
  create_metadata_skeleton() %>%
  dplyr::mutate(Group = c(rep("g1", 6), rep("g2", 6), rep("q", 3), "b")) %>%
  dplyr::mutate(Replicate = c(rep(1:6, 2), 1:3, 1L)) %>%
  dplyr::mutate(Batch = 1L)

## code to prepare `test_mv_filters_metadata2` dataset goes here
# version 1:
# s1 - s3:   g1
# s4 - s6:   g2
# s7 - s9:   g3
# s10-s12:   g4
test_filters_metadata2 <- metamorphr::read_featuretable(
  "label,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,q1,q2,q3,b1
f0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0.1
f1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1.17,0.2
f2,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1.38,0.3
f3,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1.6,0.4
f4,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1.85,0.5
f5,1,1,1,1,1,0,0,0,0,0,0,0,1,1,2.2,0.6
f6,1,1,1,1,1,1,0,0,0,0,0,0,1,1,2.55,0.7
f7,1,1,1,1,1,1,1,0,0,0,0,0,1,1,3,0.8
f8,1,1,1,1,1,1,1,1,0,0,0,0,1,1,3.5,0.9
f9,1,1,1,1,1,1,1,1,1,0,0,0,1,1,4.2,1
f10,1,1,1,1,1,1,1,1,1,1,0,0,1,1,5,0
f11,1,1,1,1,1,1,1,1,1,1,1,0,1,1,6,0.5
f12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7.5,1"
) %>%
  metamorphr::create_metadata_skeleton() %>%
  dplyr::mutate(Group = c(rep("g1", 3), rep("g2", 3), rep("g3", 3), rep("g4", 3), rep("q", 3), "b")) %>%
  dplyr::mutate(Replicate = c(rep(1:3, 4), 1:3, 1L)) %>%
  dplyr::mutate(Batch = 1L)

## code to prepare `test_qn_data` dataset goes here
# data is from
# Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.
# A1 - B2 are labeled S1 - S8
test_qn_data <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2,3,6,5,7,5,8,8
B,4,3,5,3,6,7,6,7
C,5,4,3,4,9,4,7,7
D,3,5,4,4,7,8,5,6
E,4,5,5,6,8,7,7,9"
)

## code to prepare `test_qn_metadata` dataset goes here
test_qn_metadata <- test_qn_data %>%
  metamorphr::create_metadata_skeleton() %>%
  dplyr::mutate(
    Group = c(rep("A", 4), rep("B", 4)),
    Replicate = c(1:4, 1:4),
    Batch = rep(c(1L, 2L), each = 2, times = 2)
  )

## code to prepare `test_qn_all_results` dataset goes here
test_qn_all_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,4,4.44,7,6.13,5.25,4.88,7,6.13
B,5.88,4.44,5.88,4,4,5.88,4.88,5.25
C,7,5.63,4,5.25,7,4,5.88,5.25
D,4.88,6.56,4.88,5.25,5.25,7,4,4
E,5.88,6.56,5.88,7,6.13,5.88,5.88,7"
)

## code to prepare `test_qn_group_results` dataset goes here
test_qn_group_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2.75,3.13,5.5,4.75,6.63,6.25,8.5,7.5
B,4.5,3.13,4.5,2.75,5.25,7.25,6.25,6.63
C,5.5,4.25,2.75,3.88,8.5,5.25,7.25,6.63
D,3.5,5.13,3.5,3.88,6.63,8.5,5.25,5.25
E,4.5,5.13,4.5,5.5,7.5,7.25,7.25,8.5"
)

## code to prepare `test_qn_group_results` dataset goes here
test_qn_batch_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,2.5,2.75,6,5,6.5,6,8.5,7.5
B,4.25,2.75,4.75,3,5,7.25,6.5,6.75
C,5,4,3,4.25,8.5,5,7.25,6.75
D,3,4.75,4,4.25,6.5,8.5,5.5,5.5
E,4.25,4.75,4.75,6,7.5,7.25,7.25,8.5"
)


## code to prepare `test_qn_group_results` dataset goes here
test_qn_smooth_results <- metamorphr::read_featuretable(
  "label,S1,S2,S3,S4,S5,S6,S7,S8
A,3.02,3.4,5.65,4.89,6.46,5.98,8.35,7.36
B,4.6,3.4,4.6,3.02,4.98,7.15,5.98,6.46
C,5.65,4.31,3.02,4.04,8.35,4.98,7.15,6.46
D,3.77,5.27,3.77,4.04,6.46,8.35,4.98,4.98
E,4.6,5.27,4.6,5.65,7.36,7.15,7.15,8.35"
)

## results were externally calculated
test_normalize_ref_uid_2 <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,1.333333333,0.5,0.8,0,4.5,2,0.777777778,3,0.5,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,1,1,1,1,1,1,1,1,1,1,1
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,0.333333333,0.2,2.666666667,3.5,2,0.555555556,2.5,1,0,0
417.23236 Da 60.08 s,1,418.24019,,,1.666666667,1.5,1.4,1,0,2.25,0.666666667,0.5,1.333333333,1.5,0.555555556
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,1.666666667,1,0.8,3,4,1.25,0.555555556,0,0.333333333,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,1.666666667,0,1.2,1.333333333,1.5,2,0.555555556,1,0.166666667,2,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,3,3.5,2.25,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,1,0.666666667,0.4,1.333333333,1.5,0,0.333333333,1.5,0.5,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,1.333333333,0.5,0.8,2.333333333,4,2,0.333333333,1.5,0.666666667,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,0.833333333,0,0,1,0,0,1.5,0,0,0",
  metadata_cols = 2:5
)


test_normalize_ref_uid_2_mul_mean <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,6.424242424,2.409090909,3.854545455,0,21.68181818,9.636363636,3.747474747,14.45454545,2.409090909,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818,4.818181818
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,1.606060606,0.963636364,12.84848485,16.86363636,9.636363636,2.676767677,12.04545455,4.818181818,0,0
417.23236 Da 60.08 s,1,418.24019,,,8.03030303,7.227272727,6.745454545,4.818181818,0,10.84090909,3.212121212,2.409090909,6.424242424,7.227272727,2.676767677
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,8.03030303,4.818181818,3.854545455,14.45454545,19.27272727,6.022727273,2.676767677,0,1.606060606,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,8.03030303,0,5.781818182,6.424242424,7.227272727,9.636363636,2.676767677,4.818181818,0.803030303,9.636363636,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,14.45454545,16.86363636,10.84090909,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,4.818181818,3.212121212,1.927272727,6.424242424,7.227272727,0,1.606060606,7.227272727,2.409090909,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,6.424242424,2.409090909,3.854545455,11.24242424,19.27272727,9.636363636,1.606060606,7.227272727,3.212121212,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,4.015151515,0,0,4.818181818,0,0,7.227272727,0,0,0",
  metadata_cols = 2:5
)


test_normalize_ref_uid_2_mul_med <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,5.333333333,2,3.2,0,18,8,3.111111111,12,2,0,0
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,4,4,4,4,4,4,4,4,4,4,4
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,1.333333333,0.8,10.66666667,14,8,2.222222222,10,4,0,0
417.23236 Da 60.08 s,1,418.24019,,,6.666666667,6,5.6,4,0,9,2.666666667,2,5.333333333,6,2.222222222
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,6.666666667,4,3.2,12,16,5,2.222222222,0,1.333333333,0,0
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,6.666666667,0,4.8,5.333333333,6,8,2.222222222,4,0.666666667,8,0
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,12,14,9,0,0,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,4,2.666666667,1.6,5.333333333,6,0,1.333333333,6,2,0,0
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,5.333333333,2,3.2,9.333333333,16,8,1.333333333,6,2.666666667,0,0
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,3.333333333,0,0,4,0,0,6,0,0,0",
  metadata_cols = 2:5
)

test_normalize_ref_name_adp <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,1,1,1,0,1.125,1,2.333333333,2,0.75
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,0.75,2,1.25,0.428571429,0.25,0.5,3,0.666666667,1.5
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,0,0.666666667,0.25,1.142857143,0.875,1,1.666666667,1.666666667,1.5
417.23236 Da 60.08 s,1,418.24019,,,1.25,3,1.75,0.428571429,0,1.125,2,0.333333333,2
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,1.25,2,1,1.285714286,1,0.625,1.666666667,0,0.5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,1.25,0,1.5,0.571428571,0.375,1,1.666666667,0.666666667,0.25
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,0,0,0,1.285714286,0.875,1.125,0,0,0
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,0.75,1.333333333,0.5,0.571428571,0.375,0,1,1,0.75
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,1,1,1,1,1,1,1,1,1
1284.34904 Da 498.94 s,8.32,1285.35687,,,0,1.666666667,0,0,0.25,0,0,1,0",
  metadata_cols = 2:5
)

test_impute_mean <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,5.5,9,8,7,6,3,5.5,5.5
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,5.25,2,1,8,7,8,5,5,6,5.25,5.25
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,5.9,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,5.5,2,5.5,5.5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,4.666666667,6,4,3,8,5,2,1,8,4.666666667
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,8.333333333,8.333333333,8.333333333,9,7,9,8.333333333,8.333333333,8.333333333,8.333333333,8.333333333
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,3.125,3,3,3,3.125,3.125
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,4.888888889,4.888888889
1284.34904 Da 498.94 s,8.32,1285.35687,,,3.333333333,5,3.333333333,3.333333333,2,3.333333333,3.333333333,3,3.333333333,3.333333333,3.333333333",
  metadata_cols = 2:5
)

test_impute_min <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,3,9,8,7,6,3,3,3
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,1,2,1,8,7,8,5,5,6,1,1
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,1,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,2,2,2,2
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,1,6,4,3,8,5,2,1,8,1
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,7,7,7,9,7,9,7,7,7,7,7
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,2,3,3,3,2,2
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,3,3
1284.34904 Da 498.94 s,8.32,1285.35687,,,2,5,2,2,2,2,2,3,2,2,2",
  metadata_cols = 2:5
)


test_impute_median <- metamorphr::read_featuretable(
  "Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,QC1,QC2,QC3,Blank1,Blank2
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,5,9,8,7,6,3,5,5
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4,9,2,6,4,9
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,5.5,2,1,8,7,8,5,5,6,5.5,5.5
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,6,9,6,1,8,6,5
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5,5,5,2,5,5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,5,6,4,3,8,5,2,1,8,5
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,9,9,9,9,7,9,9,9,9,9,9
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,3,3,3,3,3,3
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8,3,3,4,4,4
1284.34904 Da 498.94 s,8.32,1285.35687,,,3,5,3,3,2,3,3,3,3,3,3",
  metadata_cols = 2:5
)

# results for collapse functions were calculated from
# toy_metaboscape %>% join_metadata(toy_metaboscape_metadata2) %>% impute_lod(); where toy_metaboscape_metadata2 is toy_metaboscape_metadata with Replicate = 1 for each sample

test_collapse_mean <- metamorphr::read_featuretable(
  "UID,control_1,treatment_1,QC_1,blank_1
1,3.666666667,5.866666667,5.333333333,0.6
2,4.666666667,3,5.666666667,6.5
3,1.066666667,7.666666667,5.333333333,0.2
4,7,4.066666667,5,5.5
5,5,7.333333333,2.466666667,0.4
6,3.733333333,5,2.666666667,4.1
7,1.4,8.333333333,1.4,1.4
8,3,2.466666667,3,0.4
9,3.666666667,7.666666667,3.333333333,0.6
10,1.933333333,0.933333333,1.266666667,0.4"
)

test_collapse_mean_batches <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,0.6,0.6,7,6,3,4,3,4,0.6,9,8,0.6,0.6,8,6,8,1.2,18,16,1.2,1.2,12,9,12,1.8,27,24
2,4,9,9,2,6,3,6,5,3,2,4,4,9,6,12,10,6,4,8,8,18,9,18,15,9,6,12
3,0.2,0.2,5,5,6,0.2,2,1,8,7,8,0.2,0.2,0.4,4,2,16,14,16,0.4,0.4,0.6,6,3,24,21,24
4,6,5,6,1,8,5,9,7,3,0.2,9,6,5,10,18,14,6,0.4,18,12,10,15,27,21,9,0.6,27
5,0.4,0.4,5,0.4,2,5,6,4,9,8,5,0.4,0.4,10,12,8,18,16,10,0.8,0.8,15,18,12,27,24,15
6,8,0.2,5,2,1,5,0.2,6,4,3,8,8,0.2,10,0.4,12,8,6,16,16,0.4,15,0.6,18,12,9,24
7,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,9,7,9,1.4,1.4,2.8,2.8,2.8,18,14,18,2.8,2.8,4.2,4.2,4.2,27,21,27
8,0.4,0.4,3,3,3,3,4,2,4,3,0.4,0.4,0.4,6,8,4,8,6,0.8,0.8,0.8,9,12,6,12,9,1.2
9,0.6,0.6,3,3,4,4,3,4,7,8,8,0.6,0.6,8,6,8,14,16,16,1.2,1.2,12,9,12,21,24,24
10,0.4,0.4,0.4,3,0.4,0.4,5,0.4,0.4,2,0.4,0.4,0.4,0.8,10,0.8,0.8,4,0.8,0.8,0.8,1.2,15,1.2,1.2,6,1.2")

test_collapse_mean_batches_results <- metamorphr::read_featuretable("UID,blank_1_1,QC_1_1,control_1_1,treatment_1_1,blank_2_1,control_2_1,treatment_2_1,blank_3_1,control_3_1,treatment_3_1
1,0.6,5.333333333,3.666666667,5.866666667,0.6,7.333333333,11.73333333,1.2,11,17.6
2,6.5,5.666666667,4.666666667,3,6.5,9.333333333,6,13,14,9
3,0.2,5.333333333,1.066666667,7.666666667,0.2,2.133333333,15.33333333,0.4,3.2,23
4,5.5,5,7,4.066666667,5.5,14,8.133333333,11,21,12.2
5,0.4,2.466666667,5,7.333333333,0.4,10,14.66666667,0.8,15,22
6,4.1,2.666666667,3.733333333,5,4.1,7.466666667,10,8.2,11.2,15
7,1.4,1.4,1.4,8.333333333,1.4,2.8,16.66666667,2.8,4.2,25
8,0.4,3,3,2.466666667,0.4,6,4.933333333,0.8,9,7.4
9,0.6,3.333333333,3.666666667,7.666666667,0.6,7.333333333,15.33333333,1.2,11,23
10,0.4,1.266666667,1.933333333,0.933333333,0.4,3.866666667,1.866666667,0.8,5.8,2.8")

test_collapse_median <- metamorphr::read_featuretable("UID,control_1,treatment_1,QC_1,blank_1
1,4,8,6,0.6
2,5,3,6,6.5
3,1,8,5,0.2
4,7,3,6,5.5
5,5,8,2,0.4
6,5,4,2,4.1
7,1.4,9,1.4,1.4
8,3,3,3,0.4
9,4,8,3,0.6
10,0.4,0.4,0.4,0.4")

test_collapse_median_batches_results <- metamorphr::read_featuretable("UID,blank_1_1,QC_1_1,control_1_1,treatment_1_1,blank_2_1,control_2_1,treatment_2_1,blank_3_1,control_3_1,treatment_3_1
1,0.6,6,4,8,0.6,8,16,1.2,12,24
2,6.5,6,5,3,6.5,10,6,13,15,9
3,0.2,5,1,8,0.2,2,16,0.4,3,24
4,5.5,6,7,3,5.5,14,6,11,21,9
5,0.4,2,5,8,0.4,10,16,0.8,15,24
6,4.1,2,5,4,4.1,10,8,8.2,15,12
7,1.4,1.4,1.4,9,1.4,2.8,18,2.8,4.2,27
8,0.4,3,3,3,0.4,6,6,0.8,9,9
9,0.6,3,4,8,0.6,8,16,1.2,12,24
10,0.4,0.4,0.4,0.4,0.4,0.8,0.8,0.8,1.2,1.2")

test_collapse_min <- metamorphr::read_featuretable("UID,control_1,treatment_1,QC_1,blank_1
1,3,0.6,3,0.6
2,3,2,2,4
3,0.2,7,5,0.2
4,5,0.2,1,5
5,4,5,0.4,0.4
6,0.2,3,1,0.2
7,1.4,7,1.4,1.4
8,2,0.4,3,0.4
9,3,7,3,0.6
10,0.4,0.4,0.4,0.4")

test_collapse_min_batches_results <- metamorphr::read_featuretable("UID,blank_1_1,QC_1_1,control_1_1,treatment_1_1,blank_2_1,control_2_1,treatment_2_1,blank_3_1,control_3_1,treatment_3_1
1,0.6,3,3,0.6,0.6,6,1.2,1.2,9,1.8
2,4,2,3,2,4,6,4,8,9,6
3,0.2,5,0.2,7,0.2,0.4,14,0.4,0.6,21
4,5,1,5,0.2,5,10,0.4,10,15,0.6
5,0.4,0.4,4,5,0.4,8,10,0.8,12,15
6,0.2,1,0.2,3,0.2,0.4,6,0.4,0.6,9
7,1.4,1.4,1.4,7,1.4,2.8,14,2.8,4.2,21
8,0.4,3,2,0.4,0.4,4,0.8,0.8,6,1.2
9,0.6,3,3,7,0.6,6,14,1.2,9,21
10,0.4,0.4,0.4,0.4,0.4,0.8,0.8,0.8,1.2,1.2")

test_collapse_max <- metamorphr::read_featuretable("UID,control_1,treatment_1,QC_1,blank_1
1,4,9,7,0.6
2,6,4,9,9
3,2,8,6,0.2
4,9,9,8,6
5,6,9,5,0.4
6,6,8,5,8
7,1.4,9,1.4,1.4
8,4,4,3,0.4
9,4,8,4,0.6
10,5,2,3,0.4")

test_collapse_max_batches_results <- metamorphr::read_featuretable("UID,blank_1_1,QC_1_1,control_1_1,treatment_1_1,blank_2_1,control_2_1,treatment_2_1,blank_3_1,control_3_1,treatment_3_1
1,0.6,7,4,9,0.6,8,18,1.2,12,27
2,9,9,6,4,9,12,8,18,18,12
3,0.2,6,2,8,0.2,4,16,0.4,6,24
4,6,8,9,9,6,18,18,12,27,27
5,0.4,5,6,9,0.4,12,18,0.8,18,27
6,8,5,6,8,8,12,16,16,18,24
7,1.4,1.4,1.4,9,1.4,2.8,18,2.8,4.2,27
8,0.4,3,4,4,0.4,8,8,0.8,12,12
9,0.6,4,4,8,0.6,8,16,1.2,12,24
10,0.4,3,5,2,0.4,10,4,0.8,15,6")

test_plot_volcano_input <- metamorphr::read_featuretable("Bucket label,RT,m/z,Name,Formula,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6
161.10519 Da 26.98 s,0.45,162.11302,,C7H15NO3,4,3,4,1,9,8
276.13647 Da 27.28 s,0.45,277.1443,Octyl hydrogen phthalate,C16H22O4,3,6,5,3,2,4
304.24023 Da 32.86 s,0.55,305.24806,Arachidonic acid,C20H32O2,1,2,1,8,7,8
417.23236 Da 60.08 s,1,418.24019,,,5,9,7,3,1,9
104.10753 Da 170.31 s,2.84,105.11536,,C5H14NO,5,6,4,9,8,5
105.04259 Da 199.80 s,3.33,106.05042,,C3H8NO3,5,1,6,4,3,8
237.09204 Da 313.24 s,5.22,238.09987,Ketamine,C13H16ClNO,1,1,1,9,7,9
745.09111 Da 382.23 s,6.37,746.09894,NADPH,C21H30N7O17P3,3,4,2,4,3,1
427.02942 Da 424.84 s,7.08,428.03725,ADP,C10H15N5O10P2,4,3,4,7,8,8
1284.34904 Da 498.94 s,8.32,1285.35687,,,1,5,1,1,2,1", metadata_cols = 2:5) %>%
  dplyr::mutate(Group = dplyr::case_when(Sample %in% paste0("Sample", 1:3) ~ "control",
    .default = "treatment"
  ))

test_plot_volcano_results <- readr::read_csv("UID,log2fc,p_val,n_log_p_val
1,0.710493383,0.452212845,0.344657106
2,-0.637429921,0.20017304,0.698594416
3,2.523561956,0.000177551,3.750675688
4,-0.691877705,0.393853907,0.404664842
5,0.552541023,0.182349635,0.739095101
6,0.321928095,0.667492181,0.175553817
7,3.058893689,0.008163402,2.088128824
8,-0.169925001,0.770025638,0.113494815
9,1.064130337,0.001057565,2.975693088
10,-0.807354922,0.535105745,0.271560386")

test_plot_volcano_results_log2_before <- readr::read_csv("UID,log2fc,p_val,n_log_p_val
1,0.710493383,0.867882822,0.061538907
2,-0.637429921,0.201995,0.694659381
3,2.523561956,0.013505854,1.86947795
4,-0.691877705,0.324928713,0.488211909
5,0.552541023,0.174324768,0.758640903
6,0.321928095,0.587357408,0.23109755
7,3.058893689,0.001567419,2.804814911
8,-0.169925001,0.656781229,0.182579268
9,1.064130337,0.007156051,2.145326549
10,-0.807354922,0.640658176,0.193373627")

# calculations for scale functions are based on this data frame:
test_scale_input <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,0.6,0.6,7,6,3,4,3,4,0.6,9,8,0.6,0.6,8,6,8,1.2,18,16,1.2,1.2,12,9,12,1.8,27,24
2,4,9,9,2,6,3,6,5,3,2,4,4,9,6,12,10,6,4,8,8,18,9,18,15,9,6,12
3,0.2,0.2,5,5,6,0.2,2,1,8,7,8,0.2,0.2,0.4,4,2,16,14,16,0.4,0.4,0.6,6,3,24,21,24
4,6,5,6,1,8,5,9,7,3,0.2,9,6,5,10,18,14,6,0.4,18,12,10,15,27,21,9,0.6,27
5,0.4,0.4,5,0.4,2,5,6,4,9,8,5,0.4,0.4,10,12,8,18,16,10,0.8,0.8,15,18,12,27,24,15
6,8,0.2,5,2,1,5,0.2,6,4,3,8,8,0.2,10,0.4,12,8,6,16,16,0.4,15,0.6,18,12,9,24
7,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,9,7,9,1.4,1.4,2.8,2.8,2.8,18,14,18,2.8,2.8,4.2,4.2,4.2,27,21,27
8,0.4,0.4,3,3,3,3,4,2,4,3,0.4,0.4,0.4,6,8,4,8,6,0.8,0.8,0.8,9,12,6,12,9,1.2
9,0.6,0.6,3,3,4,4,3,4,7,8,8,0.6,0.6,8,6,8,14,16,16,1.2,1.2,12,9,12,21,24,24
10,0.4,0.4,0.4,3,0.4,0.4,5,0.4,0.4,2,0.4,0.4,0.4,0.8,10,0.8,0.8,4,0.8,0.8,0.8,1.2,15,1.2,1.2,6,1.2")

test_scale_center_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-6.525925926,-6.525925926,-0.125925926,-1.125925926,-4.125925926,-3.125925926,-4.125925926,-3.125925926,-6.525925926,1.874074074,0.874074074,-6.525925926,-6.525925926,0.874074074,-1.125925926,0.874074074,-5.925925926,10.87407407,8.874074074,-5.925925926,-5.925925926,4.874074074,1.874074074,4.874074074,-5.325925926,19.87407407,16.87407407
2,-3.666666667,1.333333333,1.333333333,-5.666666667,-1.666666667,-4.666666667,-1.666666667,-2.666666667,-4.666666667,-5.666666667,-3.666666667,-3.666666667,1.333333333,-1.666666667,4.333333333,2.333333333,-1.666666667,-3.666666667,0.333333333,0.333333333,10.33333333,1.333333333,10.33333333,7.333333333,1.333333333,-1.666666667,4.333333333
3,-6.274074074,-6.274074074,-1.474074074,-1.474074074,-0.474074074,-6.274074074,-4.474074074,-5.474074074,1.525925926,0.525925926,1.525925926,-6.274074074,-6.274074074,-6.074074074,-2.474074074,-4.474074074,9.525925926,7.525925926,9.525925926,-6.074074074,-6.074074074,-5.874074074,-0.474074074,-3.474074074,17.52592593,14.52592593,17.52592593
4,-3.562962963,-4.562962963,-3.562962963,-8.562962963,-1.562962963,-4.562962963,-0.562962963,-2.562962963,-6.562962963,-9.362962963,-0.562962963,-3.562962963,-4.562962963,0.437037037,8.437037037,4.437037037,-3.562962963,-9.162962963,8.437037037,2.437037037,0.437037037,5.437037037,17.43703704,11.43703704,-0.562962963,-8.962962963,17.43703704
5,-8.214814815,-8.214814815,-3.614814815,-8.214814815,-6.614814815,-3.614814815,-2.614814815,-4.614814815,0.385185185,-0.614814815,-3.614814815,-8.214814815,-8.214814815,1.385185185,3.385185185,-0.614814815,9.385185185,7.385185185,1.385185185,-7.814814815,-7.814814815,6.385185185,9.385185185,3.385185185,18.38518519,15.38518519,6.385185185
6,0.666666667,-7.133333333,-2.333333333,-5.333333333,-6.333333333,-2.333333333,-7.133333333,-1.333333333,-3.333333333,-4.333333333,0.666666667,0.666666667,-7.133333333,2.666666667,-6.933333333,4.666666667,0.666666667,-1.333333333,8.666666667,8.666666667,-6.933333333,7.666666667,-6.733333333,10.66666667,4.666666667,1.666666667,16.66666667
7,-5.659259259,-5.659259259,-5.659259259,-5.659259259,-5.659259259,-5.659259259,-5.659259259,-5.659259259,1.940740741,-0.059259259,1.940740741,-5.659259259,-5.659259259,-4.259259259,-4.259259259,-4.259259259,10.94074074,6.940740741,10.94074074,-4.259259259,-4.259259259,-2.859259259,-2.859259259,-2.859259259,19.94074074,13.94074074,19.94074074
8,-3.696296296,-3.696296296,-1.096296296,-1.096296296,-1.096296296,-1.096296296,-0.096296296,-2.096296296,-0.096296296,-1.096296296,-3.696296296,-3.696296296,-3.696296296,1.903703704,3.903703704,-0.096296296,3.903703704,1.903703704,-3.296296296,-3.296296296,-3.296296296,4.903703704,7.903703704,1.903703704,7.903703704,4.903703704,-2.896296296
9,-7.503703704,-7.503703704,-5.103703704,-5.103703704,-4.103703704,-4.103703704,-5.103703704,-4.103703704,-1.103703704,-0.103703704,-0.103703704,-7.503703704,-7.503703704,-0.103703704,-2.103703704,-0.103703704,5.896296296,7.896296296,7.896296296,-6.903703704,-6.903703704,3.896296296,0.896296296,3.896296296,12.8962963,15.8962963,15.8962963
10,-1.77037037,-1.77037037,-1.77037037,0.82962963,-1.77037037,-1.77037037,2.82962963,-1.77037037,-1.77037037,-0.17037037,-1.77037037,-1.77037037,-1.77037037,-1.37037037,7.82962963,-1.37037037,-1.37037037,1.82962963,-1.37037037,-1.37037037,-1.37037037,-0.97037037,12.82962963,-0.97037037,-0.97037037,3.82962963,-0.97037037")

test_scale_auto_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-0.910272985,-0.910272985,-0.017564859,-0.157050504,-0.575507438,-0.436021793,-0.575507438,-0.436021793,-0.910272985,0.26140643,0.121920786,-0.910272985,-0.910272985,0.121920786,-0.157050504,0.121920786,-0.826581598,1.516777232,1.237805943,-0.826581598,-0.826581598,0.679863364,0.26140643,0.679863364,-0.742890211,2.772148034,2.3536911
2,-0.834461388,0.303440505,0.303440505,-1.289622145,-0.379300631,-1.062041766,-0.379300631,-0.606881009,-1.062041766,-1.289622145,-0.834461388,-0.834461388,0.303440505,-0.379300631,0.98618164,0.531020883,-0.379300631,-0.834461388,0.075860126,0.075860126,2.351663911,0.303440505,2.351663911,1.668922776,0.303440505,-0.379300631,0.98618164
3,-0.825093391,-0.825093391,-0.193853111,-0.193853111,-0.062344719,-0.825093391,-0.588378286,-0.719886678,0.200672064,0.069163673,0.200672064,-0.825093391,-0.825093391,-0.798791713,-0.325361503,-0.588378286,1.252739198,0.989722415,1.252739198,-0.798791713,-0.798791713,-0.772490035,-0.062344719,-0.456869894,2.304806333,1.910281157,2.304806333
4,-0.480698327,-0.615613658,-0.480698327,-1.155274981,-0.210867665,-0.615613658,-0.075952334,-0.345782996,-0.88544432,-1.263207246,-0.075952334,-0.480698327,-0.615613658,0.058962996,1.138285643,0.59862432,-0.480698327,-1.23622418,1.138285643,0.328793658,0.058962996,0.733539651,2.352523621,1.543031636,-0.075952334,-1.209241114,2.352523621
5,-1.086878884,-1.086878884,-0.478265911,-1.086878884,-0.875187415,-0.478265911,-0.345958743,-0.610573079,0.050962761,-0.081344407,-0.478265911,-1.086878884,-1.086878884,0.183269929,0.447884265,-0.081344407,1.241727274,0.977112938,0.183269929,-1.033956017,-1.033956017,0.844805769,1.241727274,0.447884265,2.432491786,2.035570282,0.844805769
6,0.104272465,-1.11571538,-0.364953629,-0.834179723,-0.990588421,-0.364953629,-1.11571538,-0.208544931,-0.521362327,-0.677771025,0.104272465,0.104272465,-1.11571538,0.417089862,-1.08443364,0.729907258,0.104272465,-0.208544931,1.35554205,1.35554205,-1.08443364,1.199133352,-1.053151901,1.668359446,0.729907258,0.260681164,2.606811635
7,-0.695750638,-0.695750638,-0.695750638,-0.695750638,-0.695750638,-0.695750638,-0.695750638,-0.695750638,0.238595114,-0.007285347,0.238595114,-0.695750638,-0.695750638,-0.523634315,-0.523634315,-0.523634315,1.345057189,0.853296267,1.345057189,-0.523634315,-0.523634315,-0.351517992,-0.351517992,-0.351517992,2.451519263,1.71387788,2.451519263
8,-1.031119392,-1.031119392,-0.305822986,-0.305822986,-0.305822986,-0.305822986,-0.02686283,-0.584783142,-0.02686283,-0.305822986,-1.031119392,-1.031119392,-1.031119392,0.531057482,1.088977795,-0.02686283,1.088977795,0.531057482,-0.91953533,-0.91953533,-0.91953533,1.367937951,2.20481842,0.531057482,2.20481842,1.367937951,-0.807951267
9,-1.05422086,-1.05422086,-0.717036695,-0.717036695,-0.576543293,-0.576543293,-0.717036695,-0.576543293,-0.155063088,-0.014569686,-0.014569686,-1.05422086,-1.05422086,-0.014569686,-0.29555649,-0.014569686,0.828390725,1.109377529,1.109377529,-0.969924819,-0.969924819,0.547403921,0.125923716,0.547403921,1.811844538,2.233324743,2.233324743
10,-0.522039515,-0.522039515,-0.522039515,0.244637764,-0.522039515,-0.522039515,0.834389518,-0.522039515,-0.522039515,-0.050238112,-0.522039515,-0.522039515,-0.522039515,-0.404089164,2.308768901,-0.404089164,-0.404089164,0.539513641,-0.404089164,-0.404089164,-0.404089164,-0.286138814,3.783148284,-0.286138814,-0.286138814,1.129265394,-0.286138814")

test_scale_range_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-0.247194164,-0.247194164,-0.004769921,-0.042648709,-0.156285073,-0.118406285,-0.156285073,-0.118406285,-0.247194164,0.070987654,0.033108866,-0.247194164,-0.247194164,0.033108866,-0.042648709,0.033108866,-0.224466891,0.411896745,0.336139169,-0.224466891,-0.224466891,0.184624018,0.070987654,0.184624018,-0.201739618,0.752805836,0.639169473
2,-0.229166667,0.083333333,0.083333333,-0.354166667,-0.104166667,-0.291666667,-0.104166667,-0.166666667,-0.291666667,-0.354166667,-0.229166667,-0.229166667,0.083333333,-0.104166667,0.270833333,0.145833333,-0.104166667,-0.229166667,0.020833333,0.020833333,0.645833333,0.083333333,0.645833333,0.458333333,0.083333333,-0.104166667,0.270833333
3,-0.263616558,-0.263616558,-0.061935885,-0.061935885,-0.019919079,-0.263616558,-0.187986306,-0.230003112,0.064114535,0.022097728,0.064114535,-0.263616558,-0.263616558,-0.255213196,-0.103952692,-0.187986306,0.400248988,0.316215375,0.400248988,-0.255213196,-0.255213196,-0.246809835,-0.019919079,-0.145969499,0.736383442,0.610333022,0.736383442
4,-0.132946379,-0.170259812,-0.132946379,-0.319513543,-0.058319514,-0.170259812,-0.021006081,-0.095632946,-0.244886678,-0.34936429,-0.021006081,-0.132946379,-0.170259812,0.016307352,0.314814815,0.165561083,-0.132946379,-0.341901603,0.314814815,0.090934218,0.016307352,0.202874516,0.65063571,0.426755113,-0.021006081,-0.334438917,0.65063571
5,-0.308827625,-0.308827625,-0.135895294,-0.308827625,-0.248677249,-0.135895294,-0.098301309,-0.173489279,0.014480646,-0.023113339,-0.135895294,-0.308827625,-0.308827625,0.052074631,0.127262601,-0.023113339,0.352826511,0.277638541,0.052074631,-0.293790031,-0.293790031,0.240044556,0.352826511,0.127262601,0.691172375,0.57839042,0.240044556
6,0.028011204,-0.299719888,-0.098039216,-0.224089636,-0.266106443,-0.098039216,-0.299719888,-0.056022409,-0.140056022,-0.182072829,0.028011204,0.028011204,-0.299719888,0.112044818,-0.291316527,0.196078431,0.028011204,-0.056022409,0.364145658,0.364145658,-0.291316527,0.322128852,-0.282913165,0.448179272,0.196078431,0.070028011,0.700280112
7,-0.221064815,-0.221064815,-0.221064815,-0.221064815,-0.221064815,-0.221064815,-0.221064815,-0.221064815,0.075810185,-0.002314815,0.075810185,-0.221064815,-0.221064815,-0.166377315,-0.166377315,-0.166377315,0.427372685,0.271122685,0.427372685,-0.166377315,-0.166377315,-0.111689815,-0.111689815,-0.111689815,0.778935185,0.544560185,0.778935185
8,-0.318646232,-0.318646232,-0.094508301,-0.094508301,-0.094508301,-0.094508301,-0.008301405,-0.180715198,-0.008301405,-0.094508301,-0.318646232,-0.318646232,-0.318646232,0.164112388,0.336526181,-0.008301405,0.336526181,0.164112388,-0.284163474,-0.284163474,-0.284163474,0.422733078,0.681353768,0.164112388,0.681353768,0.422733078,-0.249680715
9,-0.320671098,-0.320671098,-0.218106996,-0.218106996,-0.175371953,-0.175371953,-0.218106996,-0.175371953,-0.047166825,-0.004431782,-0.004431782,-0.320671098,-0.320671098,-0.004431782,-0.089901868,-0.004431782,0.251978474,0.33744856,0.33744856,-0.295030073,-0.295030073,0.166508389,0.038303261,0.166508389,0.551123773,0.679328902,0.679328902
10,-0.121258245,-0.121258245,-0.121258245,0.056823947,-0.121258245,-0.121258245,0.193810249,-0.121258245,-0.121258245,-0.011669203,-0.121258245,-0.121258245,-0.121258245,-0.093860984,0.536276002,-0.093860984,-0.093860984,0.125317098,-0.093860984,-0.093860984,-0.093860984,-0.066463724,0.878741755,-0.066463724,-0.066463724,0.262303399,-0.066463724")

test_scale_pareto_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-2.437288262,-2.437288262,-0.047030534,-0.420508304,-1.540941614,-1.167463844,-1.540941614,-1.167463844,-2.437288262,0.699925006,0.326447236,-2.437288262,-2.437288262,0.326447236,-0.420508304,0.326447236,-2.2132016,4.061224936,3.314269396,-2.2132016,-2.2132016,1.820358316,0.699925006,1.820358316,-1.989114938,7.422524865,6.302091555
2,-1.74919746,0.636071804,0.636071804,-2.703305166,-0.795089755,-2.226251313,-0.795089755,-1.272143608,-2.226251313,-2.703305166,-1.74919746,-1.74919746,0.636071804,-0.795089755,2.067233362,1.113125657,-0.795089755,-1.74919746,0.159017951,0.159017951,4.929556479,0.636071804,4.929556479,3.498394921,0.636071804,-0.795089755,2.067233362
3,-2.275235604,-2.275235604,-0.534559487,-0.534559487,-0.171918629,-2.275235604,-1.62248206,-1.985122918,0.553363087,0.190722229,0.553363087,-2.275235604,-2.275235604,-2.202707433,-0.897200345,-1.62248206,3.454489949,2.729208234,3.454489949,-2.202707433,-2.202707433,-2.130179261,-0.171918629,-1.259841202,6.355616812,5.267694238,6.355616812
4,-1.308705595,-1.676013819,-1.308705595,-3.145246712,-0.574089149,-1.676013819,-0.206780926,-0.941397372,-2.410630265,-3.43909329,-0.206780926,-1.308705595,-1.676013819,0.160527298,3.098993084,1.629760191,-1.308705595,-3.365631646,3.098993084,0.895143744,0.160527298,1.997068414,6.404767093,4.200917753,-0.206780926,-3.292170001,6.404767093
5,-2.988061037,-2.988061037,-1.314854631,-2.988061037,-2.4060762,-1.314854631,-0.951114108,-1.678595154,0.140107461,-0.223633062,-1.314854631,-2.988061037,-2.988061037,0.503847984,1.23132903,-0.223633062,3.413772168,2.686291122,0.503847984,-2.842564828,-2.842564828,2.322550599,3.413772168,1.23132903,6.687436875,5.596215306,2.322550599
6,0.26365693,-2.821129155,-0.922799256,-2.109255443,-2.504740839,-0.922799256,-2.821129155,-0.527313861,-1.318284652,-1.713770047,0.26365693,0.26365693,-2.821129155,1.054627722,-2.742032076,1.845598513,0.26365693,-0.527313861,3.427540095,3.427540095,-2.742032076,3.032054699,-2.662934997,4.218510886,1.845598513,0.659142326,6.591423259
7,-1.984296661,-1.984296661,-1.984296661,-1.984296661,-1.984296661,-1.984296661,-1.984296661,-1.984296661,0.680478698,-0.020777976,0.680478698,-1.984296661,-1.984296661,-1.49341699,-1.49341699,-1.49341699,3.836133729,2.433620382,3.836133729,-1.49341699,-1.49341699,-1.002537318,-1.002537318,-1.002537318,6.991788759,4.888018739,6.991788759
8,-1.952260943,-1.952260943,-0.579027294,-0.579027294,-0.579027294,-0.579027294,-0.050860506,-1.107194082,-0.050860506,-0.579027294,-1.952260943,-1.952260943,-1.952260943,1.005473071,2.061806647,-0.050860506,2.061806647,1.005473071,-1.740994228,-1.740994228,-1.740994228,2.589973436,4.1744738,1.005473071,4.1744738,2.589973436,-1.529727513
9,-2.812571949,-2.812571949,-1.912993162,-1.912993162,-1.538168667,-1.538168667,-1.912993162,-1.538168667,-0.413695183,-0.038870688,-0.038870688,-2.812571949,-2.812571949,-0.038870688,-0.788519678,-0.038870688,2.21007628,2.959725269,2.959725269,-2.587677252,-2.587677252,1.460427291,0.335953806,1.460427291,4.833847743,5.958321227,5.958321227
10,-0.961354924,-0.961354924,-0.961354924,0.45050942,-0.961354924,-0.961354924,1.536558916,-0.961354924,-0.961354924,-0.092515327,-0.961354924,-0.961354924,-0.961354924,-0.744145025,4.251682655,-0.744145025,-0.744145025,0.993534168,-0.744145025,-0.744145025,-0.744145025,-0.526935126,6.966806393,-0.526935126,-0.526935126,2.079583664,-0.526935126")

test_scale_vast_u_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-0.904778915,-0.904778915,-0.017458844,-0.156102605,-0.572033889,-0.433390127,-0.572033889,-0.433390127,-0.904778915,0.259828678,0.121184917,-0.904778915,-0.904778915,0.121184917,-0.156102605,0.121184917,-0.821592659,1.507622529,1.230335006,-0.821592659,-0.821592659,0.675759962,0.259828678,0.675759962,-0.738406402,2.755416379,2.339485095
2,-1.455953962,0.529437804,0.529437804,-2.250110668,-0.661797255,-1.853032315,-0.661797255,-1.058875609,-1.853032315,-2.250110668,-1.455953962,-1.455953962,0.529437804,-0.661797255,1.720672864,0.926516158,-0.661797255,-1.455953962,0.132359451,0.132359451,4.103142984,0.529437804,4.103142984,2.911907924,0.529437804,-0.661797255,1.720672864
3,-0.702480445,-0.702480445,-0.165045583,-0.165045583,-0.053079986,-0.702480445,-0.500942372,-0.612907968,0.170851206,0.05888561,0.170851206,-0.702480445,-0.702480445,-0.680087326,-0.277011179,-0.500942372,1.066575977,0.842644784,1.066575977,-0.680087326,-0.680087326,-0.657694207,-0.053079986,-0.388976775,1.962300748,1.626403959,1.962300748
4,-0.620192325,-0.794258778,-0.620192325,-1.490524589,-0.272059419,-0.794258778,-0.097992966,-0.446125872,-1.142391683,-1.629777751,-0.097992966,-0.620192325,-0.794258778,0.076073487,1.46860511,0.772339298,-0.620192325,-1.594964461,1.46860511,0.424206393,0.076073487,0.946405751,3.035203186,1.990804468,-0.097992966,-1.56015117,3.035203186
5,-1.238826456,-1.238826456,-0.545128323,-1.238826456,-0.997540149,-0.545128323,-0.394324381,-0.695932265,0.058087444,-0.092716498,-0.545128323,-1.238826456,-1.238826456,0.208891386,0.51049927,-0.092716498,1.415322921,1.113715038,0.208891386,-1.178504879,-1.178504879,0.962911096,1.415322921,0.51049927,2.772558399,2.320146573,0.962911096
6,0.119600217,-1.279722327,-0.418600761,-0.95680174,-1.136202066,-0.418600761,-1.279722327,-0.239200435,-0.598001087,-0.777401413,0.119600217,0.119600217,-1.279722327,0.47840087,-1.243842262,0.837201522,0.119600217,-0.239200435,1.554802827,1.554802827,-1.243842262,1.375402501,-1.207962196,1.913603479,0.837201522,0.299000544,2.990005436
7,-0.603818992,-0.603818992,-0.603818992,-0.603818992,-0.603818992,-0.603818992,-0.603818992,-0.603818992,0.207068816,-0.006322712,0.207068816,-0.603818992,-0.603818992,-0.454444922,-0.454444922,-0.454444922,1.167330694,0.740547637,1.167330694,-0.454444922,-0.454444922,-0.305070852,-0.305070852,-0.305070852,2.127592572,1.487417987,2.127592572
8,-1.178263691,-1.178263691,-0.349464983,-0.349464983,-0.349464983,-0.349464983,-0.030696248,-0.668233717,-0.030696248,-0.349464983,-1.178263691,-1.178263691,-1.178263691,0.60684122,1.244378688,-0.030696248,1.244378688,0.60684122,-1.050756198,-1.050756198,-1.050756198,1.563147422,2.519453625,0.60684122,2.519453625,1.563147422,-0.923248704
9,-1.200248266,-1.200248266,-0.816358396,-0.816358396,-0.656404284,-0.656404284,-0.816358396,-0.656404284,-0.176541946,-0.016587834,-0.016587834,-1.200248266,-1.200248266,-0.016587834,-0.336496059,-0.016587834,0.943136841,1.263045066,1.263045066,-1.104275799,-1.104275799,0.623228616,0.143366279,0.623228616,2.062815628,2.542677965,2.542677965
10,-0.334099999,-0.334099999,-0.334099999,0.15656569,-0.334099999,-0.334099999,0.534000835,-0.334099999,-0.334099999,-0.032151883,-0.334099999,-0.334099999,-0.334099999,-0.25861297,1.477588699,-0.25861297,-0.25861297,0.345283263,-0.25861297,-0.25861297,-0.25861297,-0.183125941,2.421176562,-0.183125941,-0.183125941,0.722718408,-0.183125941")

test_scale_vast_s_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-2.35031474,-2.35031474,-0.045002055,-0.402371315,-1.474479096,-0.54940706,-0.725165243,-0.54940706,-1.146984882,0.329383854,0.153625671,-2.35031474,-2.35031474,0.153625671,-0.197890695,0.153625671,-1.041529972,1.9112075,1.559691134,-2.134224509,-2.134224509,0.856658402,0.329383854,0.856658402,-0.936075063,3.493031145,2.965756597
2,-1.411093716,0.513124988,0.489622068,-2.08089379,-0.612027585,-1.853684065,-0.662030023,-1.059248037,-1.853684065,-2.250902079,-1.456466051,-1.411093716,0.513124988,-0.662030023,1.72127806,0.926842032,-0.662030023,-1.456466051,0.132406005,0.128281247,3.976718653,0.529624018,4.104586143,2.912932102,0.529624018,-0.662030023,1.72127806
3,-2.130381976,-2.130381976,-1.790738331,-1.790738331,-0.575915845,-0.866488974,-0.617897686,-0.756003957,0.210739939,0.072633668,0.210739939,-2.130381976,-2.130381976,-0.83886772,-0.341685144,-0.617897686,1.315590107,1.039377565,1.315590107,-2.062471334,-2.062471334,-0.811246466,-0.065472603,-0.479791415,2.420440274,2.006121462,2.420440274
4,-1.197424087,-1.533499455,-0.666608641,-1.602078147,-0.292420838,-0.802213806,-0.098974431,-0.450594118,-1.153833494,-1.646101057,-0.098974431,-1.197424087,-1.533499455,0.076835413,1.483314165,0.780074789,-0.626403962,-1.610939088,1.483314165,0.819028118,0.146877383,0.955884633,3.06560276,2.010743696,-0.098974431,-1.57577712,3.06560276
5,-2.806309212,-2.806309212,-0.505183166,-1.148049448,-0.924443785,-0.906375399,-0.655636303,-1.157114495,0.096580985,-0.154158111,-0.906375399,-2.806309212,-2.806309212,0.347320081,0.848798273,-0.154158111,2.353232848,1.851754657,0.347320081,-2.669662957,-2.669662957,1.601015561,2.353232848,0.848798273,4.609884712,3.857667424,1.601015561
6,0.089037085,-0.952696815,-0.467514807,-1.068605272,-1.268968761,-0.487160384,-1.489318889,-0.278377362,-0.695943406,-0.904726428,0.139188681,0.089037085,-0.952696815,0.556754725,-1.447562285,0.974320769,0.139188681,-0.278377362,1.809452856,1.157482111,-0.925985689,1.600669834,-1.40580568,2.227018899,0.974320769,0.347971703,3.47971703
7,-1.796420423,-1.796420423,-Inf,-Inf,-Inf,-0.765321858,-0.765321858,-0.765321858,0.262453307,-0.008013841,0.262453307,-1.796420423,-1.796420423,-0.575994854,-0.575994854,-0.575994854,1.479555477,0.938621179,1.479555477,-1.352017988,-1.352017988,-0.38666785,-0.38666785,-0.38666785,2.696657646,1.8852562,2.696657646
8,-2.662338822,-2.662338822,-Inf,-Inf,-Inf,-0.464397868,-0.040791705,-0.888004031,-0.040791705,-0.464397868,-1.565773892,-2.662338822,-2.662338822,0.806420622,1.653632948,-0.040791705,1.653632948,0.806420622,-1.396331426,-2.374230012,-2.374230012,2.077239111,3.3480576,0.806420622,3.3480576,2.077239111,-1.226888961
9,-2.721986555,-2.721986555,-4.139813291,-4.139813291,-3.328674257,-0.990371622,-1.231707668,-0.990371622,-0.266363487,-0.025027442,-0.025027442,-2.721986555,-2.721986555,-0.025027442,-0.507699532,-0.025027442,1.422988829,1.90566092,1.90566092,-2.504335113,-2.504335113,0.940316739,0.216308603,0.940316739,3.112341145,3.836349281,3.836349281
10,-1.347900232,-1.347900232,-0.440507187,0.206430146,-0.440507187,-0.377586862,0.603507035,-0.377586862,-0.377586862,-0.036336811,-0.377586862,-1.347900232,-1.347900232,-0.292274349,1.669913445,-0.292274349,-0.292274349,0.390225753,-0.292274349,-1.043353736,-1.043353736,-0.206961837,2.736319855,-0.206961837,-0.206961837,0.816788317,-0.206961837")

test_scale_level_results <- metamorphr::read_featuretable("UID,Blank1,Blank2,QC1,QC2,QC3,Sample1,Sample2,Sample3,Sample4,Sample5,Sample6,Blank3,Blank4,Sample7,Sample8,Sample9,Sample10,Sample11,Sample12,Blank5,Blank13,Sample14,Sample15,Sample16,Sample17,Sample18,Sample19
1,-0.915800416,-0.915800416,-0.017671518,-0.158004158,-0.579002079,-0.438669439,-0.579002079,-0.438669439,-0.915800416,0.262993763,0.122661123,-0.915800416,-0.915800416,0.122661123,-0.158004158,0.122661123,-0.831600832,1.525987526,1.245322245,-0.831600832,-0.831600832,0.683991684,0.262993763,0.683991684,-0.747401247,2.788981289,2.367983368
2,-0.47826087,0.173913043,0.173913043,-0.739130435,-0.217391304,-0.608695652,-0.217391304,-0.347826087,-0.608695652,-0.739130435,-0.47826087,-0.47826087,0.173913043,-0.217391304,0.565217391,0.304347826,-0.217391304,-0.47826087,0.043478261,0.043478261,1.347826087,0.173913043,1.347826087,0.956521739,0.173913043,-0.217391304,0.565217391
3,-0.969107551,-0.969107551,-0.227688787,-0.227688787,-0.073226545,-0.969107551,-0.691075515,-0.845537757,0.235697941,0.081235698,0.235697941,-0.969107551,-0.969107551,-0.938215103,-0.38215103,-0.691075515,1.471395881,1.162471396,1.471395881,-0.938215103,-0.938215103,-0.907322654,-0.073226545,-0.536613272,2.707093822,2.243707094,2.707093822
4,-0.372579396,-0.477149497,-0.372579396,-0.895429899,-0.163439194,-0.477149497,-0.058869094,-0.268009295,-0.686289698,-0.97908598,-0.058869094,-0.372579396,-0.477149497,0.045701007,0.882261813,0.46398141,-0.372579396,-0.95817196,0.882261813,0.254841208,0.045701007,0.56855151,1.823392719,1.195972115,-0.058869094,-0.93725794,1.823392719
5,-0.953568358,-0.953568358,-0.419604471,-0.953568358,-0.767841788,-0.419604471,-0.303525365,-0.535683577,0.044711952,-0.071367154,-0.419604471,-0.953568358,-0.953568358,0.160791058,0.392949269,-0.071367154,1.089423904,0.857265692,0.160791058,-0.907136715,-0.907136715,0.741186586,1.089423904,0.392949269,2.134135856,1.785898538,0.741186586
6,0.090909091,-0.972727273,-0.318181818,-0.727272727,-0.863636364,-0.318181818,-0.972727273,-0.181818182,-0.454545455,-0.590909091,0.090909091,0.090909091,-0.972727273,0.363636364,-0.945454545,0.636363636,0.090909091,-0.181818182,1.181818182,1.181818182,-0.945454545,1.045454545,-0.918181818,1.454545455,0.636363636,0.227272727,2.272727273
7,-0.801678909,-0.801678909,-0.801678909,-0.801678909,-0.801678909,-0.801678909,-0.801678909,-0.801678909,0.274921301,-0.008394544,0.274921301,-0.801678909,-0.801678909,-0.603357817,-0.603357817,-0.603357817,1.549842602,0.983210913,1.549842602,-0.603357817,-0.603357817,-0.405036726,-0.405036726,-0.405036726,2.824763903,1.974816369,2.824763903
8,-0.902350814,-0.902350814,-0.267631103,-0.267631103,-0.267631103,-0.267631103,-0.023508137,-0.511754069,-0.023508137,-0.267631103,-0.902350814,-0.902350814,-0.902350814,0.464737794,0.952983725,-0.023508137,0.952983725,0.464737794,-0.804701627,-0.804701627,-0.804701627,1.197106691,1.929475588,0.464737794,1.929475588,1.197106691,-0.707052441
9,-0.925959781,-0.925959781,-0.629798903,-0.629798903,-0.506398537,-0.506398537,-0.629798903,-0.506398537,-0.136197441,-0.012797075,-0.012797075,-0.925959781,-0.925959781,-0.012797075,-0.259597806,-0.012797075,0.727605119,0.97440585,0.97440585,-0.851919561,-0.851919561,0.480804388,0.110603291,0.480804388,1.591407678,1.961608775,1.961608775
10,-0.815699659,-0.815699659,-0.815699659,0.38225256,-0.815699659,-0.815699659,1.303754266,-0.815699659,-0.815699659,-0.078498294,-0.815699659,-0.815699659,-0.815699659,-0.631399317,3.607508532,-0.631399317,-0.631399317,0.843003413,-0.631399317,-0.631399317,-0.631399317,-0.447098976,5.911262799,-0.447098976,-0.447098976,1.764505119,-0.447098976")

usethis::use_data(test_read_featuretable,
  test_create_metadata_skeleton,
  test_filters,
  test_filters_metadata1,
  test_filters_metadata2,
  test_qn_data,
  test_qn_metadata,
  test_qn_all_results,
  test_qn_group_results,
  test_qn_batch_results,
  test_qn_smooth_results,
  test_normalize_ref_uid_2,
  test_normalize_ref_uid_2_mul_mean,
  test_normalize_ref_uid_2_mul_med,
  test_normalize_ref_name_adp,
  test_impute_mean,
  test_impute_min,
  test_impute_median,
  test_collapse_mean,
  test_collapse_mean_batches,
  test_collapse_mean_batches_results,
  test_collapse_median,
  test_collapse_median_batches_results,
  test_collapse_min,
  test_collapse_min_batches_results,
  test_collapse_max,
  test_collapse_max_batches_results,
  test_plot_volcano_input,
  test_plot_volcano_results,
  test_plot_volcano_results_log2_before,
  test_scale_input,
  test_scale_center_results,
  test_scale_auto_results,
  test_scale_range_results,
  test_scale_pareto_results,
  test_scale_vast_u_results,
  test_scale_vast_s_results,
  test_scale_level_results,
  overwrite = TRUE, internal = TRUE
)
