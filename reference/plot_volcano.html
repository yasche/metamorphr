<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano • metamorphr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano"><meta name="description" content="Performs necessary calculations (i.e., calculate p-values and log2-fold changes) and creates a basic Volcano Plot.
The plot is drawn with ggplot2 and can therefore be easily manipulated afterwards (e.g., changing the theme or the axis labels).
Please note that the function is intended to be easy to use and beginner friendly and therefore offers limited ability to fine-tune certain parameters of the resulting plot.
If you wish to draw the plot yourself, you can set return_tbl = TRUE. In this case, a tibble is returned instead of a ggplot2 object which you can use to create a plot yourself.
A Volcano Plot is used to compare two groups. Therefore grouping information must be provided. See join_metadata for more information."><meta property="og:description" content="Performs necessary calculations (i.e., calculate p-values and log2-fold changes) and creates a basic Volcano Plot.
The plot is drawn with ggplot2 and can therefore be easily manipulated afterwards (e.g., changing the theme or the axis labels).
Please note that the function is intended to be easy to use and beginner friendly and therefore offers limited ability to fine-tune certain parameters of the resulting plot.
If you wish to draw the plot yourself, you can set return_tbl = TRUE. In this case, a tibble is returned instead of a ggplot2 object which you can use to create a plot yourself.
A Volcano Plot is used to compare two groups. Therefore grouping information must be provided. See join_metadata for more information."><meta property="og:image" content="https://yasche.github.io/metamorphr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metamorphr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/metamorphr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conjugate-screening.html">Conjugate Screening</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yasche/metamorphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Draws a Volcano Plot or performs calculations necessary to draw one manually</h1>
      <small class="dont-index">Source: <a href="https://github.com/yasche/metamorphr/blob/master/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
      <div class="d-none name"><code>plot_volcano.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs necessary calculations (i.e., calculate <em>p</em>-values and log2-fold changes) and creates a basic <a href="https://en.wikipedia.org/wiki/Volcano_plot_(statistics)" class="external-link">Volcano Plot</a>.
The plot is drawn with <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a> and can therefore be easily manipulated afterwards (e.g., changing the theme or the axis labels).
Please note that the function is intended to be easy to use and beginner friendly and therefore offers limited ability to fine-tune certain parameters of the resulting plot.
If you wish to draw the plot yourself, you can set <code>return_tbl = TRUE</code>. In this case, a tibble is returned instead of a ggplot2 object which you can use to create a plot yourself.
A Volcano Plot is used to compare two groups. Therefore grouping information must be provided. See <code><a href="join_metadata.html">join_metadata</a></code> for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_volcano</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_column</span>,</span>
<span>  <span class="va">name_column</span>,</span>
<span>  <span class="va">groups_to_compare</span>,</span>
<span>  batch_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log2fc_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p_value_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sig_up <span class="op">=</span> <span class="st">"darkred"</span>, sig_down <span class="op">=</span> <span class="st">"darkblue"</span>, not_sig_up <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    not_sig_down <span class="op">=</span> <span class="st">"grey"</span>, not_sig <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,</span>
<span>  adjust_p <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log2_before <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_tbl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tidy tibble created by <code><a href="read_featuretable.html">read_featuretable</a></code>.</p></dd>


<dt id="arg-group-column">group_column<a class="anchor" aria-label="anchor" href="#arg-group-column"></a></dt>
<dd><p>Which column should be used for grouping? Usually <code>group_column = Group</code>. Uses <code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">args_data_masking</a></code>.</p></dd>


<dt id="arg-name-column">name_column<a class="anchor" aria-label="anchor" href="#arg-name-column"></a></dt>
<dd><p>Which column contains the feature names? Can for example be <code>name_column = UID</code> or <code>name_column = Feature</code>. Uses <code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">args_data_masking</a></code>.</p></dd>


<dt id="arg-groups-to-compare">groups_to_compare<a class="anchor" aria-label="anchor" href="#arg-groups-to-compare"></a></dt>
<dd><p>Names of the groups which should be compared as a character vector. Those are the group names in the <code>group_column</code>. They are usually provided in the form of a metadata tibble and joined via <code><a href="join_metadata.html">join_metadata</a></code>.</p></dd>


<dt id="arg-batch-column">batch_column<a class="anchor" aria-label="anchor" href="#arg-batch-column"></a></dt>
<dd><p>Which column contains the batch information? Usually <code>grouping_column = Batch</code>. Only relevant if <code>data</code> contains multiple batches. For example, if <code>data</code> contains 2 batches and each batch contains measurements of separate controls, <code>group_column</code> and <code>batch</code> arguments should be provided. Otherwise controls of both batches will be considered when calculating the <em>p</em>-value and log2 fold change. Uses <code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">args_data_masking</a></code>.</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>The names of the batch(es) that should be included when calculating <em>p</em>-value and log2 fold change.</p></dd>


<dt id="arg-log-fc-cutoff">log2fc_cutoff<a class="anchor" aria-label="anchor" href="#arg-log-fc-cutoff"></a></dt>
<dd><p>A numeric. What cutoff should be used for the log2 fold change? Traditionally, this is set to <code>1</code> which corresponds to a doubling or halving of intensity or area compared to a control. This is only important for assignment to groups and colors defined in the <code>colors</code> argument.</p></dd>


<dt id="arg-p-value-cutoff">p_value_cutoff<a class="anchor" aria-label="anchor" href="#arg-p-value-cutoff"></a></dt>
<dd><p>A numeric. What cutoff should be used for the <em>p</em>-value? Traditionally, this is set to <code>0.05</code>. This is only important for assignment to groups and colors defined in the <code>colors</code> argument. Note that this is not the -log10 transformed value.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>A named list for coloring the dots in the Volcano Plot or <code>NULL</code> in case the points should not be colored. The list must contain colors for the following groups: <code>sig_up</code>, <code>sig_down</code>, <code>not_sig_up</code>, <code>not_sig_down</code> and <code>not_sig</code>.</p></dd>


<dt id="arg-adjust-p">adjust_p<a class="anchor" aria-label="anchor" href="#arg-adjust-p"></a></dt>
<dd><p>Should the <em>p</em>-value be adjusted? Can be either <code>FALSE</code>, (the default) in case no adjustment should be made or any or the name from <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust.methods</a></code> (e.g., <code>adjust_p = "fdr"</code>).</p></dd>


<dt id="arg-log-before">log2_before<a class="anchor" aria-label="anchor" href="#arg-log-before"></a></dt>
<dd><p>A logical. Should the data be log2 transformed prior to calculating the <em>p</em>-values?</p></dd>


<dt id="arg-return-tbl">return_tbl<a class="anchor" aria-label="anchor" href="#arg-return-tbl"></a></dt>
<dd><p>A logical. If <code>FALSE</code>, returns a ggplot2 object, if <code>TRUE</code> returns a tibble which can be used to draw the plot manually to have more control.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>. If none are provided (the default), a Welch Two Sample <em>t</em>-test will be performed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Either a Volcano Plot in the form of a ggplot2 object or a tibble.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># returns a Volcano Plot in the form of a ggplot2 object</span></span></span>
<span class="r-in"><span><span class="va">toy_metaboscape</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="impute_lod.html">impute_lod</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="join_metadata.html">join_metadata</a></span><span class="op">(</span><span class="va">toy_metaboscape_metadata</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">plot_volcano</span><span class="op">(</span></span></span>
<span class="r-in"><span>    group_column <span class="op">=</span> <span class="va">Group</span>,</span></span>
<span class="r-in"><span>    name_column <span class="op">=</span> <span class="va">Feature</span>,</span></span>
<span class="r-in"><span>    groups_to_compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_volcano-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returns a tibble to draw the plot manually</span></span></span>
<span class="r-in"><span><span class="va">toy_metaboscape</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="impute_lod.html">impute_lod</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="join_metadata.html">join_metadata</a></span><span class="op">(</span><span class="va">toy_metaboscape_metadata</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">plot_volcano</span><span class="op">(</span></span></span>
<span class="r-in"><span>    group_column <span class="op">=</span> <span class="va">Group</span>,</span></span>
<span class="r-in"><span>    name_column <span class="op">=</span> <span class="va">Feature</span>,</span></span>
<span class="r-in"><span>    groups_to_compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    return_tbl <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UID Feature                log2fc    p_val n_log_p_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 161.10519 Da 26.98 s    0.678 0.494          0.306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     2 276.13647 Da 27.28 s   -<span style="color: #BB0000;">0.637</span> 0.200          0.699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     3 304.24023 Da 32.86 s    2.85  0.000<span style="text-decoration: underline;">981</span>       3.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     4 417.23236 Da 60.08 s   -<span style="color: #BB0000;">0.784</span> 0.384          0.416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     5 104.10753 Da 170.31 s   0.553 0.182          0.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     6 105.04259 Da 199.80 s   0.421 0.620          0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     7 237.09204 Da 313.24 s   2.57  0.009<span style="text-decoration: underline;">12</span>        2.04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     8 745.09111 Da 382.23 s  -<span style="color: #BB0000;">0.282</span> 0.691          0.161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     9 427.02942 Da 424.84 s   1.06  0.001<span style="text-decoration: underline;">06</span>        2.98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    10 1284.34904 Da 498.94 s -<span style="color: #BB0000;">1.05</span>  0.590          0.229</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yannik Schermer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

