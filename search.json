[{"path":"https://yasche.github.io/metamorphr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 metamorphr authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Conjugate Screening","text":"Glutathion (GSH) conjugates xenobiotics usually result characteristic MS/MS fragments neutral losses (Brink et al., 2014). vignette shows two approaches, one relying MS/MS fragments one relying neutral losses, screen metabolomics data set associated MS/MS spectra GSH conjugates. want learn drug metabolism can visit Wikipedia page (https://en.wikipedia.org/wiki/Drug_metabolism). data set obtained treating HepG2 cells redox cycler menadione measuring samples ESI positive mode.","code":""},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"prepare-the-data-set","dir":"Articles","previous_headings":"","what":"Prepare the data set","title":"Conjugate Screening","text":"vignette uses data separate GitHub repository. information data can found . First, featuretable, sample metadata, MS/MS spectra imported joined together. metamorphr package provides several convenience functions help tasks. read sample metadata form .csv file, readr::read_csv can used. files imported successfully, can joined together. First sample metadata joined using convenience function join_metadata. MS/MS spectra can simply added via dplyr::left_join.","code":"menadione_ft <- read_featuretable(   \"https://github.com/yasche/metamorphr-data/raw/refs/heads/main/RP18/pos/MetaboScape/menadione/menadione.csv\",    label_col = 3,    metadata_cols = 1:15)  menadione_metadata <- readr::read_csv(   \"https://github.com/yasche/metamorphr-data/raw/refs/heads/main/RP18/pos/MetaboScape/menadione/menadione_metadata.csv\",    show_col_types = FALSE)  menadione_msn <- read_mgf(\"https://github.com/yasche/metamorphr-data/raw/refs/heads/main/RP18/pos/MetaboScape/menadione/menadione.gnps.mgf\",                           show_progress = F) menadione_ft <- menadione_ft %>%   join_metadata(menadione_metadata) %>%   dplyr::left_join(menadione_msn, by = \"FEATURE_ID\")  head(menadione_ft) #> # A tibble: 6 × 30 #>     UID Feature    Sample           Intensity FEATURE_ID    RT   CCS SIGMA_SCORE #>   <int> <chr>      <chr>                <dbl>      <dbl> <dbl> <dbl>       <dbl> #> 1     1 186.015    QC_1_07-Aug-24_…      745.          1  13.6  133.        NA   #> 2     2 837.83232  QC_1_07-Aug-24_…     1256.          2  24.2  152.        NA   #> 3     3 769.84306  QC_1_07-Aug-24_…     3594.          3  24.6  223.        NA   #> 4     4 1403.71268 QC_1_07-Aug-24_…       NA           4  24.7  341.        NA   #> 5     5 1539.68908 QC_1_07-Aug-24_…       NA           5  25    354.        NA   #> 6     6 244.22612  QC_1_07-Aug-24_…    25572.          6  25.9  157.        12.9 #> # ℹ 22 more variables: NAME_METABOSCAPE <chr>, MOLECULAR_FORMULA <chr>, #> #   ADDUCT <chr>, KEGG <chr>, CAS <chr>, MaxIntensity <dbl>, #> #   Condition_QC_MeanIntensity <dbl>, Condition_BLANK_MeanIntensity <dbl>, #> #   Condition_Control_MeanIntensity <dbl>, #> #   Condition_Treatment_MeanIntensity <dbl>, Group <chr>, Replicate <dbl>, #> #   Batch <dbl>, Factor <dbl>, SCANS <dbl>, PEPMASS <dbl>, MSLEVEL <dbl>, #> #   CHARGE <chr>, POLARITY <chr>, RTINMINUTES <dbl>, ION <chr>, MSn <list>"},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"find-potential-glutathion-conjugates","dir":"Articles","previous_headings":"","what":"Find potential glutathion conjugates","title":"Conjugate Screening","text":"find potential GSH conjugates, two approaches can used: () search specific MS/MS spectra (ii) search specific neutral losses. Functions approaches implemented metamorphr package shown . Results can easily visualized using ‘ggplot2’ package. Characteristic fragments neutral losses described Brink et al., 2014.","code":""},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"some-initial-filtering","dir":"Articles","previous_headings":"Find potential glutathion conjugates","what":"Some initial filtering","title":"Conjugate Screening","text":"reduce search space remove potential false-positives, initial filtering can done using one several filter functions provided metamorphr package. First, QC samples removed using dplyr::filter needed analysis. scenario, interested features solely present treated samples, filter_blank can used prior searching specific fragments neutral losses. Additionally, interested features found reproducibly across samples, also use filter_grouped_mv. Finally, blank samples removed, using dplyr::filter.","code":"menadione_ft <- menadione_ft %>%   dplyr::filter(Group != \"QC\") %>%   filter_grouped_mv(min_found = 0.75)  %>%   filter_blank(blank_samples = c(\"blank\", \"control\"),                blank_as_group = T,                group_column = Group,                min_frac = 3) %>%   dplyr::filter(Group != \"blank\")"},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"characteristic-msms-fragments","dir":"Articles","previous_headings":"Find potential glutathion conjugates","what":"Characteristic MS/MS fragments","title":"Conjugate Screening","text":"Searching characteristic MS/MS fragments can done using filter_msn function.  Searching characteristic MS/MS fragments yields one potential GSH conjugate: feature exact mass 511.12575 Da.","code":"fragments <- c(308.0911,                179.0485,                177.0328,                162.0219,                130.0499)  menadione_ft %>%   filter_msn(fragments = fragments,               min_found = 2,               tolerance = 5,               tolerance_type = \"ppm\",               show_progress = F) %>%   ggplot2::ggplot(ggplot2::aes(Group, Intensity)) +     ggplot2::geom_point(position = \"jitter\") +     ggplot2::facet_wrap(~ Feature) +     ggplot2::ylim(c(0, NA)) #> Warning: Removed 12 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"characteristic-neutral-losses","dir":"Articles","previous_headings":"Find potential glutathion conjugates","what":"Characteristic neutral losses","title":"Conjugate Screening","text":"Prior searching specific neutral losses via filter_neutral_loss function, neutral loss spectra must calculated using calc_neutral_loss. usage functions shown .  approach yields two potential GSH conjugates: One exact mass 477.12018 one exact mass 511.12575 also found using MS/MS fragments-based approach . Interestingly, menadione reported form GSH conjugate, thiodione, calculated exact mass 477.12058 Da (Mauzeroll et al., 2004). difference measured exact mass one potential conjugate calculated mass just 0.0004 Da 0.86 ppm.","code":"losses <- c(75.0320,             129.0426,             232.0696,             146.0692,             249.0961,             273.0961,             275.1117,             305.0682,             307.0838)  menadione_ft %>%   calc_neutral_loss(m_z_col = PEPMASS) %>%   filter_neutral_loss(losses = losses,                        min_found = 4,                        tolerance = 10,                        tolerance_type = \"ppm\",                       show_progress = F) %>%   ggplot2::ggplot(ggplot2::aes(Group, Intensity)) +     ggplot2::geom_point(position = \"jitter\") +     ggplot2::facet_wrap(~ Feature) +     ggplot2::ylim(c(0, NA)) #> Warning: Removed 24 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":"https://yasche.github.io/metamorphr/articles/conjugate-screening.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Conjugate Screening","text":"Brink, ., Fontaine, F., Marschmann, M., Steinhuber, B., Cece, E. N., Zamora, ., & Pähler, . (2014). Post-acquisition analysis untargeted accurate mass quadrupole time--flight MS E data multiple collision-induced neutral losses fragment ions glutathione conjugates: Neutral losses fragment ion analysis glutathione conjugates. Rapid Communications Mass Spectrometry, 28(24), 2695–2703. DOI 10.1002/rcm.7062 Mauzeroll, J., Bard, . J., Owhadian, O., & Monks, T. J. (2004). Menadione metabolism thiodione hepatoblastoma scanning electrochemical microscopy. Proceedings National Academy Sciences, 101(51), 17582–17587. DOI 10.1073/pnas.0407613101","code":""},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"metamorphr","text":"Metabolomics data preparation usually involves several steps: Feature tables filtered contain ‘significant’ features, missing values imputed, intensities normalized, , depending downstream analysis, data might also scaled transformed. metamorphr package developed make steps streamlined easier perform. example workflow shown . goal workflow create volcano plot compares cells treated HMG-CoA reductase inhibitor mevastatin cells treated vehicle control.","code":""},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"the-whole-workflow","dir":"Articles","previous_headings":"","what":"The whole workflow","title":"metamorphr","text":"quick reference, workflow shown whole . individual steps explained detail . metamorphr package developed used pipe operator vignette makes extensive use . Make sure familiar concept pipe reading . Also, vignette uses magrittr pipe instead native pipe make compatible older versions R. able use native pipe drop-replacement magrittr pipe, wish.","code":"mevastatin_ft <- read_featuretable(   \"https://raw.githubusercontent.com/yasche/metamorphr-data/main/RP18/pos/MetaboScape/mevastatin/mevastatin.csv\",    label_col = 3,    metadata_cols = 1:15)  mevastatin_metadata <- readr::read_csv(   \"https://raw.githubusercontent.com/yasche/metamorphr-data/main/RP18/pos/MetaboScape/mevastatin/mevastatin_metadata.csv\",    show_col_types = FALSE)  mevastatin_ft %>%   join_metadata(mevastatin_metadata) %>%   filter_grouped_mv(min_found = 0.75,                     group_column = Group) %>%   filter_blank(blank_samples = \"blank\",                 blank_as_group = T,                group_column = Group) %>%   filter_cv(reference_samples = \"QC\",             ref_as_group = T,             group_column = Group) %>%   dplyr::filter(Group != \"blank\") %>%   impute_knn() %>%    normalize_quantile_smooth() %>%   collapse_mean(sample_metadata_cols = \"Group\",                 feature_metadata_cols = \"Feature\") %>%   plot_volcano(group_column = Group,                name_column = Feature,                 groups_to_compare = c(\"control\", \"mevastatin\")) +     ggplot2::geom_hline(yintercept = -log10(0.05),                         color = \"grey40\",                         linetype = 2) +     ggplot2::geom_vline(xintercept = c(- 1, 1),                         color = \"grey40\",                         linetype = 2) +     ggplot2::theme_bw()"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"read-the-required-files","dir":"Articles","previous_headings":"","what":"Read the required files","title":"metamorphr","text":"vignette uses data separate GitHub repository. information data can found .","code":""},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"read-the-feature-table","dir":"Articles","previous_headings":"Read the required files","what":"Read the feature table","title":"metamorphr","text":"first step workflow read feature table. metamorphr package contains convenience function, read_featuretable, reads files containing delimiter separated values, example files csv format, performs several initial tidying steps bring correct format. read_featuretable can read files disk also literal data data internet. use latter download data GitHub repository. label_col argument, specify values column 3 mevastatin.csv used feature labels (case exact mass). values stored column named Feature. , metadata_cols argument specify columns 1 15 contain feature metadata, example retention time collision cross section (CCS). preserved important tell read_featuretable columns contain metadata parsing initial tidying work expected. addition Feature column preserved metadata columns, several columns created automatically read_featuretable: UID: column containing unique identifier feature Sample: column containing sample names Intensity: measured intensity (area) specific Sample Feature combination.","code":"mevastatin_ft <- read_featuretable(   \"https://raw.githubusercontent.com/yasche/metamorphr-data/main/RP18/pos/MetaboScape/mevastatin/mevastatin.csv\",    label_col = 3,    metadata_cols = 1:15) head(mevastatin_ft) #> # A tibble: 6 × 18 #>     UID Feature    Sample           Intensity FEATURE_ID    RT   CCS SIGMA_SCORE #>   <int> <chr>      <chr>                <dbl>      <dbl> <dbl> <dbl>       <dbl> #> 1     1 186.015    QC_1_07-Aug-24_…      745.          1  13.6  133.          NA #> 2     2 837.83232  QC_1_07-Aug-24_…     1256.          2  24.5  152.          NA #> 3     3 1403.71298 QC_1_07-Aug-24_…       NA           3  24.7  341.          NA #> 4     4 769.84309  QC_1_07-Aug-24_…     3594.          4  24.8  222.          NA #> 5     5 1539.68908 QC_1_07-Aug-24_…       NA           5  24.9  354.          NA #> 6     6 218.07551  QC_1_07-Aug-24_…       NA           6  26.0  151.          NA #> # ℹ 10 more variables: NAME_METABOSCAPE <chr>, MOLECULAR_FORMULA <chr>, #> #   ADDUCT <chr>, KEGG <chr>, CAS <chr>, MaxIntensity <dbl>, #> #   Condition_QC_MeanIntensity <dbl>, Condition_BLANK_MeanIntensity <dbl>, #> #   Condition_Control_MeanIntensity <dbl>, #> #   Condition_Treatment_MeanIntensity <dbl>"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"read-the-sample-metadata","dir":"Articles","previous_headings":"Read the required files","what":"Read the sample metadata","title":"metamorphr","text":"Sample metadata, example group information replicate number, required functions. empty metadata table required columns rows can created existing feature table via create_metadata_skeleton exported edited hand, example Microsoft Excel. editing, file can read back R using readr::read_csv. case, already file containing relevant metadata GitHub repository. metadata table must include following columns: Sample: Contains sample names. Group: Contains group information. Replicate: Replicate information. multiple replicates sample exist (e.g., sample injected multiple times) must replicate number. Batch: Samples belonging batch must batch number. Factor: sample specific factor, example protein concentration dry weight. necessary specific normalization strategies.","code":"mevastatin_ft %>%   create_metadata_skeleton() %>%   readr::write_csv(file = \"some/path/menadione_metadata.csv\")  mevastatin_metadata <- readr::read_csv(\"some/path/menadione_metadata.csv\") mevastatin_metadata <- readr::read_csv(   \"https://raw.githubusercontent.com/yasche/metamorphr-data/main/RP18/pos/MetaboScape/mevastatin/mevastatin_metadata.csv\",    show_col_types = FALSE) head(mevastatin_metadata) #> # A tibble: 6 × 5 #>   Sample                    Group      Replicate Batch Factor #>   <chr>                     <chr>          <dbl> <dbl>  <dbl> #> 1 B9_Comp_1_08-Aug-24_10235 mevastatin         1     1      1 #> 2 B9_Comp_1_10-Aug-24_10378 mevastatin         1     1      1 #> 3 B9_Comp_1_11-Aug-24_10517 mevastatin         1     1      1 #> 4 B9_Comp_2_08-Aug-24_10236 mevastatin         2     1      1 #> 5 B9_Comp_2_10-Aug-24_10379 mevastatin         2     1      1 #> 6 B9_Comp_2_12-Aug-24_10522 mevastatin         2     1      1"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"join-them-together","dir":"Articles","previous_headings":"Read the required files","what":"Join them together","title":"metamorphr","text":"metamorphr provides convenience function, join_metadata, joining together feature table associated metadata.","code":"mevastatin_ft <- join_metadata(mevastatin_ft, mevastatin_metadata)"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"filter","dir":"Articles","previous_headings":"","what":"Filter","title":"metamorphr","text":"workflow, filter functions used improve overall data quality. R console, can type metamorphr::filter_ see available filter functions. dplyr::filter used remove blank samples afterwards. workflow, 3 filter functions used sequentially: filter_grouped_mv: keep features low rate missing values. default parameters, features kept found least 75 % samples least 1 group. filter_blank: remove features found high intensity blank samples. default parameters, features kept maximum intensity non-blank samples least 3 times high blank samples. filter_cv: remove features poor reproducibility (.e., high coefficient variation, CV) quality control samples. default parameters, features maximum CV 0.2 kept.","code":"mevastatin_ft <- mevastatin_ft %>%   filter_grouped_mv(min_found = 0.75,                     group_column = Group) %>%   filter_blank(blank_samples = \"blank\",                 blank_as_group = T,                group_column = Group) %>%   filter_cv(reference_samples = \"QC\",             ref_as_group = T,             group_column = Group) %>%   dplyr::filter(Group != \"blank\")"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"imputate-missing-values","dir":"Articles","previous_headings":"","what":"Imputate missing values","title":"metamorphr","text":"data contains missing values (.e., NA). imputed prior creating volcano plot. example, k-nearest neighbors algorithm used imputation metamorphr package provides options well. Start typing metamorphr::impute_ R console see available options. underlying design metamorphr package makes easy visualize data using ‘ggplot2’. , simple visualization used verify imputation worked expected.  expected, missing values imputation.","code":"mevastatin_ft_before_impute <- mevastatin_ft %>%   dplyr::mutate(State = \"Before imputation\")    mevastatin_ft <- impute_knn(mevastatin_ft) mevastatin_ft %>%   dplyr::mutate(State = \"After imputation\") %>%   dplyr::bind_rows(mevastatin_ft_before_impute) %>%   dplyr::mutate(State = factor(State,                                 levels = c(\"Before imputation\",                                            \"After imputation\"))) %>%   dplyr::group_by(State, Sample, Group) %>%   dplyr::count(wt = is.na(Intensity)) %>%   ggplot2::ggplot(ggplot2::aes(Sample, n, color = Group)) +     ggplot2::geom_point() +     ggplot2::facet_wrap(~State, nrow = 2) +     ggplot2::ylab(\"Number of missing values\") +     ggplot2::theme_bw() +     ggplot2::theme(axis.text.x = ggplot2::element_blank(),                    legend.position = \"bottom\")"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"normalize","dir":"Articles","previous_headings":"","what":"Normalize","title":"metamorphr","text":"Next, intensities normalized across samples. example, smooth quantile normalization used (Hicks et al., 2018). algorithm requires sample metadata, specifically, grouping information. available options can viewed typing metamorphr::normalize_ R console. , can use ‘ggplot2’ visualization verification.  normalization worked expected. distributions intensities inside group identical.","code":"mevastatin_ft_before_norm <- mevastatin_ft %>%   dplyr::mutate(State = \"Before normalization\")  mevastatin_ft <- normalize_quantile_smooth(mevastatin_ft) mevastatin_ft %>%   dplyr::mutate(State = \"After normalization\") %>%   dplyr::bind_rows(mevastatin_ft_before_norm) %>%   dplyr::mutate(State = factor(State,                                 levels = c(\"Before normalization\",                                            \"After normalization\"))) %>%   ggplot2::ggplot(ggplot2::aes(Sample, log10(Intensity), color = Group)) +     ggplot2::geom_boxplot() +     ggplot2::facet_wrap(~State, nrow = 2) +     ggplot2::ylab(\"log10(Intensity)\") +     ggplot2::theme_bw() +     ggplot2::theme(axis.text.x = ggplot2::element_blank(),                    legend.position = \"bottom\")"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"collapse-technical-replicates","dir":"Articles","previous_headings":"","what":"Collapse technical replicates","title":"metamorphr","text":"example data set, sample injected 3 times. Prior statistics drawing volcano plot, technical replicates collapsed. metamorphr package provides several approaches . Start typing metamorphr::collapse_ R console see available options. workflow, simply calculate mean technical replicates using collapse_mean. important sample metadata provided approach. important Group Replicate information provided well Batch. Technical replicates sample must value Group, Batch Replicate. example, B9_Comp_1... belongs group mevastatin injected 3 times indicated three samples replicate number 1.","code":"mevastatin_metadata #> # A tibble: 73 × 5 #>    Sample                    Group      Replicate Batch Factor #>    <chr>                     <chr>          <dbl> <dbl>  <dbl> #>  1 B9_Comp_1_08-Aug-24_10235 mevastatin         1     1      1 #>  2 B9_Comp_1_10-Aug-24_10378 mevastatin         1     1      1 #>  3 B9_Comp_1_11-Aug-24_10517 mevastatin         1     1      1 #>  4 B9_Comp_2_08-Aug-24_10236 mevastatin         2     1      1 #>  5 B9_Comp_2_10-Aug-24_10379 mevastatin         2     1      1 #>  6 B9_Comp_2_12-Aug-24_10522 mevastatin         2     1      1 #>  7 B9_Comp_3_08-Aug-24_10237 mevastatin         3     1      1 #>  8 B9_Comp_3_10-Aug-24_10380 mevastatin         3     1      1 #>  9 B9_Comp_3_12-Aug-24_10523 mevastatin         3     1      1 #> 10 B9_Comp_4_08-Aug-24_10238 mevastatin         4     1      1 #> # ℹ 63 more rows mevastatin_ft <- collapse_mean(mevastatin_ft,                                sample_metadata_cols = \"Group\",                                feature_metadata_cols = \"Feature\")"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"plot","dir":"Articles","previous_headings":"","what":"Plot","title":"metamorphr","text":"Finally, data can plotted plot_volcano. resulting plot can easily modified ‘ggplot2’ functions.","code":"plot_volcano(mevastatin_ft,              group_column = Group,              name_column = Feature,               groups_to_compare = c(\"control\", \"mevastatin\")) +   ggplot2::geom_hline(yintercept = -log10(0.05),                       color = \"grey40\",                       linetype = 2) +   ggplot2::geom_vline(xintercept = c(- 1, 1),                       color = \"grey40\",                       linetype = 2) +   ggplot2::theme_bw()"},{"path":"https://yasche.github.io/metamorphr/articles/metamorphr.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"metamorphr","text":"Hicks, S. C., Okrah, K., Paulson, J. N., Quackenbush, J., Irizarry, R. ., & Bravo, H. C. (2018). Smooth quantile normalization. Biostatistics, 19(2), 185–198. DOI 10.1093/biostatistics/kxx028","code":""},{"path":"https://yasche.github.io/metamorphr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yannik Schermer. Author, maintainer, copyright holder.","code":""},{"path":"https://yasche.github.io/metamorphr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Schermer Y (2025). metamorphr: Tidy Streamlined Metabolomics Data Workflows. R package version 0.2.0.9000, https://github.com/yasche/metamorphr.","code":"@Manual{,   title = {metamorphr: Tidy and Streamlined Metabolomics Data Workflows},   author = {Yannik Schermer},   year = {2025},   note = {R package version 0.2.0.9000},   url = {https://github.com/yasche/metamorphr}, }"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/index.html","id":"id_-overview","dir":"","previous_headings":"","what":"💡 Overview","title":"Tidy and Streamlined Metabolomics Data Workflows","text":"metamorphr package intended make working metabolomics data fun. , metamorphr introduces tidy data format stores metabolomics data associated metadata, well MS/MS spectra one tibble includes set functions facilitate tasks typically encountered metabolomics data analysis. approach allows easy integration Tidyverse packages, including ggplot2 dplyr.","code":""},{"path":"https://yasche.github.io/metamorphr/index.html","id":"id_-installation","dir":"","previous_headings":"","what":"💾 Installation","title":"Tidy and Streamlined Metabolomics Data Workflows","text":"Install stable version CRAN : Alternatively, can install development version metamorphr GitHub :","code":"install.packages(\"metamorphr\") # install.packages(\"pak\") pak::pak(\"yasche/metamorphr\")"},{"path":"https://yasche.github.io/metamorphr/index.html","id":"id_️-functions","dir":"","previous_headings":"","what":"⚙️ Functions","title":"Tidy and Streamlined Metabolomics Data Workflows","text":"overview currently implemented functions.","code":""},{"path":[]},{"path":"https://yasche.github.io/metamorphr/index.html","id":"id_-create-your-analysis-workflows-in-no-time","dir":"","previous_headings":"📑 Examples","what":"✨ Create your analysis workflows in no time","title":"Tidy and Streamlined Metabolomics Data Workflows","text":"","code":"library(metamorphr) library(ggplot2)  toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   filter_blank(blank_samples = \"blank\",                blank_as_group = T,                group_column = Group) %>%   filter_grouped_mv(min_found = 0.75) %>%   impute_lod() %>%   normalize_pqn() %>%   scale_auto() %>%   plot_pca(group_column = Group) +     ggplot2::theme_bw()"},{"path":"https://yasche.github.io/metamorphr/index.html","id":"id_-seamlessly-work-with-your-data-sets-with-dplyr-and-ggplot2","dir":"","previous_headings":"📑 Examples","what":"📊 Seamlessly work with your data sets with dplyr and ggplot2","title":"Tidy and Streamlined Metabolomics Data Workflows","text":"Easily plot distribution intensities across samples  … compare intensity specific features across groups","code":"library(dplyr)  toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   ggplot2::ggplot(ggplot2::aes(Sample, Intensity, color = Group)) +     ggplot2::geom_boxplot() +     ggplot2::theme_bw() toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   dplyr::filter(Name %in% c(\"Arachidonic acid\", \"ADP\", \"NADPH\")) %>%   dplyr::filter(Group %in% c(\"control\", \"treatment\")) %>%   ggplot2::ggplot(ggplot2::aes(Group, Intensity, color = Group)) +     ggplot2::geom_boxplot() +     ggplot2::facet_wrap(~Name) +     ggplot2::theme_bw()"},{"path":"https://yasche.github.io/metamorphr/reference/atoms.html","id":null,"dir":"Reference","previous_headings":"","what":"A tibble containing the NIST standard atomic weights — atoms","title":"A tibble containing the NIST standard atomic weights — atoms","text":"data set contains atomic weights elements isotopes. used calculate exact mass formula_to_mass can also used reference. description","code":""},{"path":"https://yasche.github.io/metamorphr/reference/atoms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A tibble containing the NIST standard atomic weights — atoms","text":"","code":"atoms"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/reference/atoms.html","id":"atoms","dir":"Reference","previous_headings":"","what":"atoms","title":"A tibble containing the NIST standard atomic weights — atoms","text":"data frame 442 rows 7 columns: Number atomic number element periodic table. Element element. Isotope mass number specific isotope. Symbol atomic symbol. Either letter (standard isotopes) mass number followed symbol (special isotopes). Weight monoisotopic mass isotope. Composition fraction isotope naturally occuring element. Standard_Weight standard atomic weight element. sum product Weight Composition column element. composition available, weight IUPAC \"ATOMIC WEIGHTS ELEMENTS 2023\" table used. See Source section information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/atoms.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A tibble containing the NIST standard atomic weights — atoms","text":"table retrieved National Institute Standards Technology (NIST) https://physics.nist.gov/cgi-bin/Compositions/stand_alone.pl, accesed October 2025, enriched data IUPAC \"ATOMIC WEIGHTS ELEMENTS 2023\" table https://iupac.qmul.ac.uk/AtWt/, accesed October 2025","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Kendrick mass — calc_km","title":"Calculate the Kendrick mass — calc_km","text":"Calculate Kendrick mass given mass (m/z) repeating unit. Kendrick mass rescaled mass, usually sets CH2 = 14 repeating units can also used. usefull visual identification potential homologues. See References section information. Kendrick mass confused Kendrick mass defect (KMD, calc_kmd) nominal Kendrick mass (calc_nominal_km).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Kendrick mass — calc_km","text":"","code":"calc_km(mass, repeating_unit = \"CH2\")"},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Kendrick mass — calc_km","text":"mass molecular mass (m/z). repeating_unit formula repeating unit, given string.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Kendrick mass — calc_km","text":"Kendrick mass.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate the Kendrick mass — calc_km","text":"Kendrick mass Wikipedia Edward Kendrick, Anal. Chem. 1963, 35, 2146–2154. C. . Hughey, C. L. Hendrickson, R. P. Rodgers, . G. Marshall, K. Qian, Anal. Chem. 2001, 73, 4676–4681.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_km.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Kendrick mass — calc_km","text":"","code":"# Calculate the Kendrick masses for two measured masses with # CH2 as the repeating unit. # See Hughey et al. in the References section above  calc_km(c(351.3269, 365.3425)) #> [1] 350.9346 364.9346  # Construct a KMD plot from m/z values. # RT is mapped to color and the feature-wise maximum intensity to size. # Note that in the publication by Hughey et al., the nominal Kendrick mass # is used on the x-axis instead of the exact Kendrick mass. # See ?calc_nominal_km.  toy_metaboscape %>%   dplyr::group_by(UID, `m/z`, RT) %>%   dplyr::summarise(max_int = max(Intensity, na.rm = TRUE)) %>%   dplyr::ungroup() %>%   dplyr::mutate(KMD = calc_kmd(`m/z`),                 KM = calc_km(`m/z`)) %>%   ggplot2::ggplot(ggplot2::aes(x = KM,                                y = KMD,                                size = max_int,                                color = RT)) +     ggplot2::geom_point() #> `summarise()` has grouped output by 'UID', 'm/z'. You can override using the #> `.groups` argument."},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Kendrick mass defect (KMD) — calc_kmd","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"Kendrick mass defect (KMD) calculated subtracting Kendrick mass (calc_km) nominal Kendrick mass (calc_nominal_km). References section information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"","code":"calc_kmd(mass, repeating_unit = \"CH2\")"},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"mass molecular mass (m/z). repeating_unit formula repeating unit, given string.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"Kendrick mass defect (KMD)","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"Kendrick mass Wikipedia Edward Kendrick, Anal. Chem. 1963, 35, 2146–2154. C. . Hughey, C. L. Hendrickson, R. P. Rodgers, . G. Marshall, K. Qian, Anal. Chem. 2001, 73, 4676–4681.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_kmd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Kendrick mass defect (KMD) — calc_kmd","text":"","code":"# Calculate the Kendrick mass defects for two measured masses with # CH2 as the repeating unit. # See Hughey et al. in the References section above  calc_kmd(c(351.3269, 365.3425)) #> [1] 0.06539637 0.06544638  # Construct a KMD plot from m/z values. # RT is mapped to color and the feature-wise maximum intensity to size.  toy_metaboscape %>%   dplyr::group_by(UID, `m/z`, RT) %>%   dplyr::summarise(max_int = max(Intensity, na.rm = TRUE)) %>%   dplyr::ungroup() %>%   dplyr::mutate(KMD = calc_kmd(`m/z`),                 `nominal KM` = calc_nominal_km(`m/z`)) %>%   ggplot2::ggplot(ggplot2::aes(x = `nominal KM`,                                y = KMD,                                size = max_int,                                color = RT)) +     ggplot2::geom_point() #> `summarise()` has grouped output by 'UID', 'm/z'. You can override using the #> `.groups` argument."},{"path":"https://yasche.github.io/metamorphr/reference/calc_neutral_loss.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","title":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","text":"Calculate neutral loss spectra ions available MSn spectra data. calculate neutral losses, MSn spectra required. See read_mgf. step required subsequent filtering based neutral losses (filter_neutral_loss). Resulting neutral loss spectra stored tibbles new list column named Neutral_Loss.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_neutral_loss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","text":"","code":"calc_neutral_loss(data, m_z_col)"},{"path":"https://yasche.github.io/metamorphr/reference/calc_neutral_loss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","text":"data tidy tibble created read_featuretable. m_z_col column holds precursor m/z? Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_neutral_loss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","text":"tibble added neutral loss spectra. new list column created named Neutral_Loss.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_neutral_loss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate neutral losses from precursor ion mass and fragment ion masses — calc_neutral_loss","text":"","code":"toy_mgf %>%   calc_neutral_loss(m_z_col = PEPMASS) #> # A tibble: 3 × 6 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              Neutral_Loss #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           <list>       #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]> <tibble>     #> 2         2.1         2.2           2.3   679.  <tibble [5 × 2]> <tibble>     #> 3         3.1         3.2           3.3  5890.  <tibble [6 × 2]> <tibble>"},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the nominal Kendrick mass — calc_nominal_km","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"nominal Kendrick mass Kendrick mass (calc_km), rounded nearest whole number. nominal Kendrick mass Kendrick mass required calculate Kendrick mass defect (KMD). nominal Kendrick mass confused Kendrick mass defect (calc_kmd) Kendrick mass (calc_km).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"","code":"calc_nominal_km(mass, repeating_unit = \"CH2\")"},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"mass molecular mass (m/z). repeating_unit formula repeating unit, given string.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"nominal Kendrick mass.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"Kendrick mass Wikipedia Edward Kendrick, Anal. Chem. 1963, 35, 2146–2154. C. . Hughey, C. L. Hendrickson, R. P. Rodgers, . G. Marshall, K. Qian, Anal. Chem. 2001, 73, 4676–4681.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/calc_nominal_km.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the nominal Kendrick mass — calc_nominal_km","text":"","code":"# Calculate the nominal Kendrick masses for two measured masses with # CH2 as the repeating unit. # See Hughey et al. in the References section above  calc_nominal_km(c(351.3269, 365.3425)) #> [1] 351 365  # Construct a KMD plot from m/z values. # RT is mapped to color and the feature-wise maximum intensity to size.  toy_metaboscape %>%   dplyr::group_by(UID, `m/z`, RT) %>%   dplyr::summarise(max_int = max(Intensity, na.rm = TRUE)) %>%   dplyr::ungroup() %>%   dplyr::mutate(KMD = calc_kmd(`m/z`),                 `nominal KM` = calc_nominal_km(`m/z`)) %>%   ggplot2::ggplot(ggplot2::aes(x = `nominal KM`,                                y = KMD,                                size = max_int,                                color = RT)) +     ggplot2::geom_point() #> `summarise()` has grouped output by 'UID', 'm/z'. You can override using the #> `.groups` argument."},{"path":"https://yasche.github.io/metamorphr/reference/collapse_max.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","title":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","text":"Calculates minimum intensity technical replicates (e.g., sample injected multiple times multiple workups performed starting material). function assigns new sample names joining either group replicate name, batch column specified group, replicate batch together specified separator. Due nature function, sample feature metadata columns dropped unless specified according arguments.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_max.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","text":"","code":"collapse_max(   data,   group_column = .data$Group,   replicate_column = .data$Replicate,   batch_column = .data$Batch,   feature_metadata_cols = \"Feature\",   sample_metadata_cols = NULL,   separator = \"_\" )"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_max.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. replicate_column column contains replicate information? Usually replicate_column = Replicate. Uses args_data_masking. batch_column column contains batch information? samples belong batch (.e., batch identifier batch_column) effect calculation. Usually batch_column = Batch. Uses args_data_masking. feature_metadata_cols character character vector containing names feature metadata columns. usually created reading feature table read_featuretable. Feature metadata columns specified dropped. sample_metadata_cols character character vector containing names sample metadata columns. usually created joining metadata join_metadata. Sample metadata columns specified dropped, except group_column, replicate_column batch_column specified. separator Separator used joining group replicate, group, batch replicate together create new sample names. new sample names Group name, separator, Batch name, separator, Replicate name, Group name, separator, Replicate name, case samples belong batch (.e., batch identifier batch_column).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_max.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","text":"tibble intensities technical replicates collapsed.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_max.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse intensities of technical replicates by calculating their maximum — collapse_max","text":"","code":"# uses a slightly modified version of toy_metaboscape_metadata collapse_toy_metaboscape_metadata <- toy_metaboscape_metadata collapse_toy_metaboscape_metadata$Replicate <- 1  toy_metaboscape %>%   join_metadata(collapse_toy_metaboscape_metadata) %>%   impute_lod() %>%   collapse_max(group_column = Group, replicate_column = Replicate) #> # A tibble: 40 × 7 #>      UID Feature              Sample      Intensity Group     Replicate Batch #>    <int> <chr>                <chr>           <dbl> <chr>         <dbl> <int> #>  1     1 161.10519 Da 26.98 s QC_1              7   QC                1     1 #>  2     1 161.10519 Da 26.98 s blank_1           0.6 blank             1     1 #>  3     1 161.10519 Da 26.98 s control_1         4   control           1     1 #>  4     1 161.10519 Da 26.98 s treatment_1       9   treatment         1     1 #>  5     2 276.13647 Da 27.28 s QC_1              9   QC                1     1 #>  6     2 276.13647 Da 27.28 s blank_1           9   blank             1     1 #>  7     2 276.13647 Da 27.28 s control_1         6   control           1     1 #>  8     2 276.13647 Da 27.28 s treatment_1       4   treatment         1     1 #>  9     3 304.24023 Da 32.86 s QC_1              6   QC                1     1 #> 10     3 304.24023 Da 32.86 s blank_1           0.2 blank             1     1 #> # ℹ 30 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","title":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","text":"Calculates mean intensity technical replicates (e.g., sample injected multiple times multiple workups performed starting material). function assigns new sample names joining either group replicate name, batch column specified group, replicate batch together specified separator. Due nature function, sample feature metadata columns dropped unless specified according arguments.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","text":"","code":"collapse_mean(   data,   group_column = .data$Group,   replicate_column = .data$Replicate,   batch_column = .data$Batch,   feature_metadata_cols = \"Feature\",   sample_metadata_cols = NULL,   separator = \"_\" )"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. replicate_column column contains replicate information? Usually replicate_column = Replicate. Uses args_data_masking. batch_column column contains batch information? samples belong batch (.e., batch identifier batch_column) effect calculation. Usually batch_column = Batch. Uses args_data_masking. feature_metadata_cols character character vector containing names feature metadata columns. usually created reading feature table read_featuretable. Feature metadata columns specified dropped. sample_metadata_cols character character vector containing names sample metadata columns. usually created joining metadata join_metadata. Sample metadata columns specified dropped, except group_column, replicate_column batch_column specified. separator Separator used joining group replicate, group, batch replicate together create new sample names. new sample names Group name, separator, Batch name, separator, Replicate name, Group name, separator, Replicate name, case samples belong batch (.e., batch identifier batch_column).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","text":"tibble intensities technical replicates collapsed.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_mean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse intensities of technical replicates by calculating their mean — collapse_mean","text":"","code":"# uses a slightly modified version of toy_metaboscape_metadata collapse_toy_metaboscape_metadata <- toy_metaboscape_metadata collapse_toy_metaboscape_metadata$Replicate <- 1  toy_metaboscape %>%   join_metadata(collapse_toy_metaboscape_metadata) %>%   impute_lod() %>%   collapse_mean(group_column = Group, replicate_column = Replicate) #> # A tibble: 40 × 7 #>      UID Feature              Sample      Intensity Group     Replicate Batch #>    <int> <chr>                <chr>           <dbl> <chr>         <dbl> <int> #>  1     1 161.10519 Da 26.98 s QC_1             5.33 QC                1     1 #>  2     1 161.10519 Da 26.98 s blank_1          0.6  blank             1     1 #>  3     1 161.10519 Da 26.98 s control_1        3.67 control           1     1 #>  4     1 161.10519 Da 26.98 s treatment_1      5.87 treatment         1     1 #>  5     2 276.13647 Da 27.28 s QC_1             5.67 QC                1     1 #>  6     2 276.13647 Da 27.28 s blank_1          6.5  blank             1     1 #>  7     2 276.13647 Da 27.28 s control_1        4.67 control           1     1 #>  8     2 276.13647 Da 27.28 s treatment_1      3    treatment         1     1 #>  9     3 304.24023 Da 32.86 s QC_1             5.33 QC                1     1 #> 10     3 304.24023 Da 32.86 s blank_1          0.2  blank             1     1 #> # ℹ 30 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse intensities of technical replicates by calculating their median — collapse_median","title":"Collapse intensities of technical replicates by calculating their median — collapse_median","text":"Calculates median intensity technical replicates (e.g., sample injected multiple times multiple workups performed starting material). function assigns new sample names joining either group replicate name, batch column specified group, replicate batch together specified separator. Due nature function, sample feature metadata columns dropped unless specified according arguments.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse intensities of technical replicates by calculating their median — collapse_median","text":"","code":"collapse_median(   data,   group_column = .data$Group,   replicate_column = .data$Replicate,   batch_column = .data$Batch,   feature_metadata_cols = \"Feature\",   sample_metadata_cols = NULL,   separator = \"_\" )"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse intensities of technical replicates by calculating their median — collapse_median","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. replicate_column column contains replicate information? Usually replicate_column = Replicate. Uses args_data_masking. batch_column column contains batch information? samples belong batch (.e., batch identifier batch_column) effect calculation. Usually batch_column = Batch. Uses args_data_masking. feature_metadata_cols character character vector containing names feature metadata columns. usually created reading feature table read_featuretable. Feature metadata columns specified dropped. sample_metadata_cols character character vector containing names sample metadata columns. usually created joining metadata join_metadata. Sample metadata columns specified dropped, except group_column, replicate_column batch_column specified. separator Separator used joining group replicate, group, batch replicate together create new sample names. new sample names Group name, separator, Batch name, separator, Replicate name, Group name, separator, Replicate name, case samples belong batch (.e., batch identifier batch_column).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse intensities of technical replicates by calculating their median — collapse_median","text":"tibble intensities technical replicates collapsed.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_median.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse intensities of technical replicates by calculating their median — collapse_median","text":"","code":"# uses a slightly modified version of toy_metaboscape_metadata collapse_toy_metaboscape_metadata <- toy_metaboscape_metadata collapse_toy_metaboscape_metadata$Replicate <- 1  toy_metaboscape %>%   join_metadata(collapse_toy_metaboscape_metadata) %>%   impute_lod() %>%   collapse_median(group_column = Group, replicate_column = Replicate) #> # A tibble: 40 × 7 #>      UID Feature              Sample      Intensity Group     Replicate Batch #>    <int> <chr>                <chr>           <dbl> <chr>         <dbl> <int> #>  1     1 161.10519 Da 26.98 s QC_1              6   QC                1     1 #>  2     1 161.10519 Da 26.98 s blank_1           0.6 blank             1     1 #>  3     1 161.10519 Da 26.98 s control_1         4   control           1     1 #>  4     1 161.10519 Da 26.98 s treatment_1       8   treatment         1     1 #>  5     2 276.13647 Da 27.28 s QC_1              6   QC                1     1 #>  6     2 276.13647 Da 27.28 s blank_1           6.5 blank             1     1 #>  7     2 276.13647 Da 27.28 s control_1         5   control           1     1 #>  8     2 276.13647 Da 27.28 s treatment_1       3   treatment         1     1 #>  9     3 304.24023 Da 32.86 s QC_1              5   QC                1     1 #> 10     3 304.24023 Da 32.86 s blank_1           0.2 blank             1     1 #> # ℹ 30 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_min.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","title":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","text":"Calculates minimum intensity technical replicates (e.g., sample injected multiple times multiple workups performed starting material). function assigns new sample names joining either group replicate name, batch column specified group, replicate batch together specified separator. Due nature function, sample feature metadata columns dropped unless specified according arguments.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_min.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","text":"","code":"collapse_min(   data,   group_column = .data$Group,   replicate_column = .data$Replicate,   batch_column = .data$Batch,   feature_metadata_cols = \"Feature\",   sample_metadata_cols = NULL,   separator = \"_\" )"},{"path":"https://yasche.github.io/metamorphr/reference/collapse_min.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. replicate_column column contains replicate information? Usually replicate_column = Replicate. Uses args_data_masking. batch_column column contains batch information? samples belong batch (.e., batch identifier batch_column) effect calculation. Usually batch_column = Batch. Uses args_data_masking. feature_metadata_cols character character vector containing names feature metadata columns. usually created reading feature table read_featuretable. Feature metadata columns specified dropped. sample_metadata_cols character character vector containing names sample metadata columns. usually created joining metadata join_metadata. Sample metadata columns specified dropped, except group_column, replicate_column batch_column specified. separator Separator used joining group replicate, group, batch replicate together create new sample names. new sample names Group name, separator, Batch name, separator, Replicate name, Group name, separator, Replicate name, case samples belong batch (.e., batch identifier batch_column).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_min.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","text":"tibble intensities technical replicates collapsed.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/collapse_min.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse intensities of technical replicates by calculating their minimum — collapse_min","text":"","code":"# uses a slightly modified version of toy_metaboscape_metadata collapse_toy_metaboscape_metadata <- toy_metaboscape_metadata collapse_toy_metaboscape_metadata$Replicate <- 1  toy_metaboscape %>%   join_metadata(collapse_toy_metaboscape_metadata) %>%   impute_lod() %>%   collapse_min(group_column = Group, replicate_column = Replicate) #> # A tibble: 40 × 7 #>      UID Feature              Sample      Intensity Group     Replicate Batch #>    <int> <chr>                <chr>           <dbl> <chr>         <dbl> <int> #>  1     1 161.10519 Da 26.98 s QC_1              3   QC                1     1 #>  2     1 161.10519 Da 26.98 s blank_1           0.6 blank             1     1 #>  3     1 161.10519 Da 26.98 s control_1         3   control           1     1 #>  4     1 161.10519 Da 26.98 s treatment_1       0.6 treatment         1     1 #>  5     2 276.13647 Da 27.28 s QC_1              2   QC                1     1 #>  6     2 276.13647 Da 27.28 s blank_1           4   blank             1     1 #>  7     2 276.13647 Da 27.28 s control_1         3   control           1     1 #>  8     2 276.13647 Da 27.28 s treatment_1       2   treatment         1     1 #>  9     3 304.24023 Da 32.86 s QC_1              5   QC                1     1 #> 10     3 304.24023 Da 32.86 s blank_1           0.2 blank             1     1 #> # ℹ 30 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/create_metadata_skeleton.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a blank metadata skeleton — create_metadata_skeleton","title":"Create a blank metadata skeleton — create_metadata_skeleton","text":"Takes tidy tibble created metamorphr::read_featuretable() returns empty tibble sample metadata. tibble can either populated directly R exported edited hand (e.g. Excel). Metadata necessary several downstream functions. columns may added necessary.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/create_metadata_skeleton.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a blank metadata skeleton — create_metadata_skeleton","text":"","code":"create_metadata_skeleton(data)"},{"path":"https://yasche.github.io/metamorphr/reference/create_metadata_skeleton.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a blank metadata skeleton — create_metadata_skeleton","text":"data tidy tibble created metamorphr::read_featuretable().","code":""},{"path":"https://yasche.github.io/metamorphr/reference/create_metadata_skeleton.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a blank metadata skeleton — create_metadata_skeleton","text":"empty tibble structure necessary columns metadata: Sample sample name Group group samples belong? example treatment background. Note additional columns additional grouping information can freely added necessary. Replicate multiple technical replicates exist data set, must value Replicate value Group can collapsed. Examples technical replicates : sample injected multiple times workup performed multiple times starting material. technical replicates exist, set Replicate = 1 samples. Batch batch samples prepared measured. one batch exists, set Batch = 1 samples. Factor sample-specific factor, example dry weight protein content.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/create_metadata_skeleton.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a blank metadata skeleton — create_metadata_skeleton","text":"","code":"featuretable_path <- system.file(\"extdata\", \"toy_metaboscape.csv\", package = \"metamorphr\") metadata <- read_featuretable(featuretable_path, metadata_cols = 2:5) %>%   create_metadata_skeleton()"},{"path":"https://yasche.github.io/metamorphr/reference/filter_blank.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on their occurrence in blank samples — filter_blank","title":"Filter Features based on their occurrence in blank samples — filter_blank","text":"Filters Features based occurrence blank samples. example, min_frac = 3 maximum intensity samples must least 3 times high blanks Feature filtered .","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_blank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on their occurrence in blank samples — filter_blank","text":"","code":"filter_blank(   data,   blank_samples,   min_frac = 3,   blank_as_group = FALSE,   group_column = NULL )"},{"path":"https://yasche.github.io/metamorphr/reference/filter_blank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on their occurrence in blank samples — filter_blank","text":"data tidy tibble created read_featuretable. blank_samples Defines blanks. blank_as_group = FALSE character vector containing names blank samples Sample column data. blank_as_group = TRUE name(s) group(s) define blanks, Group column data. latter can used sample metadata provided. min_frac numeric defining many times higher maximum intensity samples must relation blanks. blank_as_group logical indicating blank_samples names samples group(s). group_column relevant blank_as_group = TRUE. column used grouping blank non-blank samples? Usually group_column = Group. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_blank.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on their occurrence in blank samples — filter_blank","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_blank.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on their occurrence in blank samples — filter_blank","text":"","code":"# Example 1: Define blanks by sample name toy_metaboscape %>%   filter_blank(blank_samples = c(\"Blank1\", \"Blank2\"), blank_as_group = FALSE, min_frac = 3) #> # A tibble: 77 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1         4  0.45  162. NA         C7H15N… #>  2     3 304.24023 Da 32.86 s   Sample1        NA  0.55  305. Arachidon… C20H32… #>  3     5 104.10753 Da 170.31 s  Sample1         5  2.84  105. NA         C5H14NO #>  4     7 237.09204 Da 313.24 s  Sample1        NA  5.22  238. Ketamine   C13H16… #>  5     8 745.09111 Da 382.23 s  Sample1         3  6.37  746. NADPH      C21H30… #>  6     9 427.02942 Da 424.84 s  Sample1         4  7.08  428. ADP        C10H15… #>  7    10 1284.34904 Da 498.94 s Sample1        NA  8.32 1285. NA         NA      #>  8     1 161.10519 Da 26.98 s   Sample2         3  0.45  162. NA         C7H15N… #>  9     3 304.24023 Da 32.86 s   Sample2         2  0.55  305. Arachidon… C20H32… #> 10     5 104.10753 Da 170.31 s  Sample2         6  2.84  105. NA         C5H14NO #> # ℹ 67 more rows  # Example 2: Define blanks by group name # toy_metaboscape %>% #  join_metadata(toy_metaboscape_metadata) %>% #  filter_blank(blank_samples = \"blank\", #               blank_as_group = TRUE, #               min_frac = 3, #               group_column = Group)"},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on their coefficient of variation — filter_cv","title":"Filter Features based on their coefficient of variation — filter_cv","text":"Filters Features based coefficient variation (CV). CV defined \\(CV = \\frac{s_i}{\\overline{x_i}}\\) \\(s_i\\) = Standard deviation sample \\(\\) \\(\\overline{x_i}\\) = Mean sample \\(\\).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on their coefficient of variation — filter_cv","text":"","code":"filter_cv(   data,   reference_samples,   max_cv = 0.2,   ref_as_group = FALSE,   group_column = NULL,   na_as_zero = TRUE )"},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on their coefficient of variation — filter_cv","text":"data tidy tibble created read_featuretable. reference_samples names samples group used calculate CV feature. Usually Quality Control samples. max_cv maximum allowed CV. 0.2 reasonable start. ref_as_group logical indicating reference_samples names samples group(s). group_column relevant ref_as_group = TRUE. column used grouping reference non-reference samples? Usually group_column = Group. Uses args_data_masking. na_as_zero NA replaced 0 prior calculation? hood filter_cv calculates CV stats::sd(..., na.rm = TRUE) / mean(..., na.rm = TRUE). 3 samples calculate CV 2 NA specific feature, CV Feature NA na_as_zero = FALSE. might lead problems. na_as_zero = TRUE safer pick. Zeros replaced NA calculation matter TRUE FALSE.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on their coefficient of variation — filter_cv","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Filter Features based on their coefficient of variation — filter_cv","text":"Coefficient Variation Wikipedia","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on their coefficient of variation — filter_cv","text":"","code":"# Example 1: Define reference samples by sample names toy_metaboscape %>%   filter_cv(max_cv = 0.2, reference_samples = c(\"QC1\", \"QC2\", \"QC3\")) #> # A tibble: 33 × 8 #>      UID Feature               Sample  Intensity    RT `m/z` Name        Formula #>    <int> <chr>                 <chr>       <dbl> <dbl> <dbl> <chr>       <chr>   #>  1     3 304.24023 Da 32.86 s  Sample1        NA  0.55  305. Arachidoni… C20H32… #>  2     8 745.09111 Da 382.23 s Sample1         3  6.37  746. NADPH       C21H30… #>  3     9 427.02942 Da 424.84 s Sample1         4  7.08  428. ADP         C10H15… #>  4     3 304.24023 Da 32.86 s  Sample2         2  0.55  305. Arachidoni… C20H32… #>  5     8 745.09111 Da 382.23 s Sample2         4  6.37  746. NADPH       C21H30… #>  6     9 427.02942 Da 424.84 s Sample2         3  7.08  428. ADP         C10H15… #>  7     3 304.24023 Da 32.86 s  Sample3         1  0.55  305. Arachidoni… C20H32… #>  8     8 745.09111 Da 382.23 s Sample3         2  6.37  746. NADPH       C21H30… #>  9     9 427.02942 Da 424.84 s Sample3         4  7.08  428. ADP         C10H15… #> 10     3 304.24023 Da 32.86 s  Sample4         8  0.55  305. Arachidoni… C20H32… #> # ℹ 23 more rows  # Example 2: Define reference samples by group name toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   filter_cv(max_cv = 0.2, reference_samples = \"QC\", ref_as_group = TRUE, group_column = Group) #> # A tibble: 33 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     3 304.24023 D… Sampl…        NA  0.55  305. Arac… C20H32… cont…         1 #>  2     8 745.09111 D… Sampl…         3  6.37  746. NADPH C21H30… cont…         1 #>  3     9 427.02942 D… Sampl…         4  7.08  428. ADP   C10H15… cont…         1 #>  4     3 304.24023 D… Sampl…         2  0.55  305. Arac… C20H32… cont…         2 #>  5     8 745.09111 D… Sampl…         4  6.37  746. NADPH C21H30… cont…         2 #>  6     9 427.02942 D… Sampl…         3  7.08  428. ADP   C10H15… cont…         2 #>  7     3 304.24023 D… Sampl…         1  0.55  305. Arac… C20H32… cont…         3 #>  8     8 745.09111 D… Sampl…         2  6.37  746. NADPH C21H30… cont…         3 #>  9     9 427.02942 D… Sampl…         4  7.08  428. ADP   C10H15… cont…         3 #> 10     3 304.24023 D… Sampl…         8  0.55  305. Arac… C20H32… trea…         1 #> # ℹ 23 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/filter_global_mv.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","title":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","text":"Filters features based number fraction samples found . usually one first steps metabolomics data analysis often already performed feature table first created raw spectral files..","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_global_mv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","text":"","code":"filter_global_mv(data, min_found = 0.5, fraction = TRUE)"},{"path":"https://yasche.github.io/metamorphr/reference/filter_global_mv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","text":"data tidy tibble created metamorphr::read_featuretable(). min_found many samples must Feature found? fraction == TRUE, value 0 1 (e.g., 0.5 Feature must found least half samples). fraction == FALSE absolute maximum number samples (e.g., 5 specific Feature must found least 5 samples). fraction Either TRUE FALSE. min_found absolute number samples fraction?","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_global_mv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_global_mv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on the absolute number or fraction of samples it was found in — filter_global_mv","text":"","code":"# Example 1: A feature must be found in at least 50 % of the samples toy_metaboscape %>%   filter_global_mv(min_found = 0.5) #> # A tibble: 88 × 8 #>      UID Feature               Sample  Intensity    RT `m/z` Name        Formula #>    <int> <chr>                 <chr>       <dbl> <dbl> <dbl> <chr>       <chr>   #>  1     1 161.10519 Da 26.98 s  Sample1         4  0.45  162. NA          C7H15N… #>  2     2 276.13647 Da 27.28 s  Sample1         3  0.45  277. Octyl hydr… C16H22… #>  3     3 304.24023 Da 32.86 s  Sample1        NA  0.55  305. Arachidoni… C20H32… #>  4     4 417.23236 Da 60.08 s  Sample1         5  1     418. NA          NA      #>  5     5 104.10753 Da 170.31 s Sample1         5  2.84  105. NA          C5H14NO #>  6     6 105.04259 Da 199.80 s Sample1         5  3.33  106. NA          C3H8NO3 #>  7     8 745.09111 Da 382.23 s Sample1         3  6.37  746. NADPH       C21H30… #>  8     9 427.02942 Da 424.84 s Sample1         4  7.08  428. ADP         C10H15… #>  9     1 161.10519 Da 26.98 s  Sample2         3  0.45  162. NA          C7H15N… #> 10     2 276.13647 Da 27.28 s  Sample2         6  0.45  277. Octyl hydr… C16H22… #> # ℹ 78 more rows  # Example 2: A feature must be found in at least 8 samples toy_metaboscape %>%   filter_global_mv(min_found = 8, fraction = FALSE) #> # A tibble: 88 × 8 #>      UID Feature               Sample  Intensity    RT `m/z` Name        Formula #>    <int> <chr>                 <chr>       <dbl> <dbl> <dbl> <chr>       <chr>   #>  1     1 161.10519 Da 26.98 s  Sample1         4  0.45  162. NA          C7H15N… #>  2     2 276.13647 Da 27.28 s  Sample1         3  0.45  277. Octyl hydr… C16H22… #>  3     3 304.24023 Da 32.86 s  Sample1        NA  0.55  305. Arachidoni… C20H32… #>  4     4 417.23236 Da 60.08 s  Sample1         5  1     418. NA          NA      #>  5     5 104.10753 Da 170.31 s Sample1         5  2.84  105. NA          C5H14NO #>  6     6 105.04259 Da 199.80 s Sample1         5  3.33  106. NA          C3H8NO3 #>  7     8 745.09111 Da 382.23 s Sample1         3  6.37  746. NADPH       C21H30… #>  8     9 427.02942 Da 424.84 s Sample1         4  7.08  428. ADP         C10H15… #>  9     1 161.10519 Da 26.98 s  Sample2         3  0.45  162. NA          C7H15N… #> 10     2 276.13647 Da 27.28 s  Sample2         6  0.45  277. Octyl hydr… C16H22… #> # ℹ 78 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/filter_grouped_mv.html","id":null,"dir":"Reference","previous_headings":"","what":"Group-based feature filtering — filter_grouped_mv","title":"Group-based feature filtering — filter_grouped_mv","text":"Similar filter_global_mv filters features found specified number samples. key difference filter_grouped_mv() takes groups consideration therefore needs sample metadata. example, fraction = TRUE min_found = 0.5, feature must found least 50 % samples least 1 group. similar Filter features occurrences groups option Bruker MetaboScape.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_grouped_mv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group-based feature filtering — filter_grouped_mv","text":"","code":"filter_grouped_mv(   data,   min_found = 0.5,   group_column = .data$Group,   fraction = TRUE )"},{"path":"https://yasche.github.io/metamorphr/reference/filter_grouped_mv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group-based feature filtering — filter_grouped_mv","text":"data tidy tibble created read_featuretable added sample metadata. See ?create_metadata_skeleton help. min_found Defines many samples least 1 group Feature must found filtered . fraction == TRUE, value 0 1 (e.g., 0.5 Feature must found least half samples least 1 group). fraction == FALSE absolute maximum number samples (e.g., 5 specific Feature must found least 5 samples least 1 group). group_column column used grouping? Usually group_column = Group. Uses args_data_masking. fraction Either TRUE FALSE. min_found absolute number samples fraction?","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_grouped_mv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group-based feature filtering — filter_grouped_mv","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_grouped_mv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Group-based feature filtering — filter_grouped_mv","text":"","code":"# A Feature must be found in all samples of at least 1 group. toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   filter_grouped_mv(min_found = 1, group_column = Group) #> # A tibble: 99 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…         4  0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…         3  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…        NA  0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…         5  1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…         5  2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…         5  3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…        NA  5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…         3  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…         4  7.08  428. ADP   C10H15… cont…         1 #> 10     1 161.10519 D… Sampl…         3  0.45  162. NA    C7H15N… cont…         2 #> # ℹ 89 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/filter_msn.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on occurrence of fragment ions — filter_msn","title":"Filter Features based on occurrence of fragment ions — filter_msn","text":"Filters Features based presence MSn fragments. can help, example identification potential homologous molecules.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_msn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on occurrence of fragment ions — filter_msn","text":"","code":"filter_msn(   data,   fragments,   min_found,   tolerance = 5,   tolerance_type = \"ppm\",   show_progress = TRUE )"},{"path":"https://yasche.github.io/metamorphr/reference/filter_msn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on occurrence of fragment ions — filter_msn","text":"data data frame containing MSn spectra. fragments numeric. Exact mass fragment(s) filter . min_found many fragments must found order keep row? min_found = length(fragments), fragments must found. tolerance numeric. tolerance apply fragments. Either absolute value Da (tolerance_type = \"absolute\") ppm (tolerance_type = \"ppm\"). tolerance_type Either \"absolute\" \"ppm\". tolerance absolute value ppm? show_progress logical indicating whether progress filtering printed console. important large tibbles.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_msn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on occurrence of fragment ions — filter_msn","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_msn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on occurrence of fragment ions — filter_msn","text":"","code":"# all of the given fragments (3) must be found # returns the first row of toy_mgf toy_mgf %>%   filter_msn(fragments = c(12.3456, 23.4567, 34.5678), min_found = 3) #> # A tibble: 1 × 5 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]>  # all of the given fragments (3) must be found # returns an empty tibble because the third fragment # of row 1 (34.5678) # is outside of the tolerance (5 ppm): # Lower bound: # 34.5688 - 34.5688 * 5 / 1000000 = 34.5686 # Upper bound: # 34.5688 + 34.5688 * 5 / 1000000 = 34.5690 toy_mgf %>%   filter_msn(fragments = c(12.3456, 23.4567, 34.5688), min_found = 3) #> # A tibble: 0 × 5 #> # ℹ 5 variables: VARIABLEONE <dbl>, VARIABLETWO <dbl>, VARIABLETHREE <dbl>, #> #   PEPMASS <dbl>, MSn <list>  # only 2 of the 3 fragments must be found # returns the first row of toy_mgf toy_mgf %>%   filter_msn(fragments = c(12.3456, 23.4567, 34.5688), min_found = 2) #> # A tibble: 1 × 5 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]>"},{"path":"https://yasche.github.io/metamorphr/reference/filter_mz.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on their mass-to-charge ratios — filter_mz","title":"Filter Features based on their mass-to-charge ratios — filter_mz","text":"Facilitates filtering given mass--charge ratios (m/z) defined tolerance. Can also used filter based exact mass.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_mz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on their mass-to-charge ratios — filter_mz","text":"","code":"filter_mz(data, m_z_col, masses, tolerance = 5, tolerance_type = \"ppm\")"},{"path":"https://yasche.github.io/metamorphr/reference/filter_mz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on their mass-to-charge ratios — filter_mz","text":"data tidy tibble created read_featuretable. m_z_col column holds precursor m/z (exact mass)? Uses args_data_masking. masses mass(es) filter . tolerance numeric. tolerance apply masses Either absolute value Da (tolerance_type = \"absolute\") ppm (tolerance_type = \"ppm\"). tolerance_type Either \"absolute\" \"ppm\". tolerance absolute value ppm?","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_mz.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on their mass-to-charge ratios — filter_mz","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_mz.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on their mass-to-charge ratios — filter_mz","text":"","code":"# Use a tolerance of plus or minus 5 ppm toy_metaboscape %>%   filter_mz(m_z_col = `m/z`, 162.1132, tolerance = 5, tolerance_type = \"ppm\") #> # A tibble: 11 × 8 #>      UID Feature              Sample  Intensity    RT `m/z` Name  Formula  #>    <int> <chr>                <chr>       <dbl> <dbl> <dbl> <chr> <chr>    #>  1     1 161.10519 Da 26.98 s Sample1         4  0.45  162. NA    C7H15NO3 #>  2     1 161.10519 Da 26.98 s Sample2         3  0.45  162. NA    C7H15NO3 #>  3     1 161.10519 Da 26.98 s Sample3         4  0.45  162. NA    C7H15NO3 #>  4     1 161.10519 Da 26.98 s Sample4        NA  0.45  162. NA    C7H15NO3 #>  5     1 161.10519 Da 26.98 s Sample5         9  0.45  162. NA    C7H15NO3 #>  6     1 161.10519 Da 26.98 s Sample6         8  0.45  162. NA    C7H15NO3 #>  7     1 161.10519 Da 26.98 s QC1             7  0.45  162. NA    C7H15NO3 #>  8     1 161.10519 Da 26.98 s QC2             6  0.45  162. NA    C7H15NO3 #>  9     1 161.10519 Da 26.98 s QC3             3  0.45  162. NA    C7H15NO3 #> 10     1 161.10519 Da 26.98 s Blank1         NA  0.45  162. NA    C7H15NO3 #> 11     1 161.10519 Da 26.98 s Blank2         NA  0.45  162. NA    C7H15NO3  # Use a tolerance of plus or minus 0.005 Da toy_metaboscape %>%   filter_mz(m_z_col = `m/z`, 162.1132, tolerance = 0.005, tolerance_type = \"absolute\") #> # A tibble: 11 × 8 #>      UID Feature              Sample  Intensity    RT `m/z` Name  Formula  #>    <int> <chr>                <chr>       <dbl> <dbl> <dbl> <chr> <chr>    #>  1     1 161.10519 Da 26.98 s Sample1         4  0.45  162. NA    C7H15NO3 #>  2     1 161.10519 Da 26.98 s Sample2         3  0.45  162. NA    C7H15NO3 #>  3     1 161.10519 Da 26.98 s Sample3         4  0.45  162. NA    C7H15NO3 #>  4     1 161.10519 Da 26.98 s Sample4        NA  0.45  162. NA    C7H15NO3 #>  5     1 161.10519 Da 26.98 s Sample5         9  0.45  162. NA    C7H15NO3 #>  6     1 161.10519 Da 26.98 s Sample6         8  0.45  162. NA    C7H15NO3 #>  7     1 161.10519 Da 26.98 s QC1             7  0.45  162. NA    C7H15NO3 #>  8     1 161.10519 Da 26.98 s QC2             6  0.45  162. NA    C7H15NO3 #>  9     1 161.10519 Da 26.98 s QC3             3  0.45  162. NA    C7H15NO3 #> 10     1 161.10519 Da 26.98 s Blank1         NA  0.45  162. NA    C7H15NO3 #> 11     1 161.10519 Da 26.98 s Blank2         NA  0.45  162. NA    C7H15NO3"},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":"occurrence characteristic neutral losses can help putative annotation molecules. See Reference section example.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":"","code":"filter_neutral_loss(   data,   losses,   min_found,   tolerance = 10,   tolerance_type = \"ppm\",   show_progress = TRUE )"},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":"data data frame containing MSn spectra. losses numeric. Exact mass fragment(s) filter . min_found many fragments must found order keep row? min_found = length(fragments), fragments must found. tolerance numeric. tolerance apply fragments. Either absolute value Da (tolerance_type = \"absolute\") ppm (tolerance_type = \"ppm\"). tolerance_type Either \"absolute\" \"ppm\". tolerance absolute value ppm? show_progress logical indicating whether progress filtering printed console. important large tibbles.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":"filtered tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":". Brink, F. Fontaine, M. Marschmann, B. Steinhuber, E. N. Cece, . Zamora, . Pähler, Rapid Commun. Mass Spectrom. 2014, 28, 2695–2703, DOI 10.1002/rcm.7062.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/filter_neutral_loss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Features based on occurrence of neutral losses — filter_neutral_loss","text":"","code":"# neutral losses must be calculated first toy_mgf_nl <- toy_mgf %>%   calc_neutral_loss(m_z_col = PEPMASS)  # all of the given losses (3) must be found # returns the first row of toy_mgf toy_mgf_nl %>%   filter_neutral_loss(losses = c(11.1111, 22.2222, 33.3333), min_found = 3) #> # A tibble: 1 × 6 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              Neutral_Loss #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           <list>       #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]> <tibble>      # all of the given fragments (3) must be found # returns an empty tibble because the third loss # of row 1 (33.3333) # is outside of the tolerance (10 ppm): # Lower bound: # 33.4333 - 33.4333 * 5 / 1000000 = 33.4333 # Upper bound: # 33.4333 + 33.4333 * 5 / 1000000 = 33.4336 toy_mgf_nl %>%   filter_neutral_loss(losses = c(11.1111, 22.2222, 33.4333), min_found = 3) #> # A tibble: 0 × 6 #> # ℹ 6 variables: VARIABLEONE <dbl>, VARIABLETWO <dbl>, VARIABLETHREE <dbl>, #> #   PEPMASS <dbl>, MSn <list>, Neutral_Loss <list>  # only 2 of the 3 fragments must be found # returns the first row of toy_mgf toy_mgf_nl %>%   filter_neutral_loss(losses = c(11.1111, 22.2222, 33.4333), min_found = 2) #> # A tibble: 1 × 6 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              Neutral_Loss #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           <list>       #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]> <tibble>"},{"path":"https://yasche.github.io/metamorphr/reference/formula_to_mass.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the monoisotopic mass from a given formula — formula_to_mass","title":"Calculate the monoisotopic mass from a given formula — formula_to_mass","text":"Calculates monoisotopic mass given formula. element symbols provided, calculated mass corresponds molecule made abundant isotopes. isotopes can also provided (e.g., 13C, instead naturally abundant 12C). See samples details.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/formula_to_mass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the monoisotopic mass from a given formula — formula_to_mass","text":"","code":"formula_to_mass(formula)"},{"path":"https://yasche.github.io/metamorphr/reference/formula_to_mass.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the monoisotopic mass from a given formula — formula_to_mass","text":"formula formula string.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/formula_to_mass.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the monoisotopic mass from a given formula — formula_to_mass","text":"monoisotopic mass formula.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/formula_to_mass.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the monoisotopic mass from a given formula — formula_to_mass","text":"","code":"# The monoisotopic mass is calculated with the most abundant isotopes # if only the element symbols are provided: formula_to_mass(\"CH4\") #> [1] 16.0313 formula_to_mass(\"NH3\") #> [1] 17.02655 formula_to_mass(\"C10H17N3O6S\") #> [1] 307.0838  # Other isotopes can be provided as follows: formula_to_mass(\"[13C]H4\") #> [1] 17.03465 formula_to_mass(\"[15N]H3\") #> [1] 18.02358  # Every isotope, including the most abundant ones, can be named explicitly. # Compare: formula_to_mass(\"[14N][1H]3\") #> [1] 17.02655 formula_to_mass(\"NH3\") #> [1] 17.02655  # The function also supports brackets and nested brackets: formula_to_mass(\"(CH3)2\") #> [1] 30.04695 formula_to_mass(\"(((CH3)2N)3C)2\") #> [1] 288.3001 formula_to_mass(\"((([13C]H3)2N)3C)2\") #> [1] 300.3404"},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using Bayesian PCA — impute_bpca","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"One several PCA-based imputation methods. Basically wrapper around pcaMethods::pca(method = \"bpca\"). detailed discussion, see vignette(\"pcaMethods\") vignette(\"missingValues\", \"pcaMethods\") well References section. Important Note impute_bpca() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_bpca() called without pcaMethods package installed, asked want install pak pcaMethods. want use impute_bpca() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"","code":"impute_bpca(data, n_pcs = 2, center = TRUE, scale = \"none\", direction = 2)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"data tidy tibble created read_featuretable. n_pcs number PCs calculate. center data mean centered? See prep details. scale data scaled? See prep details. direction Either 1 2. 1 runs PCA matrix samples columns features rows 2 runs PCA matrix features columns samples rows. valid according discussion GitHub give different results.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"H. R. Wolfram Stacklies, 2017, DOI 10.18129/B9.BIOC.PCAMETHODS. W. Stacklies, H. Redestig, M. Scholz, D. Walther, J. Selbig, Bioinformatics 2007, 23, 1164–1167, DOI 10.1093/bioinformatics/btm069.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_bpca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using Bayesian PCA — impute_bpca","text":"","code":"toy_metaboscape %>%   impute_bpca() #> `impute_bpca` output: #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      5.25  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.33  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.33  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_global_lowest.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","title":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","text":"Replace missing intensity values (NA) lowest observed intensity.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_global_lowest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","text":"","code":"impute_global_lowest(data)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_global_lowest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_global_lowest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_global_lowest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with the lowest observed intensity (global) — impute_global_lowest","text":"","code":"toy_metaboscape %>%   impute_global_lowest() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1         4  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1         3  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1         1  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1         5  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1         5  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1         5  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1         1  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1         3  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1         4  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1         1  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using nearest neighbor averaging — impute_knn","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"Basically wrapper function around impute::impute.knn. Imputes missing values using k-th nearest neighbor algorithm. Note function ln-transforms data prior imputation transforms back original scale afterwards. Please manually prior calling impute_knn()! See References information. Important Note impute_knn() depends impute package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_knn() called without impute package installed, asked want install pak impute. want use impute_knn() install . case run trouble automatic installation, please install impute manually. See impute: Imputation microarray data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"","code":"impute_knn(data, quietly = TRUE, ...)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"data tidy tibble created read_featuretable. quietly TRUE FALSE. messages warnings impute.knn printed console? ... Additional parameters passed impute.knn.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"Robert Tibshirani, Trevor Hastie, 2017, DOI 10.18129/B9.BIOC.IMPUTE. J. Khan, J. S. Wei, M. Ringnér, L. H. Saal, M. Ladanyi, F. Westermann, F. Berthold, M. Schwab, C. R. Antonescu, C. Peterson, P. S. Meltzer, Nat Med 2001, 7, 673–679, DOI 10.1038/89044.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_knn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using nearest neighbor averaging — impute_knn","text":"","code":"toy_metaboscape %>%   impute_knn() #> Warning: 2 rows with more than 50 % entries missing; #>  mean imputation used for these rows #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      4.04  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      4.05  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      4.05  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using Local Least Squares (LLS) — impute_lls","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"Basically wrapper around pcaMethods::llsImpute. detailed discussion, see vignette(\"pcaMethods\") vignette(\"missingValues\", \"pcaMethods\") well References section. Important Note impute_lls() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_svd() called without pcaMethods package installed, asked want install pak pcaMethods. want use impute_lls() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"","code":"impute_lls(   data,   correlation = \"pearson\",   complete_genes = FALSE,   center = FALSE,   cluster_size = 10 )"},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"data tidy tibble created read_featuretable. correlation method used calculate correlations features. One \"pearson\", \"spearman\" \"kendall\". See cor. complete_genes TRUE complete features used regression, FALSE, used. center data mean centered? See prep details. cluster_size number similar features used regression.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"H. R. Wolfram Stacklies, 2017, DOI 10.18129/B9.BIOC.PCAMETHODS. W. Stacklies, H. Redestig, M. Scholz, D. Walther, J. Selbig, Bioinformatics 2007, 23, 1164–1167, DOI 10.1093/bioinformatics/btm069.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using Local Least Squares (LLS) — impute_lls","text":"","code":"# The cluster size must be reduced because # the data set is too small for the default (10)  toy_metaboscape %>%   impute_lls(complete_genes = TRUE, cluster_size = 5) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      2.86  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      3.94  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      2.87  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"Replace missing intensity values (NA) assumed detector limit detection (LoD). estimated dividing Feature minimum provided denominator, usually 5. See References section information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"","code":"impute_lod(data, div_by = 5)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"data tidy tibble created read_featuretable. div_by numeric value specifies number Feature minimum divided","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"LoD OmicsForum","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_lod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with the Feature 'Limit of Detection' — impute_lod","text":"","code":"toy_metaboscape %>%   impute_lod() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1       4    0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1       3    0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1       0.2  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1       5    1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1       5    2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1       5    3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1       1.4  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1       3    6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1       4    7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1       0.4  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with the Feature mean — impute_mean","title":"Impute missing values by replacing them with the Feature mean — impute_mean","text":"Replace missing intensity values (NA) Feature mean non-NA values. example, Feature measured intensities NA, 1, NA, 3, 2 samples 1-5, intensities impute_mean() 2, 1, 2, 3, 2.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with the Feature mean — impute_mean","text":"","code":"impute_mean(data)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with the Feature mean — impute_mean","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with the Feature mean — impute_mean","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_mean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with the Feature mean — impute_mean","text":"","code":"toy_metaboscape %>%   impute_mean() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      5.25  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.33  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.33  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with the Feature median — impute_median","title":"Impute missing values by replacing them with the Feature median — impute_median","text":"Replace missing intensity values (NA) Feature median non-NA values. example, Feature measured intensities NA, 1, NA, 3, 2 samples 1-5, intensities impute_median() 2, 1, 2, 3, 2.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with the Feature median — impute_median","text":"","code":"impute_median(data)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with the Feature median — impute_median","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with the Feature median — impute_median","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_median.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with the Feature median — impute_median","text":"","code":"toy_metaboscape %>%   impute_median() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1       4    0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1       3    0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1       5.5  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1       5    1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1       5    2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1       5    3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1       9    5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1       3    6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1       4    7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1       3    8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_min.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with the Feature minimum — impute_min","title":"Impute missing values by replacing them with the Feature minimum — impute_min","text":"Replace missing intensity values (NA) Feature minimum non-NA values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_min.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with the Feature minimum — impute_min","text":"","code":"impute_min(data)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_min.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with the Feature minimum — impute_min","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_min.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with the Feature minimum — impute_min","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_min.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with the Feature minimum — impute_min","text":"","code":"toy_metaboscape %>%   impute_min() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1         4  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1         3  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1         1  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1         5  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1         5  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1         5  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1         7  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1         3  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1         4  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1         2  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using NIPALS PCA — impute_nipals","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"One several PCA-based imputation methods. Basically wrapper around pcaMethods::pca(method = \"nipals\"). detailed discussion, see vignette(\"pcaMethods\") vignette(\"missingValues\", \"pcaMethods\") well References section. Important Note impute_nipals() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_nipals() called without pcaMethods package installed, asked want install pak pcaMethods. want use impute_nipals() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"","code":"impute_nipals(data, n_pcs = 2, center = TRUE, scale = \"none\", direction = 2)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"data tidy tibble created read_featuretable. n_pcs number PCs calculate. center data mean centered? See prep details. scale data scaled? See prep details. direction Either 1 2. 1 runs PCA matrix samples columns features rows 2 runs PCA matrix features columns samples rows. valid according discussion GitHub give different results.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"H. R. Wolfram Stacklies, 2017, DOI 10.18129/B9.BIOC.PCAMETHODS. W. Stacklies, H. Redestig, M. Scholz, D. Walther, J. Selbig, Bioinformatics 2007, 23, 1164–1167, DOI 10.1093/bioinformatics/btm069.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_nipals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using NIPALS PCA — impute_nipals","text":"","code":"toy_metaboscape %>%   impute_nipals() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      5.05  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.26  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.31  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using Probabilistic PCA — impute_ppca","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"One several PCA-based imputation methods. Basically wrapper around pcaMethods::pca(method = \"ppca\"). detailed discussion, see vignette(\"pcaMethods\") vignette(\"missingValues\", \"pcaMethods\") well References section.  underlying function (pcaMethods::pca(method = \"ppca\")), order columns influence outcome. Therefore, calling pcaMethods::pca(method = \"ppca\") matrix calling metamorphr::impute() tidy tibble might give different results, even though contain data. hood, tibble transformed matrix prior calling pcaMethods::pca(method = \"ppca\") limited influence column order resulting matrix. Important Note impute_ppca() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_ppca() called without pcaMethods package installed, asked want install pak pcaMethods. want use impute_ppca() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"","code":"impute_ppca(   data,   n_pcs = 2,   center = TRUE,   scale = \"none\",   direction = 2,   random_seed = 1L )"},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"data tidy tibble created read_featuretable. n_pcs number PCs calculate. center data mean centered? See prep details. scale data scaled? See prep details. direction Either 1 2. 1 runs PCA matrix samples columns features rows 2 runs PCA matrix features columns samples rows. valid according discussion GitHub give different results. random_seed integer used seed random number generator.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"H. R. Wolfram Stacklies, 2017, DOI 10.18129/B9.BIOC.PCAMETHODS. W. Stacklies, H. Redestig, M. Scholz, D. Walther, J. Selbig, Bioinformatics 2007, 23, 1164–1167, DOI 10.1093/bioinformatics/btm069.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_ppca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using Probabilistic PCA — impute_ppca","text":"","code":"toy_metaboscape %>%   impute_ppca() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      4.95  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.22  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.39  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using random forest — impute_rf","title":"Impute missing values using random forest — impute_rf","text":"Basically wrapper function around missForest::missForest. Imputes missing values using random forest algorithm.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using random forest — impute_rf","text":"","code":"impute_rf(data, random_seed = 1L, ...)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using random forest — impute_rf","text":"data tidy tibble created read_featuretable. random_seed seed random number generator. Can integer NULL (case particular seed used) reproducibility reasons strongly advised provide integer. ... Additional parameters passed missForest.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using random forest — impute_rf","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using random forest — impute_rf","text":"missForest CRAN D. J. Stekhoven, P. Bühlmann, Bioinformatics 2012, 28, 112–118, DOI 10.1093/bioinformatics/btr597.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_rf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using random forest — impute_rf","text":"","code":"toy_metaboscape %>%   impute_rf() #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> Warning: The response has five or fewer unique values.  Are you sure you want to do regression? #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      5.25  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.2   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.23  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"Basically wrapper around pcaMethods::pca(method = \"svdImpute\"). detailed discussion, see vignette(\"pcaMethods\") vignette(\"missingValues\", \"pcaMethods\") well References section. Important Note impute_svd() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. impute_svd() called without pcaMethods package installed, asked want install pak pcaMethods. want use impute_svd() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"","code":"impute_svd(data, n_pcs = 2, center = TRUE, scale = \"none\", direction = 2)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"data tidy tibble created read_featuretable. n_pcs number PCs calculate. center data mean centered? See prep details. scale data scaled? See prep details. direction Either 1 2. 1 runs pcaMethods::pca(method = \"svdImpute\") matrix samples columns features rows 2 runs pcaMethods::pca(method = \"svdImpute\") matrix features columns samples rows. valid according discussion GitHub give different results.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"H. R. Wolfram Stacklies, 2017, DOI 10.18129/B9.BIOC.PCAMETHODS. W. Stacklies, H. Redestig, M. Scholz, D. Walther, J. Selbig, Bioinformatics 2007, 23, 1164–1167, DOI 10.1093/bioinformatics/btm069. O. Troyanskaya, M. Cantor, G. Sherlock, P. Brown, T. Hastie, R. Tibshirani, D. Botstein, R. B. Altman, Bioinformatics 2001, 17, 520–525, DOI 10.1093/bioinformatics/17.6.520.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_svd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values using Singular Value Decomposition (SVD) — impute_svd","text":"","code":"toy_metaboscape %>%   impute_svd() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3     0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      4.61  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      5     1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      5     2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      5     3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      8.12  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3     6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1      3.61  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/impute_user_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values by replacing them with a user-provided value — impute_user_value","title":"Impute missing values by replacing them with a user-provided value — impute_user_value","text":"Replace missing intensity values (NA) user-provided value (e.g., 1).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_user_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values by replacing them with a user-provided value — impute_user_value","text":"","code":"impute_user_value(data, value)"},{"path":"https://yasche.github.io/metamorphr/reference/impute_user_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values by replacing them with a user-provided value — impute_user_value","text":"data tidy tibble created read_featuretable. value Numeric replaces missing values","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_user_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values by replacing them with a user-provided value — impute_user_value","text":"tibble imputed missing values.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/impute_user_value.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values by replacing them with a user-provided value — impute_user_value","text":"","code":"toy_metaboscape %>%   impute_user_value(value = 1) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1         4  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1         3  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1         1  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1         5  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1         5  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1         5  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1         1  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1         3  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1         4  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1         1  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/join_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Join a featuretable and sample metadata — join_metadata","title":"Join a featuretable and sample metadata — join_metadata","text":"Joins featuretable associated sample metadata. Basically wrapper around left_join = \"Sample\".","code":""},{"path":"https://yasche.github.io/metamorphr/reference/join_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join a featuretable and sample metadata — join_metadata","text":"","code":"join_metadata(data, metadata)"},{"path":"https://yasche.github.io/metamorphr/reference/join_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join a featuretable and sample metadata — join_metadata","text":"data feature table created read_featuretable metadata Sample metadata created create_metadata_skeleton","code":""},{"path":"https://yasche.github.io/metamorphr/reference/join_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join a featuretable and sample metadata — join_metadata","text":"tibble added sample metadata.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/join_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Join a featuretable and sample metadata — join_metadata","text":"","code":"toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…         4  0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…         3  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…        NA  0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…         5  1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…         5  2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…         5  3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…        NA  5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…         3  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…         4  7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…        NA  8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/metamorphr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"metamorphr: Tidy and Streamlined Metabolomics Data Workflows — metamorphr-package","title":"metamorphr: Tidy and Streamlined Metabolomics Data Workflows — metamorphr-package","text":"Facilitate tasks typically encountered metabolomics data analysis including data import, filtering, missing value imputation (Stacklies et al. (2007) doi:10.1093/bioinformatics/btm069 , Stekhoven et al. (2012) doi:10.1093/bioinformatics/btr597 , Tibshirani et al. (2017) doi:10.18129/B9.BIOC.IMPUTE , Troyanskaya et al. (2001) doi:10.1093/bioinformatics/17.6.520 ), normalization (Bolstad et al. (2003) doi:10.1093/bioinformatics/19.2.185 , Dieterle et al. (2006) doi:10.1021/ac051632c , Zhao et al. (2020) doi:10.1038/s41598-020-72664-6 ) transformation, centering scaling (Van Den Berg et al. (2006) doi:10.1186/1471-2164-7-142 ) well statistical tests plotting. 'metamorphr' introduces tidy (Wickham et al. (2019) doi:10.21105/joss.01686 ) format metabolomics data designed make easier build elaborate analysis workflows integrate 'tidyverse' packages including 'dplyr' 'ggplot2'.","code":""},{"path":[]},{"path":"https://yasche.github.io/metamorphr/reference/metamorphr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"metamorphr: Tidy and Streamlined Metabolomics Data Workflows — metamorphr-package","text":"Maintainer: Yannik Schermer yannik.schermer@chem.rptu.de (ORCID) [copyright holder]","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"steps algorithm takes following: log2 transform intensities Choose 2 samples generate MA-plot Fit LOESS curve Subtract half difference predicted value true value intensity sample 1 add amount intensity Sample 2 Repeat unique combinations samples Repeat steps model converges n_iter reached. Convergence assumed confidence intervals LOESS smooths include 0 line. fixed_iter = TRUE, algorithm perform exactly n_iter iterations. fixed_iter = FALSE, algorithm perform maximum n_iter iterations. See reference section details.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"","code":"normalize_cyclic_loess(   data,   n_iter = 3,   fixed_iter = TRUE,   loess_span = 0.7,   level = 0.95,   verbose = FALSE,   ... )"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"data tidy tibble created read_featuretable. n_iter number iterations perform. fixed_iter = TRUE exactly n_iter performed. fixed_iter = FALSE maximum n_iter performed algorithm stop whether convergence reached . fixed_iter fixed number iterations performed? loess_span span LOESS fit. larger span produces smoother line. level confidence level convergence criterion. Note larger confidence level produces larger confidence intervals therefore algorithm stops earlier. verbose TRUE FALSE. messages printed console? ... Arguments passed onto loess. example, degree = 1, family = \"symmetric\", iterations = 4, surface = \"direct\" produces LOWESS fit.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"B. M. Bolstad, R. . Irizarry, M. Åstrand, T. P. Speed, Bioinformatics 2003, 19, 185–193, DOI 10.1093/bioinformatics/19.2.185. Karla Ballman, Diane Grill, Ann Oberg, Terry Therneau, “Faster cyclic loess: normalizing DNA arrays via linear models” can found https://www.mayo.edu/research/documents/biostat-68pdf/doc-10027897, 2004. K. V. Ballman, D. E. Grill, . L. Oberg, T. M. Therneau, Bioinformatics 2004, 20, 2778–2786, DOI 10.1093/bioinformatics/bth327.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_cyclic_loess.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using cyclic LOESS normalization — normalize_cyclic_loess","text":"","code":"toy_metaboscape %>%   impute_lod() %>%   normalize_cyclic_loess() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1     2.85   0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1     4.31   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1     1.77   0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1     3.76   1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1     2.36   2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     2.46   3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     2.09   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1     1.72   6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1     3.08   7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1     0.705  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using a normalization factor — normalize_factor","title":"Normalize intensities across samples using a normalization factor — normalize_factor","text":"Normalization done dividing intensity sample-specific factor (e.g., weight, protein DNA content). function requires sample-specific factor, usually supplied via Factor column sample metadata. See Examples section details.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using a normalization factor — normalize_factor","text":"","code":"normalize_factor(data, factor_column = .data$Factor)"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using a normalization factor — normalize_factor","text":"data tidy tibble created read_featuretable. factor_column column contains sample-specific factor? Usually factor_column = Factor. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_factor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using a normalization factor — normalize_factor","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_factor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using a normalization factor — normalize_factor","text":"","code":"toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   normalize_factor() #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…      4.66  0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…      3.50  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…     NA     0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…      5.83  1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…      5.83  2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…      5.83  3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…     NA     5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…      3.50  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…      4.66  7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…     NA     8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples by dividing by the sample median — normalize_median","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"Normalize across samples dividing feature intensities sample median, making median 1 samples. See References information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"","code":"normalize_median(data)"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"T. Ramirez, . Strigun, . Verlohner, H.-. Huener, E. Peter, M. Herold, N. Bordag, W. Mellert, T. Walk, M. Spitzer, X. Jiang, S. Sperber, T. Hofmann, T. Hartung, H. Kamp, B. Van Ravenzwaay, Arch Toxicol 2018, 92, 893–906, DOI 10.1007/s00204-017-2079-6.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_median.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples by dividing by the sample median — normalize_median","text":"","code":"toy_metaboscape %>%   normalize_median() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      1     0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      0.75  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1     NA     0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      1.25  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      1.25  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      1.25  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     NA     5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      0.75  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      1     7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1     NA     8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"method originally developed H-NMR spectra complex biofluids adapted 'omics data. aims eliminate dilution effects calculating probable dilution factor sample, relative one reference samples. See references details.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"","code":"normalize_pqn(   data,   fn = \"median\",   normalize_sum = TRUE,   reference_samples = NULL,   ref_as_group = FALSE,   group_column = NULL )"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"data tidy tibble created read_featuretable. fn function used calculate reference spectrum reference samples? Can either \"mean\" \"median\". normalize_sum logical indicating whether sum normalization (aka total area normalization) performed prior PQN. recommended packages (e.g., KODAMA) also perform sum normalization prior PQN. reference_samples Either NULL character character vector containing sample(s) calculate reference spectrum . original publication, advised calculate median control samples. NULL, samples used calculate reference spectrum. ref_as_group logical indicating reference_samples names samples group(s). group_column relevant ref_as_group = TRUE. column used grouping reference non-reference samples? Usually group_column = Group. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"F. Dieterle, . Ross, G. Schlotterbeck, H. Senn, Anal. Chem. 2006, 78, 4281–4290, DOI 10.1021/ac051632c.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_pqn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using a Probabilistic Quotient Normalization (PQN) — normalize_pqn","text":"","code":"# specify the reference samples with their sample names toy_metaboscape %>%   impute_lod() %>%   normalize_pqn(reference_samples = c(\"QC1\", \"QC2\", \"QC3\")) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1   0.115    0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1   0.0862   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1   0.00575  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1   0.144    1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1   0.144    2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1   0.144    3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1   0.0402   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1   0.0862   6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1   0.115    7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1   0.0115   8.32 1285. NA         NA      #> # ℹ 100 more rows  # specify the reference samples with their group names toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   impute_lod() %>%   normalize_pqn(reference_samples = c(\"QC\"), ref_as_group = TRUE, group_column = Group) #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…   0.115    0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…   0.0862   0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…   0.00575  0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…   0.144    1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…   0.144    2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…   0.144    3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…   0.0402   5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…   0.0862   6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…   0.115    7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…   0.0115   8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"standard approach Quantile Normalization. sub-flavors also available: normalize_quantile_group normalize_quantile_batch normalize_quantile_smooth See References information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"","code":"normalize_quantile_all(data)"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_all.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using standard Quantile Normalization — normalize_quantile_all","text":"","code":"toy_metaboscape %>%   normalize_quantile_all() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      4.31  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      3.14  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      8.12  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      6.04  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      6.04  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      6.04  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1      9     5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      3.14  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      4.31  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NaN     8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"function performs Quantile Normalization sub-group batch data set. therefore requires grouping information. See Examples information. approach might perform better standard approach, normalize_quantile_all, sub-groups different (e.g., comparing cancer vs. normal tissue). sub-flavors also available: normalize_quantile_all normalize_quantile_batch normalize_quantile_smooth See References information. Note equivalent 'Discrete' normalization Zhao et al. renamed internal consistency.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"","code":"normalize_quantile_batch(   data,   group_column = .data$Group,   batch_column = .data$Batch )"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. batch_column column contains batch information? Usually grouping_column = Batch. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_batch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using grouped Quantile Normalization with multiple batches — normalize_quantile_batch","text":"","code":"toy_metaboscape %>%   # Metadata, including grouping and batch information,   # must be added before using normalize_quantile_batch()   join_metadata(toy_metaboscape_metadata) %>%   normalize_quantile_batch(group_column = Group, batch_column = Batch) #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…      3.83  0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…      2.33  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…      8     0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…      5.22  1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…      5.22  2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…      5.22  3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…    NaN     5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…      2.33  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…      3.83  7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…    NaN     8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"function performs Quantile Normalization sub-group data set. therefore requires grouping information. See Examples information. approach might perform better standard approach, normalize_quantile_all, sub-groups different (e.g., comparing cancer vs. normal tissue). sub-flavors also available: normalize_quantile_all normalize_quantile_batch normalize_quantile_smooth See References information. Note equivalent 'Class-specific' normalization Zhao et al. renamed internal consistency.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"","code":"normalize_quantile_group(data, group_column = .data$Group)"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_group.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using grouped Quantile Normalization — normalize_quantile_group","text":"","code":"toy_metaboscape %>%   # Metadata, including grouping information, must be added before using normalize_quantile_group()   join_metadata(toy_metaboscape_metadata) %>%   normalize_quantile_group(group_column = Group) #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…      3.83  0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…      2.33  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…      8     0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…      5.22  1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…      5.22  2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…      5.22  3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…    NaN     5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…      2.33  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…      3.83  7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…    NaN     8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"function performs smooth Quantile Normalization sub-group data set (qsmooth). therefore requires grouping information. See Examples information. approach might perform better standard approach, normalize_quantile_all, sub-groups different (e.g., comparing cancer vs. normal tissue). result lies somewhere normalize_quantile_group normalize_quantile_all. Basically re-implementation Hicks et al. (2018).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"","code":"normalize_quantile_smooth(   data,   group_column = .data$Group,   rolling_window = 0.05 )"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking. rolling_window normalize_quantile_smooth uses rolling window median eliminate isolated outliers. argument specifies size rolling window fraction number unique features data. example, 100 features data rolling_window = 0.05, rolling median calculated 5 features. Set rolling_window = 0 disable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"S. C. Hicks, K. Okrah, J. N. Paulson, J. Quackenbush, R. . Irizarry, H. C. Bravo, Biostatistics 2018, 19, 185–198, DOI 10.1093/biostatistics/kxx028. Y. Zhao, L. Wong, W. W. B. Goh, Sci Rep 2020, 10, 15534, DOI 10.1038/s41598-020-72664-6.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_quantile_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using smooth Quantile Normalization (qsmooth) — normalize_quantile_smooth","text":"","code":"toy_metaboscape %>%   # Metadata, including grouping information, must be added before using normalize_quantile_group()   join_metadata(toy_metaboscape_metadata) %>%   normalize_quantile_smooth(group_column = Group) #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…    NaN     0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…      2.56  0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…    NaN     0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…    NaN     1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…    NaN     2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…    NaN     3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…    NaN     5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…      2.56  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…    NaN     7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…    NaN     8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_ref.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples using a reference feature — normalize_ref","title":"Normalize intensities across samples using a reference feature — normalize_ref","text":"Performs normalization based reference feature, example internal standard. Divides Intensities features Intensity reference feature sample multiplies constant value, making Intensity reference feature sample.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_ref.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples using a reference feature — normalize_ref","text":"","code":"normalize_ref(   data,   reference_feature,   identifier_column,   reference_feature_intensity = 1 )"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_ref.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples using a reference feature — normalize_ref","text":"data tidy tibble created read_featuretable. reference_feature identifier reference feature. Must unique. recommended use UID. identifier_column column look reference feature. recommended use identifier_column = UID reference_feature_intensity Either constant value intensity feature multiplied function (e.g., mean, median, min, max). function provided, use function Intensities reference feature samples normalization multiply intensity feature value dividing Intensity reference feature. example, reference_feature_intensity = mean, calculates mean Intensities reference features across samples normalization. divides Intensity feature Intensity reference feature sample. Finally, multiplies Intensity mean Intensities reference features prior normalization.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_ref.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples using a reference feature — normalize_ref","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_ref.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples using a reference feature — normalize_ref","text":"","code":"# Divide by the reference feature and make its Intensity 1000 in each sample toy_metaboscape %>%   impute_lod() %>%   normalize_ref(reference_feature = 2, identifier_column = UID, reference_feature_intensity = 1000) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1    1333.   0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1    1000    0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1      66.7  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1    1667.   1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    1667.   2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1    1667.   3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     467.   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    1000    6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1    1333.   7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1     133.   8.32 1285. NA         NA      #> # ℹ 100 more rows  # Divide by the reference feature and make its Intensity the mean of intensities # of the reference features before normalization toy_metaboscape %>%   impute_lod() %>%   normalize_ref(reference_feature = 2, identifier_column = UID, reference_feature_intensity = mean) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1     6.42   0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1     4.82   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1     0.321  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1     8.03   1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1     8.03   2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     8.03   3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     2.25   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1     4.82   6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1     6.42   7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1     0.642  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_sum.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","title":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","text":"Normalize across samples dividing feature intensities sum intensities sample, making sum 1 samples. Important Note Intensities individual features small normalization approach. therefore advised multiply intensities fixed number (e.g., 1000) normalization. See discussion OMICSForum.ca examples information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_sum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","text":"","code":"normalize_sum(data)"},{"path":"https://yasche.github.io/metamorphr/reference/normalize_sum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_sum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","text":"tibble intensities normalized across samples.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/normalize_sum.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize intensities across samples by dividing by the sample sum — normalize_sum","text":"","code":"# Example 1: Normalization only toy_metaboscape %>%   normalize_sum() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1     0.138  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1     0.103  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    NA      0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1     0.172  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1     0.172  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.172  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1    NA      5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1     0.103  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1     0.138  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NA      8.32 1285. NA         NA      #> # ℹ 100 more rows  # Example 2: Multiply with 1000 after normalization toy_metaboscape %>%   normalize_sum() %>%   dplyr::mutate(Intensity = .data$Intensity * 1000) #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1      138.  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1      103.  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1       NA   0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1      172.  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1      172.  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1      172.  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1       NA   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1      103.  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1      138.  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1       NA   8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://yasche.github.io/metamorphr/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_pca.html","id":null,"dir":"Reference","previous_headings":"","what":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","title":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","text":"Performs PCA creates Scores Loadings plot. Basically wrapper around pcaMethods::pca plot drawn ggplot2 can therefore easily manipulated afterwards (e.g., changing theme axis labels). Please note function intended easy use beginner friendly therefore offers limited ability fine-tune certain parameters resulting plot. wish draw plot , can set return_tbl = TRUE. case, tibble returned instead ggplot2 object can use create plot . Important Note plot_pca() depends pcaMethods package Bioconductor. metamorphr installed via install.packages(), dependencies Bioconductor automatically installed. plot_pca() called without pcaMethods package installed, asked want install pak pcaMethods. want use plot_pca() install . case run trouble automatic installation, please install pcaMethods manually. See pcaMethods – Bioconductor package providing PCA methods incomplete data instructions manual installation.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_pca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","text":"","code":"plot_pca(   data,   method = \"svd\",   what = \"scores\",   n_pcs = 2,   pcs = c(1, 2),   center = TRUE,   group_column = NULL,   name_column = NULL,   return_tbl = FALSE,   verbose = FALSE )"},{"path":"https://yasche.github.io/metamorphr/reference/plot_pca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","text":"data tidy tibble created read_featuretable. method character specifying one available methods (\"svd\", \"nipals\", \"rnipals\", \"bpca\", \"ppca\", \"svdImpute\", \"robustPca\", \"nlpca\", \"llsImpute\", \"llsImputeAll\"). default used (\"svd\") SVD PCA done, case data contain missing values, NIPALS PCA data contain missing values. Specifies returned. Either \"scores\" \"loadings\". n_pcs number PCs calculate. pcs vector containing 2 integers specifies PCs plot. relevant return_tbl = FALSE. following condition applies: max(pcs) <= n_pcs. center data mean centered? See prep details. group_column Either NULL column data (e.g., group_column = Group). provided, dots scores plot colored according group. relevant = \"scores\". name_column Either NULL column data (e.g., name_column = Feature). provided, feature names preserved resulting tibble. relevant = \"loadings\" & return_tbl = TRUE. return_tbl logical. FALSE, returns ggplot2 object, TRUE returns tibble can used draw plot manually control. verbose outputs pca printed console?","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_pca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","text":"Either Scores Loadings Plot form ggplot2 object tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_pca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draws a scores or loadings plot or performs calculations necessary to draw them manually — plot_pca","text":"","code":"# Draw a Scores Plot toy_metaboscape %>%   impute_lod() %>%   join_metadata(toy_metaboscape_metadata) %>%   plot_pca(what = \"scores\", group_column = Group)   # Draw a Loadings Plot toy_metaboscape %>%   impute_lod() %>%   join_metadata(toy_metaboscape_metadata) %>%   plot_pca(what = \"loadings\", name_column = Feature)"},{"path":"https://yasche.github.io/metamorphr/reference/plot_volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","title":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","text":"Performs necessary calculations (.e., calculate p-values log2-fold changes) creates basic Volcano Plot. plot drawn ggplot2 can therefore easily manipulated afterwards (e.g., changing theme axis labels). Please note function intended easy use beginner friendly therefore offers limited ability fine-tune certain parameters resulting plot. wish draw plot , can set return_tbl = TRUE. case, tibble returned instead ggplot2 object can use create plot . Volcano Plot used compare two groups. Therefore grouping information must provided. See join_metadata information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","text":"","code":"plot_volcano(   data,   group_column,   name_column,   groups_to_compare,   batch_column = NULL,   batch = NULL,   log2fc_cutoff = 1,   p_value_cutoff = 0.05,   colors = list(sig_up = \"darkred\", sig_down = \"darkblue\", not_sig_up = \"grey\",     not_sig_down = \"grey\", not_sig = \"grey\"),   adjust_p = FALSE,   log2_before = FALSE,   return_tbl = FALSE,   ... )"},{"path":"https://yasche.github.io/metamorphr/reference/plot_volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually group_column = Group. Uses args_data_masking. name_column column contains feature names? Can example name_column = UID name_column = Feature. Uses args_data_masking. groups_to_compare Names groups compared character vector. group names group_column. usually provided form metadata tibble joined via join_metadata. batch_column column contains batch information? Usually grouping_column = Batch. relevant data contains multiple batches. example, data contains 2 batches batch contains measurements separate controls, group_column batch arguments provided. Otherwise controls batches considered calculating p-value log2 fold change. Uses args_data_masking. batch names batch(es) included calculating p-value log2 fold change. log2fc_cutoff numeric. cutoff used log2 fold change? Traditionally, set 1 corresponds doubling halving intensity area compared control. important assignment groups colors defined colors argument. p_value_cutoff numeric. cutoff used p-value? Traditionally, set 0.05. important assignment groups colors defined colors argument. Note -log10 transformed value. colors named list coloring dots Volcano Plot NULL case points colored. list must contain colors following groups: sig_up, sig_down, not_sig_up, not_sig_down not_sig. adjust_p p-value adjusted? Can either FALSE, (default) case adjustment made name p.adjust.methods (e.g., adjust_p = \"fdr\"). log2_before logical. data log2 transformed prior calculating p-values? return_tbl logical. FALSE, returns ggplot2 object, TRUE returns tibble can used draw plot manually control. ... Arguments passed t.test. none provided (default), Welch Two Sample t-test performed.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_volcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","text":"Either Volcano Plot form ggplot2 object tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/plot_volcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draws a Volcano Plot or performs calculations necessary to draw one manually — plot_volcano","text":"","code":"# returns a Volcano Plot in the form of a ggplot2 object toy_metaboscape %>%   impute_lod() %>%   join_metadata(toy_metaboscape_metadata) %>%   plot_volcano(     group_column = Group,     name_column = Feature,     groups_to_compare = c(\"control\", \"treatment\")   )   # returns a tibble to draw the plot manually toy_metaboscape %>%   impute_lod() %>%   join_metadata(toy_metaboscape_metadata) %>%   plot_volcano(     group_column = Group,     name_column = Feature,     groups_to_compare = c(\"control\", \"treatment\"),     return_tbl = TRUE   ) #> # A tibble: 10 × 5 #>      UID Feature                log2fc    p_val n_log_p_val #>    <int> <chr>                   <dbl>    <dbl>       <dbl> #>  1     1 161.10519 Da 26.98 s    0.678 0.494          0.306 #>  2     2 276.13647 Da 27.28 s   -0.637 0.200          0.699 #>  3     3 304.24023 Da 32.86 s    2.85  0.000981       3.01  #>  4     4 417.23236 Da 60.08 s   -0.784 0.384          0.416 #>  5     5 104.10753 Da 170.31 s   0.553 0.182          0.739 #>  6     6 105.04259 Da 199.80 s   0.421 0.620          0.208 #>  7     7 237.09204 Da 313.24 s   2.57  0.00912        2.04  #>  8     8 745.09111 Da 382.23 s  -0.282 0.691          0.161 #>  9     9 427.02942 Da 424.84 s   1.06  0.00106        2.98  #> 10    10 1284.34904 Da 498.94 s -1.05  0.590          0.229"},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a feature table into a tidy tibble — read_featuretable","title":"Read a feature table into a tidy tibble — read_featuretable","text":"Basically wrapper around readr::read_delim() performs initial tidying operations gather() rearranging columns. label_col renamed Feature.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a feature table into a tidy tibble — read_featuretable","text":"","code":"read_featuretable(file, delim = \",\", label_col = 1, metadata_cols = NULL, ...)"},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a feature table into a tidy tibble — read_featuretable","text":"file path file can also connection literal data. delim field separator delimiter. example \",\" csv files. label_col index name column used label Features. example identifier (e.g., KEGG, CAS, HMDB) m/z-RT pair. metadata_cols index/indices name(s) column(s) hold additional feature metadata (e.g., retention times, additional identifiers m/z values). ... Additional arguments passed readr::read_delim()","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a feature table into a tidy tibble — read_featuretable","text":"tidy tibble.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Read a feature table into a tidy tibble — read_featuretable","text":"H. Wickham, J. Stat. Soft. 2014, 59, DOI 10.18637/jss.v059.i10. H. Wickham, M. Averick, J. Bryan, W. Chang, L. McGowan, R. François, G. Grolemund, . Hayes, L. Henry, J. Hester, M. Kuhn, T. Pedersen, E. Miller, S. Bache, K. Müller, J. Ooms, D. Robinson, D. Seidel, V. Spinu, K. Takahashi, D. Vaughan, C. Wilke, K. Woo, H. Yutani, JOSS 2019, 4, 1686, DOI 10.21105/joss.01686. “12 Tidy data | R Data Science,” can found https://r4ds..co.nz/tidy-data.html, 2023.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_featuretable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a feature table into a tidy tibble — read_featuretable","text":"","code":"# Read a toy dataset in the format produced with Bruker MetaboScape (Version 2021). featuretable_path <- system.file(\"extdata\", \"toy_metaboscape.csv\", package = \"metamorphr\")  # Example 1: Provide indices for metadata_cols featuretable <- read_featuretable(featuretable_path, metadata_cols = 2:5)  featuretable #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1         4  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1         3  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1        NA  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1         5  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1         5  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1         5  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1        NA  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1         3  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1         4  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1        NA  8.32 1285. NA         NA      #> # ℹ 100 more rows  # Example 2: Provide a name for label_col and indices for metadata_cols featuretable <- read_featuretable(   featuretable_path,   label_col = \"m/z\",   metadata_cols = c(1, 2, 4, 5) )  featuretable #> # A tibble: 110 × 8 #>      UID Feature    Sample  Intensity `Bucket label`            RT Name  Formula #>    <int> <chr>      <chr>       <dbl> <chr>                  <dbl> <chr> <chr>   #>  1     1 162.11302  Sample1         4 161.10519 Da 26.98 s    0.45 NA    C7H15N… #>  2     2 277.1443   Sample1         3 276.13647 Da 27.28 s    0.45 Octy… C16H22… #>  3     3 305.24806  Sample1        NA 304.24023 Da 32.86 s    0.55 Arac… C20H32… #>  4     4 418.24019  Sample1         5 417.23236 Da 60.08 s    1    NA    NA      #>  5     5 105.11536  Sample1         5 104.10753 Da 170.31 s   2.84 NA    C5H14NO #>  6     6 106.05042  Sample1         5 105.04259 Da 199.80 s   3.33 NA    C3H8NO3 #>  7     7 238.09987  Sample1        NA 237.09204 Da 313.24 s   5.22 Keta… C13H16… #>  8     8 746.09894  Sample1         3 745.09111 Da 382.23 s   6.37 NADPH C21H30… #>  9     9 428.03725  Sample1         4 427.02942 Da 424.84 s   7.08 ADP   C10H15… #> 10    10 1285.35687 Sample1        NA 1284.34904 Da 498.94 s  8.32 NA    NA      #> # ℹ 100 more rows  # Example 3: Provide names for both, label_col and metadata_cols featuretable <- read_featuretable(   featuretable_path,   label_col = \"m/z\",   metadata_cols = c(\"Bucket label\", \"RT\", \"Name\", \"Formula\") )  featuretable #> # A tibble: 110 × 8 #>      UID Feature    Sample  Intensity `Bucket label`            RT Name  Formula #>    <int> <chr>      <chr>       <dbl> <chr>                  <dbl> <chr> <chr>   #>  1     1 162.11302  Sample1         4 161.10519 Da 26.98 s    0.45 NA    C7H15N… #>  2     2 277.1443   Sample1         3 276.13647 Da 27.28 s    0.45 Octy… C16H22… #>  3     3 305.24806  Sample1        NA 304.24023 Da 32.86 s    0.55 Arac… C20H32… #>  4     4 418.24019  Sample1         5 417.23236 Da 60.08 s    1    NA    NA      #>  5     5 105.11536  Sample1         5 104.10753 Da 170.31 s   2.84 NA    C5H14NO #>  6     6 106.05042  Sample1         5 105.04259 Da 199.80 s   3.33 NA    C3H8NO3 #>  7     7 238.09987  Sample1        NA 237.09204 Da 313.24 s   5.22 Keta… C13H16… #>  8     8 746.09894  Sample1         3 745.09111 Da 382.23 s   6.37 NADPH C21H30… #>  9     9 428.03725  Sample1         4 427.02942 Da 424.84 s   7.08 ADP   C10H15… #> 10    10 1285.35687 Sample1        NA 1284.34904 Da 498.94 s  8.32 NA    NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/read_mgf.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a MGF file into a tidy tibble — read_mgf","title":"Read a MGF file into a tidy tibble — read_mgf","text":"MGF files allow storage MS/MS spectra. function can read tidy tibble. variable stored column ion (observation) stored separate row. MS/MS spectra stored list column named MSn.  Please note MGF files software-specific variables names may vary. function developed GNPS file format exported mzmine mind.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_mgf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a MGF file into a tidy tibble — read_mgf","text":"","code":"read_mgf(file, show_progress = TRUE)"},{"path":"https://yasche.github.io/metamorphr/reference/read_mgf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a MGF file into a tidy tibble — read_mgf","text":"file path MGF file. show_progress logical indicating whether progress import printed console. important large MGF files.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_mgf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a MGF file into a tidy tibble — read_mgf","text":"tidy tibble holding MS/MS spectra.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/read_mgf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a MGF file into a tidy tibble — read_mgf","text":"","code":"mgf_path <- system.file(\"extdata\", \"toy_mgf.mgf\", package = \"metamorphr\") read_mgf(mgf_path) #> # A tibble: 3 × 5 #>   VARIABLEONE VARIABLETWO VARIABLETHREE PEPMASS MSn              #>         <dbl>       <dbl>         <dbl>   <dbl> <list>           #> 1         1.1         1.2           1.3    45.7 <tibble [3 × 2]> #> 2         2.1         2.2           2.3   679.  <tibble [5 × 2]> #> 3         3.1         3.2           3.3  5890.  <tibble [6 × 2]>"},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using autoscale — scale_auto","title":"Scale intensities of features using autoscale — scale_auto","text":"Scales intensities features using $$\\widetilde{x}_{ij}=\\frac{x_{ij}-\\overline{x}_{}}{s_i}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples \\({s_i}\\) standard deviation intensities feature \\(\\) across samples. words, subtracts mean intensity feature across samples intensities feature sample divides standard deviation feature. information, see reference section.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using autoscale — scale_auto","text":"","code":"scale_auto(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using autoscale — scale_auto","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using autoscale — scale_auto","text":"tibble autoscaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using autoscale — scale_auto","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_auto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using autoscale — scale_auto","text":"","code":"toy_metaboscape %>%   scale_auto() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1    -0.644  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1    -0.732  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    NA      0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1    -0.352  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    -0.227  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.136  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1    NA      5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    -0.195  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1    -0.414  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NA      8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":null,"dir":"Reference","previous_headings":"","what":"Center intensities of features around zero — scale_center","title":"Center intensities of features around zero — scale_center","text":"Centers intensities features around zero using $$\\widetilde{x}_{ij}=x_{ij}-\\overline{x}_{}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples. words, subtracts mean intensity feature across samples intensities feature sample. information, see reference section.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center intensities of features around zero — scale_center","text":"","code":"scale_center(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center intensities of features around zero — scale_center","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center intensities of features around zero — scale_center","text":"tibble intensities scaled around zero.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Center intensities of features around zero — scale_center","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_center.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Center intensities of features around zero — scale_center","text":"","code":"toy_metaboscape %>%   scale_center() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1    -1.5    0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1    -1.82   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    NA      0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1    -0.9    1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    -0.5    2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.333  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1    NA      5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    -0.125  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1    -0.889  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NA      8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using level scaling — scale_level","title":"Scale intensities of features using level scaling — scale_level","text":"Scales intensities features using $$\\widetilde{x}_{ij}=\\frac{x_{ij}-\\overline{x}_{}}{\\overline{x}_{}}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples words, performs centering (scale_center) divides feature mean, thereby focusing relative intensity.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using level scaling — scale_level","text":"","code":"scale_level(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using level scaling — scale_level","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using level scaling — scale_level","text":"tibble level scaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using level scaling — scale_level","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_level.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using level scaling — scale_level","text":"","code":"toy_metaboscape %>%   impute_lod() %>%   scale_level() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1   -0.0393  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1   -0.377   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1   -0.948   0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1   -0.0709  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    0.217   2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1    0.297   3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1   -0.575   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    0.260   6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1   -0.0265  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1   -0.667   8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using Pareto scaling — scale_pareto","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"Scales intensities features using $$\\widetilde{x}_{ij}=\\frac{x_{ij}-\\overline{x}_{}}{\\sqrt{s_i}}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples \\({\\sqrt{s_i}}\\) square root standard deviation intensities feature \\(\\) across samples. words, subtracts mean intensity feature across samples intensities feature sample divides square root standard deviation feature. information, see reference section.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"","code":"scale_pareto(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"tibble autoscaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_pareto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using Pareto scaling — scale_pareto","text":"","code":"toy_metaboscape %>%   scale_pareto() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1    -0.983  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1    -1.15   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    NA      0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1    -0.563  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    -0.337  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.213  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1    NA      5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    -0.156  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1    -0.607  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NA      8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using range scaling — scale_range","title":"Scale intensities of features using range scaling — scale_range","text":"Scales intensities features using $$\\widetilde{x}_{ij}=\\frac{x_{ij}-\\overline{x}_{}}{x_{,max}-x_{,min}}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples, \\(x_{,max}\\) maximum intensity feature \\(\\) across samples \\(x_{,min}\\) minimum intensity feature \\(\\) across samples. words, subtracts mean intensity feature across samples intensities feature sample divides range feature. information, see reference section.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using range scaling — scale_range","text":"","code":"scale_range(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using range scaling — scale_range","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using range scaling — scale_range","text":"tibble range scaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using range scaling — scale_range","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_range.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using range scaling — scale_range","text":"","code":"toy_metaboscape %>%   scale_range() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1   -0.25    0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1   -0.260   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1   NA       0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1   -0.113   1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1   -0.0714  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1    0.0476  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1   NA       5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1   -0.0625  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1   -0.178   7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1   NA       8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using vast scaling — scale_vast","title":"Scale intensities of features using vast scaling — scale_vast","text":"Scales intensities features using $$\\widetilde{x}_{ij}=\\frac{x_{ij}-\\overline{x}_{}}{s_i}\\cdot \\frac{\\overline{x}_{}}{s_i}$$ \\(\\widetilde{x}_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(x_{ij}\\) intensity sample \\(j\\), feature \\(\\) scaling, \\(\\overline{x}_{}\\) mean intensities feature \\(\\) across samples \\({s_i}\\) standard deviation intensities feature \\(\\) across samples. Note \\(\\frac{\\overline{x}_{}}{s_i} = \\frac{{1}}{CV}\\) CV coefficient variation across samples. scale_vast_grouped variation function uses group-specific coefficient variation. words, performs autoscaling (scale_auto) divides coefficient variation, thereby reducing importance features poor reproducibility.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using vast scaling — scale_vast","text":"","code":"scale_vast(data)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using vast scaling — scale_vast","text":"data tidy tibble created read_featuretable.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using vast scaling — scale_vast","text":"tibble vast scaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using vast scaling — scale_vast","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142. J. Sun, Y. Xia, Genes & Diseases 2024, 11, 100979, DOI 10.1016/j.gendis.2023.04.018.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using vast scaling — scale_vast","text":"","code":"toy_metaboscape %>%   scale_vast() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1    -1.52   0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1    -1.42   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    NA      0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1    -0.811  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1    -0.566  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.259  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1    NA      5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1    -0.951  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1    -0.942  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    NA      8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"variation scale_vast uses group-specific coefficient variation therefore requires group information. See scale_vast References section information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"","code":"scale_vast_grouped(data, group_column = .data$Group)"},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"data tidy tibble created read_featuretable. group_column column used grouping? Usually grouping_column = Group. Uses args_data_masking.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"tibble vast scaled intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/scale_vast_grouped.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale intensities of features using grouped vast scaling — scale_vast_grouped","text":"","code":"toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   scale_vast_grouped() #> # A tibble: 110 × 12 #>      UID Feature      Sample Intensity    RT `m/z` Name  Formula Group Replicate #>    <int> <chr>        <chr>      <dbl> <dbl> <dbl> <chr> <chr>   <chr>     <int> #>  1     1 161.10519 D… Sampl…    -4.09   0.45  162. NA    C7H15N… cont…         1 #>  2     2 276.13647 D… Sampl…    -2.24   0.45  277. Octy… C16H22… cont…         1 #>  3     3 304.24023 D… Sampl…    NA      0.55  305. Arac… C20H32… cont…         1 #>  4     4 417.23236 D… Sampl…    -1.23   1     418. NA    NA      cont…         1 #>  5     5 104.10753 D… Sampl…    -1.13   2.84  105. NA    C5H14NO cont…         1 #>  6     6 105.04259 D… Sampl…     1.06   3.33  106. NA    C3H8NO3 cont…         1 #>  7     7 237.09204 D… Sampl…    NA      5.22  238. Keta… C13H16… cont…         1 #>  8     8 745.09111 D… Sampl…    -0.585  6.37  746. NADPH C21H30… cont…         1 #>  9     9 427.02942 D… Sampl…    -2.63   7.08  428. ADP   C10H15… cont…         1 #> 10    10 1284.34904 … Sampl…    NA      8.32 1285. NA    NA      cont…         1 #> # ℹ 100 more rows #> # ℹ 2 more variables: Batch <int>, Factor <dbl>"},{"path":"https://yasche.github.io/metamorphr/reference/summary_featuretable.html","id":null,"dir":"Reference","previous_headings":"","what":"General information about a feature table and sample-wise summary — summary_featuretable","title":"General information about a feature table and sample-wise summary — summary_featuretable","text":"Information feature table. Prints information console (number samples, number features applicable number groups, replicates batches) returns sample-wise summary list.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/summary_featuretable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"General information about a feature table and sample-wise summary — summary_featuretable","text":"","code":"summary_featuretable(   data,   n_samples_max = 5,   n_features_max = 5,   n_groups_max = 5,   n_batches_max = 5 )"},{"path":"https://yasche.github.io/metamorphr/reference/summary_featuretable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"General information about a feature table and sample-wise summary — summary_featuretable","text":"data tidy tibble created read_featuretable. n_samples_max many Samples printed console? n_features_max many Features printed console? n_groups_max many groups printed console? n_batches_max many Batches printed console?","code":""},{"path":"https://yasche.github.io/metamorphr/reference/summary_featuretable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"General information about a feature table and sample-wise summary — summary_featuretable","text":"sample-wise summary list.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/summary_featuretable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"General information about a feature table and sample-wise summary — summary_featuretable","text":"","code":"toy_metaboscape %>%   join_metadata(toy_metaboscape_metadata) %>%   summary_featuretable() #> 11 Samples: Sample1, Sample2, Sample3, Sample4, Sample5 #> # 6 more samples #>  #> # Use the n_samples_max argument to see more #>  #> 10 Features: 161.10519 Da 26.98 s, 276.13647 Da 27.28 s, 304.24023 Da 32.86 s, 417.23236 Da 60.08 s, 104.10753 Da 170.31 s #> # 5 more features #>  #> # Use the n_features_max argument to see more #>  #> 4 Groups: control, treatment, QC, blank #> Replicates detected: 1...3 #>  #> 1 Batches: 1 #> 30 % missing values (NA): 33 out of 110. #> $Sample1 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   3.000   3.500   4.000   4.143   5.000   5.000       3  #>  #> $Sample2 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>    2.00    3.00    4.50    4.75    6.00    9.00       2  #>  #> $Sample3 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   1.000   3.500   4.000   4.125   5.250   7.000       2  #>  #> $Sample4 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   3.000   3.750   5.500   5.875   8.250   9.000       2  #>  #> $Sample5 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   2.000   3.000   7.000   5.444   8.000   9.000       1  #>  #> $Sample6 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   4.000   7.250   8.000   7.375   8.250   9.000       2  #>  #> $QC1 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   3.000   4.500   5.000   5.375   6.250   9.000       2  #>  #> $QC2 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   1.000   2.000   3.000   3.125   3.500   6.000       2  #>  #> $QC3 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   1.000   2.750   3.500   4.125   6.000   8.000       2  #>  #> $Blank1 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>       4       5       6       6       7       8       7  #>  #> $Blank2 #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>       5       6       7       7       8       9       8  #>"},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape.html","id":null,"dir":"Reference","previous_headings":"","what":"A small toy data set created from a feature table in MetaboScape style — toy_metaboscape","title":"A small toy data set created from a feature table in MetaboScape style — toy_metaboscape","text":"raw feature table also included. tibble can reproduced metamorphr::read_featuretable(system.file(\"extdata\", \"toy_metaboscape.csv\", package = \"metamorphr\"), metadata_cols = 2:5).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A small toy data set created from a feature table in MetaboScape style — toy_metaboscape","text":"","code":"toy_metaboscape"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape.html","id":"toy-metaboscape","dir":"Reference","previous_headings":"","what":"toy_metaboscape","title":"A small toy data set created from a feature table in MetaboScape style — toy_metaboscape","text":"data frame 110 rows 8 columns: UID unique identifier Feature. column automatically generated metamorphr::read_featuretable() feature table imported. Feature label given Feature easier identification. column original feature table used generate Feature column specified label_col argument metamorphr::read_featuretable(). Sample Sample name. Column names original feature table. Intensity Measured intensity (area). RT Retention time. Feature metadata therefore really necessary. m/z Mass charge. Feature metadata therefore really necessary. Name Feature name. Feature metadata therefore really necessary. Formula Chemical formula. Feature metadata therefore really necessary.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A small toy data set created from a feature table in MetaboScape style — toy_metaboscape","text":"data set contains fictional data!","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample metadata for the fictional dataset toy_metaboscape — toy_metaboscape_metadata","title":"Sample metadata for the fictional dataset toy_metaboscape — toy_metaboscape_metadata","text":"Data generated metamorphr::create_metadata_skeleton() can reproduced metamorphr::toy_metaboscape %>% create_metadata_skeleton().'","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample metadata for the fictional dataset toy_metaboscape — toy_metaboscape_metadata","text":"","code":"toy_metaboscape_metadata"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape_metadata.html","id":"toy-metaboscape-metadata","dir":"Reference","previous_headings":"","what":"toy_metaboscape_metadata","title":"Sample metadata for the fictional dataset toy_metaboscape — toy_metaboscape_metadata","text":"data frame 11 rows 5 columns: Sample sample name Group group samples belong? example treatment background. Note additional columns additional grouping information can freely added necessary. Replicate replicate. Batch batch samples prepared measured. Factor sample-specific factor, example dry weight protein content.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_metaboscape_metadata.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sample metadata for the fictional dataset toy_metaboscape — toy_metaboscape_metadata","text":"data set contains fictional data!","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_mgf.html","id":null,"dir":"Reference","previous_headings":"","what":"A small toy data set containing MSn spectra — toy_mgf","title":"A small toy data set containing MSn spectra — toy_mgf","text":"Data generated metamorphr::read_mgf() can reproduced tibble can reproduced metamorphr::read_mgf(system.file(\"extdata\", \"toy_mgf.mgf\", package = \"metamorphr\")).","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_mgf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A small toy data set containing MSn spectra — toy_mgf","text":"","code":"toy_mgf"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/reference/toy_mgf.html","id":"toy-mgf","dir":"Reference","previous_headings":"","what":"toy_mgf","title":"A small toy data set containing MSn spectra — toy_mgf","text":"data frame 3 rows 5 columns: VARIABLEONE fictional variable. VARIABLETWO fictional variable. VARIABLETHREE fictional variable. PEPMASS precursor ion m/z. MSn list column containing MSn spectra.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/toy_mgf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A small toy data set containing MSn spectra — toy_mgf","text":"data set contains fictional data!","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Transforms the intensities by calculating their log — transform_log","title":"Transforms the intensities by calculating their log — transform_log","text":"Log-transforms intensities. default (base = 10) calculates log10. transformation can help reduce heteroscedasticity. See references information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transforms the intensities by calculating their log — transform_log","text":"","code":"transform_log(data, base = 10)"},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transforms the intensities by calculating their log — transform_log","text":"data tidy tibble created read_featuretable. base base used log-transformation. default (10) means log10 values intensities calculated.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transforms the intensities by calculating their log — transform_log","text":"tibble log-transformed intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Transforms the intensities by calculating their log — transform_log","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_log.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transforms the intensities by calculating their log — transform_log","text":"","code":"toy_metaboscape %>%   impute_lod() %>%   transform_log() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1     0.602  0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1     0.477  0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1    -0.699  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1     0.699  1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1     0.699  2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     0.699  3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     0.146  5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1     0.477  6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1     0.602  7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1    -0.398  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":null,"dir":"Reference","previous_headings":"","what":"Transforms the intensities by calculating their nth root — transform_power","title":"Transforms the intensities by calculating their nth root — transform_power","text":"Calculates nth root intensities x^(1/n). default (n = 2) calculates square root. transformation can help reduce heteroscedasticity. See references information.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transforms the intensities by calculating their nth root — transform_power","text":"","code":"transform_power(data, n = 2)"},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transforms the intensities by calculating their nth root — transform_power","text":"data tidy tibble created read_featuretable. n nth root calculate.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transforms the intensities by calculating their nth root — transform_power","text":"tibble power-transformed intensities.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Transforms the intensities by calculating their nth root — transform_power","text":"R. . Van Den Berg, H. C. Hoefsloot, J. . Westerhuis, . K. Smilde, M. J. Van Der Werf, BMC Genomics 2006, 7, 142, DOI 10.1186/1471-2164-7-142.","code":""},{"path":"https://yasche.github.io/metamorphr/reference/transform_power.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transforms the intensities by calculating their nth root — transform_power","text":"","code":"toy_metaboscape %>%   impute_lod() %>%   transform_power() #> # A tibble: 110 × 8 #>      UID Feature                Sample  Intensity    RT `m/z` Name       Formula #>    <int> <chr>                  <chr>       <dbl> <dbl> <dbl> <chr>      <chr>   #>  1     1 161.10519 Da 26.98 s   Sample1     2      0.45  162. NA         C7H15N… #>  2     2 276.13647 Da 27.28 s   Sample1     1.73   0.45  277. Octyl hyd… C16H22… #>  3     3 304.24023 Da 32.86 s   Sample1     0.447  0.55  305. Arachidon… C20H32… #>  4     4 417.23236 Da 60.08 s   Sample1     2.24   1     418. NA         NA      #>  5     5 104.10753 Da 170.31 s  Sample1     2.24   2.84  105. NA         C5H14NO #>  6     6 105.04259 Da 199.80 s  Sample1     2.24   3.33  106. NA         C3H8NO3 #>  7     7 237.09204 Da 313.24 s  Sample1     1.18   5.22  238. Ketamine   C13H16… #>  8     8 745.09111 Da 382.23 s  Sample1     1.73   6.37  746. NADPH      C21H30… #>  9     9 427.02942 Da 424.84 s  Sample1     2      7.08  428. ADP        C10H15… #> 10    10 1284.34904 Da 498.94 s Sample1     0.632  8.32 1285. NA         NA      #> # ℹ 100 more rows"},{"path":[]},{"path":"https://yasche.github.io/metamorphr/news/index.html","id":"metamorphr-020","dir":"Changelog","previous_headings":"","what":"metamorphr 0.2.0","title":"metamorphr 0.2.0","text":"CRAN release: 2025-10-09","code":""},{"path":"https://yasche.github.io/metamorphr/news/index.html","id":"new-features-0-2-0","dir":"Changelog","previous_headings":"","what":"New features","title":"metamorphr 0.2.0","text":"Added formula_to_mass() (experimental) Added functions related Kendrick mass: calc_kmd, calc_km calc_nominal_km","code":""},{"path":"https://yasche.github.io/metamorphr/news/index.html","id":"fixes-0-2-0","dir":"Changelog","previous_headings":"","what":"Fixes","title":"metamorphr 0.2.0","text":"Fixed typo DESCRIPTION Fixed two tests caused error operating systems CRAN","code":""},{"path":"https://yasche.github.io/metamorphr/news/index.html","id":"metamorphr-011","dir":"Changelog","previous_headings":"","what":"metamorphr 0.1.1","title":"metamorphr 0.1.1","text":"CRAN release: 2025-09-01 Fixed CRAN comments.","code":""},{"path":"https://yasche.github.io/metamorphr/news/index.html","id":"metamorphr-010","dir":"Changelog","previous_headings":"","what":"metamorphr 0.1.0","title":"metamorphr 0.1.0","text":"Initial CRAN submission.","code":""}]
